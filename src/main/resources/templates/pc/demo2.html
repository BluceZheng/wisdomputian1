<center>
    <div id="layoutDiv">
        <table class="layouttable" border="1" style="width: 1248px;" align="left" width="-42">
            <caption>
                供应商付款审批单（C类）-集采业务
            </caption>
            <colgroup>
                <col width="10%">
                <col width="30%">
                <col width="10%">
                <col width="30%">
                <col width="8%">
                <col width="12%">





            </colgroup>
            <tbody>
            <tr class="firstRow">
                <td class="FieldName" colspan="4" nowrap="">
                    <a href="javascript:onUrl('/workflow/request/formbase.jsp?requestid=8a8ad0c370e53a3d0170f1622fc71ee8','供应商付款审批单(C)')" request="workflow="><span style="FONT-SIZE: 16px; COLOR: #f70909"><strong>供应商付款审批单(C 类)_操作视频</strong></span> </a><a href="javascript:onUrl('/workflow/request/formbase.jsp?requestid=8a8ad0c376e581ca0176f017099334a4','费用报销财务分工')" request="workflow="><span style="FONT-SIZE: 16px; COLOR: #f70909; MARGIN-LEFT: 430px"><strong>费用报销财务分工</strong></span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</a><a href="javascript:onUrl('/workflow/request/formbase.jsp?requestid=8a8acee28248d65d01825d30bd6a726b','安全生产费使用范围标准')" request="workflow="><span style="FONT-SIZE: 16px; COLOR: #f70909; MARGIN-LEFT: 30px"><strong>安全生产费使用范围标准</strong></span></a> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a style="TEXT-DECORATION: underline" href="javascript:onUrl('/workflow/request/formbase.jsp?requestid=8a8ace5884662758018473a7b4470e4d','安全生产生产费标准')" request="workflow="><span style="FONT-SIZE: 16px; COLOR: #f70909; MARGIN-LEFT: 30px"><strong>点击查看安全生产生产费标准</strong></span></a>
                </td>
            </tr>
            <tr>
                <td class="FieldName" nowrap="">
                    单号
                </td>
                <td class="FieldValue">
                    <input id="$8a8ad0a03dac251a013daeca4ae60c41$" class="InputStyle2" style="width: 80%;" value="[可编辑]供应商付款审批单.单号" name="8a8ad0a03dac251a013daeca49500c3e">
                </td>
                <td class="FieldName" nowrap="">
                    申请日期
                </td>
                <td class="FieldValue">
                    <input id="$8a8ad0a03dac251a013daeca4b250c47$" class="InputStyle2" style="width: 80%;" value="[可编辑]供应商付款审批单.申请日期" name="8a8ad0a03dac251a013daeca49500c3e">
                </td>
            </tr>
            <tr>
                <td class="FieldName" nowrap="">
                    申请人
                </td>
                <td class="FieldValue">
                    <input id="$8a8ad0a03dac251a013daeca4b050c43$" class="InputStyle2" style="width: 80%;" value="[可编辑]供应商付款审批单.申请人" name="8a8ad0a03dac251a013daeca49500c3e"><input id="$8a8ad0de670634db016714ef79a62731$" class="InputStyle2" style="height: 20px; width: 48px;" size="2" value="[隐藏]供应商付款审批单.申请人岗位" name="8a8ad0a03dac251a013daeca49500c3e">
                </td>
                <td class="FieldName" nowrap="">
                    申请部门
                </td>
                <td class="FieldValue">
                    <input id="$8a8ad09444905a35014494d4294e0520$" class="InputStyle2" style="width: 40%;" value="[只读]供应商付款审批单.申请部门2" name="8a8ad0a03dac251a013daeca49500c3e"><input id="$8a8ad0a03dac251a013daeca4b150c45$" class="InputStyle2" style="width: 40%;" size="1" value="[可编辑]供应商付款审批单.申请部门" name="8a8ad0a03dac251a013daeca49500c3e">
                </td>
            </tr>
            <tr>
                <td class="FieldName" nowrap="">
                    供应商
                </td>
                <td class="FieldValue">
                    <input id="$8a8acee277244dc301772e8c3f2f4d30$" class="InputStyle2" style="width: 25%;" value="[隐藏]供应商付款审批单.供应商编号(新)" name="8a8ad0a03dac251a013daeca49500c3e"><input id="$8a8ad0a03dac251a013daeca4b340c49$" class="InputStyle2" style="width: 25%;" value="[必须输入]供应商付款审批单.供应商编号" name="8a8ad0a03dac251a013daeca49500c3e"><input id="$8a8ad0a03dac251a013daeca4b440c4b$" class="InputStyle2" style="width: 50%;" value="[可编辑]供应商付款审批单.供应商名称" name="8a8ad0a03dac251a013daeca49500c3e">
                </td>
                <td class="FieldName" nowrap="" style="word-break: break-all;">
                    采购组织
                </td>
                <td class="FieldValue">
                    <input id="$8a8ad0204c20e0d3014c2c24cde9656d$" class="InputStyle2" style="width: 60%;" value="[必须输入]供应商付款审批单.公司代码" name="8a8ad0a03dac251a013daeca49500c3e"><input id="$8a8ad0204c20e0d3014c2c24cd7c6564$" class="InputStyle2" style="WIDTH: 20%" value="[只读]供应商付款审批单.采购组织" name="8a8ad0a03dac251a013daeca49500c3e">
                </td>
            </tr>
            <tr>
                <td class="FieldName" nowrap="">
                    是否有合同
                </td>
                <td class="FieldValue">
                    <input id="$8a8ad09444905a35014494c320380502$" class="InputStyle2" style="width: 80%;" value="[必须输入]供应商付款审批单.是否有合同" name="8a8ad0a03dac251a013daeca49500c3e">
                </td>
                <td class="FieldName" nowrap="">
                    供应商类别
                </td>
                <td class="FieldValue">
                    <input id="$8a8ad0de670634db0167103382a66ce9$" class="InputStyle2" value="[只读]供应商付款审批单.供应商类别NEW" name="8a8ad0a03dac251a013daeca49500c3e" style="">
                </td>
            </tr>
            <tr id="div6" style="display: none">
                <td class="FieldName" nowrap="" colspan="1" rowspan="1" style="word-break: break-all;">
                    合同执行方式
                </td>
                <td class="FieldValue" nowrap="" colspan="1" rowspan="1" style="word-break: break-all;">
                    <input type="text" class="InputStyle2" style="width: 80%;" id="$8a8ad0de683181f2016831cd15ec1f00$" name="8a8ad0a03dac251a013daeca49500c3e" value="[可编辑]供应商付款审批单.合同类型">
                </td>
                <td class="FieldName" nowrap="" colspan="1" rowspan="1"></td>
                <td class="FieldName" nowrap="" colspan="1" rowspan="1"></td>
            </tr>
            <tr id="div1" style="display: none">
                <td class="FieldName" nowrap="">
                    合同编号
                </td>
                <td class="FieldValue">
                    <input id="$8a8ad0a03dac251a013daeca4bff0c5d$" class="InputStyle2" style="width: 25%;" value="[必须输入]供应商付款审批单.合同编号" name="8a8ad0a03dac251a013daeca49500c3e"><input id="$8a8ad0a03dac251a013daeca4c0f0c5f$" class="InputStyle2" style="width: 70%;" value="[可编辑]供应商付款审批单.合同名称" name="8a8ad0a03dac251a013daeca49500c3e">
                </td>
                <td class="FieldName" nowrap="">
                    合同付款情况
                </td>
                <td class="FieldValue" style="word-break: break-all;">
                    <span id="ze">总额</span><input id="$8a8ad0a03dac251a013daeca4c2e0c61$" class="InputStyle2" style="width: 15%;" value="[只读]供应商付款审批单.合同总金额" name="8a8ad0a03dac251a013daeca49500c3e"><span id="zey">元；</span><span id="yljsq">已累计申请</span><input type="text" class="InputStyle2" id="$8a8ad0a03e12dcfc013e15ae25350190$" name="8a8ad0a03dac251a013daeca49500c3e" value="[只读]供应商付款审批单.已申请金额" style=""><span id="yljsqy">元；</span><span id="yf">已付</span><input id="$8a8ad09441c756ee0141d9f5cd301abf$" class="InputStyle2" style="width: 15%;" value="[只读]供应商付款审批单.合同已付款" name="8a8ad0a03dac251a013daeca49500c3e"><span id="yfy">元；</span><span id="wf">未付</span><input id="$8a8ad0944029a75a01402d40b3f22d8d$" class="InputStyle2" style="width: 15%;" value="[只读]供应商付款审批单.合同余额" name="8a8ad0a03dac251a013daeca49500c3e"><span id="wfy">元；</span>
                </td>
            </tr>
            <tr id="div2" style="display: none">
                <td class="FieldName" nowrap="">
                    C类供应商费用申请单
                </td>
                <td class="FieldValue">
                    <input id="$8a8ad09444905a35014494c320770504$" class="InputStyle2" style="width: 80%;" value="[可编辑]供应商付款审批单.关联C类付款申请单" name="8a8ad0a03dac251a013daeca49500c3e">
                </td>
                <td class="FieldName" nowrap="">
                    申请单付款情况
                </td>
                <td class="FieldValue">
                    总额<input id="$8a8ad09444905a35014494ce49660518$" class="InputStyle2" style="width: 15%;" value="[只读]供应商付款审批单.申请金额" name="8a8ad0a03dac251a013daeca49500c3e">元；已付<input id="$8a8ad09444905a35014494ce4985051a$" class="InputStyle2" style="width: 15%;" value="[只读]供应商付款审批单.已付款金额" name="8a8ad0a03dac251a013daeca49500c3e">元；未付<input id="$8a8ad09444905a35014494ce4995051c$" class="InputStyle2" style="width: 15%;" value="[只读]供应商付款审批单.未付款金额" name="8a8ad0a03dac251a013daeca49500c3e">元；
                </td>
            </tr>
            <tr id="div3" style="display: none">
                <td class="FieldName" nowrap="">
                    合同费用科目
                </td>
                <td class="FieldValue">
                    <input id="$8a8ad0944d65f4e2014d8ee79bcc66f4$" class="InputStyle2" style="width: 80%;" value="[可编辑]供应商付款审批单.合同费用科目" name="8a8ad0a03dac251a013daeca49500c3e">
                </td>
                <td class="FieldName" nowrap="">
                    本月预算申请金额
                </td>
                <td class="FieldValue">
                    <input id="$8a8ad0944d65f4e2014d8ee7955466ea$" class="InputStyle2" style="width: 80%;" value="[只读]供应商付款审批单.预算金额" name="8a8ad0a03dac251a013daeca49500c3e">
                </td>
            </tr>
            <tr id="div4" style="display: none">
                <td class="FieldName" nowrap="">
                    本月累计申请金额
                </td>
                <td class="FieldValue">
                    <input id="$8a8ad0944d65f4e2014d8ee7964e66ec$" class="InputStyle2" style="width: 80%;" value="[只读]供应商付款审批单.月度申请总额" name="8a8ad0a03dac251a013daeca49500c3e">
                </td>
                <td class="FieldName" nowrap="">
                    本月可用预算金额
                </td>
                <td class="FieldValue">
                    <input id="$8a8ad0944d65f4e2014d8ee7979666ee$" class="InputStyle2" style="width: 80%;" value="[只读]供应商付款审批单.可用预算金额" name="8a8ad0a03dac251a013daeca49500c3e">
                </td>
            </tr>
            <tr id="div5" style="display: none">
                <td class="FieldName" nowrap="">
                    预算归口部门
                </td>
                <td class="FieldValue">
                    <input id="$8a8ad0944d65f4e2014d8ee79ae266f2$" class="InputStyle2" style="width: 80%;" value="[只读]供应商付款审批单.预算归口部门" name="8a8ad0a03dac251a013daeca49500c3e">
                </td>
                <td class="FieldName" nowrap=""></td>
                <td class="FieldValue">
                    <input id="$8a8ad099601539cf0161541e4ad6747d$" class="InputStyle2" value="[只读]供应商付款审批单.来源标识" name="8a8ad0a03dac251a013daeca49500c3e" style="">
                </td>
            </tr>
            <tr>
                <td class="FieldName" nowrap="">
                    开户银行名称
                </td>
                <td class="FieldValue" style="word-break: break-all;">
                    <input id="$8a8ad09451465b1901514ccf2f832778$" class="InputStyle2" style="width: 20%;" size="1" value="[必须输入]供应商付款审批单.行号" name="8a8ad0a03dac251a013daeca49500c3e"><span style="FONT-SIZE: 18px; COLOR: #ff0000"><strong>!</strong></span><input id="$8a8ad0944029a75a01403304939e3744$" class="InputStyle2" style="width: 70%;" value="[只读]供应商付款审批单.银行户主" name="8a8ad0a03dac251a013daeca49500c3e"><span style="display: none">开户银行:<input id="$8a8ad0a03dac251a013daeca4bb10c53$" class="InputStyle2" style="width: 80%;" value="[可编辑]供应商付款审批单.开户银行" name="8a8ad0a03dac251a013daeca49500c3e"></span>
                </td>
                <td class="FieldName" style=" word-break: break-all;" nowrap="">
                    <span style="font-family: &quot;Segoe UI&quot;, &quot;Microsoft YaHei&quot;; text-align: center;">银行卡号</span>
                </td>
                <td class="FieldValue">
                    &nbsp;<input id="$8a8ad0a03dac251a013daeca4bc10c55$" class="InputStyle2" style="width: 80%;" value="[必须输入]供应商付款审批单.银行账号" name="8a8ad0a03dac251a013daeca49500c3e">
                </td>
            </tr>
            <tr style="display: none">
                <td class="FieldName" nowrap="">
                    银企类型
                </td>
                <td class="FieldValue">
                    <input id="$8a8ad09451465b1901514ccf2e892774$" class="InputStyle2" style="width: 80%;" value="[只读]供应商付款审批单.银企类型" name="8a8ad0a03dac251a013daeca49500c3e">
                </td>
                <td class="FieldName" nowrap="">
                    出纳拆分时间
                </td>
                <td class="FieldValue">
                    <input id="$8a8ad09451465b1901514ccf2f062776$" class="InputStyle2" style="width: 80%;" value="[只读]供应商付款审批单.出纳拆分日期" name="8a8ad0a03dac251a013daeca49500c3e">
                </td>
            </tr>
            <tr>
                <td class="FieldName" nowrap="">
                    所属银行
                </td>
                <td class="FieldValue">
                    <input id="$8a8ad09451465b1901514ccf3138277e$" class="InputStyle2" style="width: 20%;" value="[只读]供应商付款审批单.所属银行编号SAP" name="8a8ad0a03dac251a013daeca49500c3e"><input id="$8a8ad09451465b1901514ccf31b52780$" class="InputStyle2" style="width: 60%;" value="[只读]供应商付款审批单.所属银行SAP" name="8a8ad0a03dac251a013daeca49500c3e">
                </td>
                <td class="FieldName" nowrap="">
                    省市代码
                </td>
                <td class="FieldValue">
                    <input id="$8a8ad09451465b1901514ccf302f277a$" class="InputStyle2" style="width: 20%;" value="[只读]供应商付款审批单.省市代码" name="8a8ad0a03dac251a013daeca49500c3e"><input id="$8a8ad09451465b1901514ccf30cb277c$" class="InputStyle2" style="width: 60%;" value="[只读]供应商付款审批单.省市名称" name="8a8ad0a03dac251a013daeca49500c3e">
                </td>
            </tr>
            <tr>
                <td class="FieldName" nowrap="">
                    发票税率
                </td>
                <td class="FieldValue">
                    <input id="$8a8ad0944038bd1901403986d2f10e28$" class="InputStyle2" style="width: 80%;" size="25" value="[可编辑]供应商付款审批单.发票税率" name="8a8ad0a03dac251a013daeca49500c3e">
                </td>
                <td class="FieldName" nowrap="">
                    付款条件
                </td>
                <td class="FieldValue">
                    <input id="$8a8ad0944038bd1901403986d2b30e24$" class="InputStyle2" style="width: 20%;" size="1" value="[只读]供应商付款审批单.付款条件" name="8a8ad0a03dac251a013daeca49500c3e"><input id="$8a8ad0944038bd1901403986d2e20e26$" class="InputStyle2" style="width: 40%;" value="[只读]供应商付款审批单.付款条件名称" name="8a8ad0a03dac251a013daeca49500c3e"><input onclick="javascript:urlsrys()" type="button" value="请款情况" style="">
                </td>
            </tr>
            <tr style="display: none">
                <td class="FieldName">
                    签收状态
                </td>
                <td class="FieldValue">
                    <input id="$8a8ad09448ba3de20148bed0786c0287$" class="InputStyle2" style="width: 80%;" value="[可编辑]供应商付款审批单.签收状态" name="8a8ad0a03dac251a013daeca49500c3e"><input id="$8a8ad09448ba3de20148bed0780e0285$" class="InputStyle2" style="width: 26.6%;" value="[隐藏]供应商付款审批单.签收时间" name="8a8ad0a03dac251a013daeca49500c3e"><input id="$8a8ad09448ba3de20148bed077a10283$" class="InputStyle2" style="width: 26.6%;" value="[隐藏]供应商付款审批单.签收人" name="8a8ad0a03dac251a013daeca49500c3e">
                </td>
                <td class="FieldName" nowrap="">
                    费用归属部门
                </td>
                <td class="FieldValue">
                    <input id="$8a8ad09448ba3de20148c3efb7ed25a5$" class="InputStyle2" style="width: 80%;" value="[可编辑]供应商付款审批单.费用归属部门" name="8a8ad0a03dac251a013daeca49500c3e">
                </td>
            </tr>
            <tr style="display: none">
                <td class="FieldName" nowrap="">
                    付款类型
                </td>
                <td class="FieldValue">
                    <input id="$8a8ad09449e0222b0149f94160815c4f$" class="InputStyle2" style="width: 80%;" value="[隐藏]供应商付款审批单.付款类型" name="8a8ad0a03dac251a013daeca49500c3e">
                </td>
                <td class="FieldName" nowrap="">
                    合同类型
                </td>
                <td class="FieldValue">
                    <input id="$8a8ad0a03dac251a013daeca4c3e0c63$" class="InputStyle2" style="width: 80%;" size="1" value="[隐藏]供应商付款审批单.合同类型" name="8a8ad0a03dac251a013daeca49500c3e">
                </td>
            </tr>
            <tr>
                <td class="FieldName" nowrap="">
                    供应商类型
                </td>
                <td class="FieldValue">
                    <input id="$8a8ad0944089b22501408b198171008f$" class="InputStyle2" style="width: 80%;" size="6" value="[隐藏]供应商付款审批单.供应商类别" name="8a8ad0a03dac251a013daeca49500c3e">
                </td>
                <td class="FieldName" nowrap="">
                    费用科目
                </td>
                <td class="FieldValue">
                    <input id="$8a8ad09448ba3de20148c3efb8c825a9$" class="InputStyle2" style="width: 40%;" size="1" value="[可编辑]供应商付款审批单.费用科目" name="8a8ad0a03dac251a013daeca49500c3e"><strong><span style="FONT-SIZE: 18px; COLOR: #ff0000">!</span> </strong>
                </td>
            </tr>
            <tr>
                <td class="FieldName">
                    融资方式
                </td>
                <td class="FieldValue">
                    <input id="$8a8acee276a8fdc00176a94389cc0865$" class="InputStyle2" value="[必须输入]供应商付款审批单.融资方式" name="8a8ad0a03dac251a013daeca49500c3e" style="">
                </td>
                <td class="FieldName">
                    本次付款完合同是否结束
                </td>
                <td class="FieldValue">
                    <input id="$8a8acee27825f9910178346f02e077e3$" class="InputStyle2" style="height: 20px; width: 311px;" size="19" value="[可编辑]供应商付款审批单.本次付款完合同是否结束" name="8a8ad0a03dac251a013daeca49500c3e">
                </td>
            </tr>
            <tr>
                <td class="FieldName" nowrap="" style="word-break: break-all;">
                    对公对私
                </td>
                <td class="FieldValue">
                    <input id="$8a8ad0f865603fcb016569726c5a0fb1$" class="InputStyle2" style="width: 80%;" value="[必须输入]供应商付款审批单.对公对私" name="8a8ad0a03dac251a013daeca49500c3e">
                </td>
                <td class="FieldName" nowrap="">
                    是否特殊付款
                </td>
                <td class="FieldValue">
                    <input id="$8a8acee27ca74b46017ca76b11790a82$" class="InputStyle2" style="height: 20px; width: 311px;" size="19" value="[可编辑]供应商付款审批单.是否特殊付款" name="8a8ad0a03dac251a013daeca49500c3e">
                </td>
            </tr>
            <tr>
                <td class="FieldName" nowrap="">
                    汇票使用比例
                </td>
                <td class="FieldValue">
                    <input id="$8a8acee27baac3a3017bab1a8c89123d$" class="InputStyle2" style="width: 40%;" value="[必须输入]供应商付款审批单.汇票使用比例" name="8a8ad0a03dac251a013daeca49500c3e"><strong><span style="COLOR: #ff0000">注：如没有使用汇票，选0</span></strong>
                </td>
                <td class="FieldValue"></td>
                <td class="FieldValue"></td>
            </tr>
            <tr>
                <td bgcolor="#8ddddd" colspan="4">
                    <p style="TEXT-ALIGN: center">
                        <span style="FONT-SIZE: 16px">付款信息</span>
                    </p>
                </td>
            </tr>
            <tr>
                <td class="FieldName">
                    应收应付互抵流程
                </td>
                <td class="FieldValue">
                    <input id="$8a8ad0944c305396014c4e53427a0b0f$" class="InputStyle2" style="width: 80%;" value="[可编辑]供应商付款审批单.应收应付互抵流程" name="8a8ad0a03dac251a013daeca49500c3e">
                </td>
                <td class="FieldName" nowrap="">
                    互抵金额
                </td>
                <td class="FieldValue">
                    <input id="$8a8ad0944c305396014c4e5341de0b0d$" class="InputStyle2" style="width: 80%;" value="[只读]供应商付款审批单.互抵金额" name="8a8ad0a03dac251a013daeca49500c3e">
                </td>
            </tr>
            <tr>
                <td class="FieldName">
                    支付币种
                </td>
                <td class="FieldValue">
                    <input id="$8a8ad0f85ef5a579015ef9fc85370dda$" class="InputStyle2" style="width: 80%;" value="[必须输入]供应商付款审批单.币种" name="8a8ad0a03dac251a013daeca49500c3e">
                </td>
                <td class="FieldName" nowrap="">
                    供应商类型
                </td>
                <td class="FieldValue">
                    <input id="$8a8ad0f85ef5a579015ef9fc85a50ddc$" class="InputStyle2" style="width: 80%;" value="[必须输入]供应商付款审批单.供应商类型（境内/境外）" name="8a8ad0a03dac251a013daeca49500c3e">
                </td>
            </tr>
            <tr>
                <td class="FieldName">
                    本次申请付款金额
                </td>
                <td class="FieldValue">
                    <input id="$8a8ad0a03dac251a013daeca4d380c7d$" class="InputStyle2" style="width: 80%;" size="1" value="[可编辑]供应商付款审批单.申请付款金额" name="8a8ad0a03dac251a013daeca49500c3e">&nbsp;
                </td>
                <td class="FieldName" nowrap="">
                    支付方式
                </td>
                <td class="FieldValue">
                    <input id="$8a8ad0a03dac251a013daeca4bd10c57$" class="InputStyle2" style="width: 80%;" value="[可编辑]供应商付款审批单.支付方式" name="8a8ad0a03dac251a013daeca49500c3e">
                </td>
            </tr>
            <tr style="display: none">
                <td class="FieldName" nowrap="" style="word-break: break-all;"></td>
                <td class="FieldValue" style="word-break: break-all;">
                    <input id="$8a8ad0944a3c9caa014a4b80ccfb1ca8$" class="InputStyle2" style="height: 19px; width: 25.35%;" size="1" value="[隐藏]供应商付款审批单.是否有发票" name="8a8ad0a03dac251a013daeca49500c3e">&nbsp;&nbsp;<input id="$8a8acee26df673b7016df6a79f2304e6$" class="InputStyle2" style="height: 19px; width: 97px;" size="1" value="[隐藏]供应商付款审批单.预计开具时间" name="8a8ad0a03dac251a013daeca49500c3e"><br/>
                </td>
                <td class="FieldName" nowrap="" style="word-break: break-all;"></td>
                <td class="FieldValue">
                    <input id="$8a8ad02053cb3d5c01547b1bd3cb0ff7$" class="InputStyle2" style="width: 80%; display: none;" value="[隐藏]供应商付款审批单.发票类型" name="8a8ad0a03dac251a013daeca49500c3e">
                </td>
            </tr>
            <tr>
                <td class="FieldName" style="WORD-BREAK: break-all">
                    发票金额
                </td>
                <td class="FieldValue" style="word-break: break-all;">
                    <input id="$8a8ad0a03dac251a013daeca4b730c4f$" class="InputStyle2" style="width: 60%;" value="[可编辑]供应商付款审批单.发票金额" name="8a8ad0a03dac251a013daeca49500c3e">&nbsp;<span style="font-family: &quot;Segoe UI&quot;, &quot;Microsoft YaHei&quot;; background-color: rgb(237, 240, 245);">（通过发票采集获取）</span>
                </td>
                <td class="FieldName" nowrap="" style="word-break: break-all;"></td>
                <td class="FieldValue">
                    <input id="$8a8ad09444905a35014494ce49d3051e$" class="InputStyle2" style="width: 80%; display: none;" value="[隐藏]供应商付款审批单.发票份数" name="8a8ad0a03dac251a013daeca49500c3e">
                </td>
            </tr>
            <tr id="tr01" style="display: none">
                <td class="FieldName" nowrap="">
                    关联培训执行流程
                </td>
                <td class="FieldValue">
                    <input id="$8a8acee26d24932c016d38270d7058c6$" class="InputStyle2" value="[可编辑]供应商付款审批单.关联培训执行流程" name="8a8ad0a03dac251a013daeca49500c3e" style="">
                </td>
                <td class="FieldName" nowrap="">
                    &nbsp;
                </td>
                <td class="FieldValue">
                    &nbsp;
                </td>
            </tr>
            <tr>
                <td class="FieldName" nowrap="">
                    计划付款日期
                </td>
                <td class="FieldValue">
                    <input id="$8a8ad0a03dac251a013daeca4be00c59$" class="InputStyle2" style="width: 80%;" size="1" value="[必须输入]供应商付款审批单.计划付款日期" name="8a8ad0a03dac251a013daeca49500c3e">
                </td>
                <td class="FieldName" nowrap="">
                    财务安排付款日期
                </td>
                <td class="FieldValue">
                    <input id="$8a8ad0944126731b014129a49000007e$" class="InputStyle2" value="[只读]供应商付款审批单.财务安排付款日期" name="8a8ad0a03dac251a013daeca49500c3e" style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;实际付款日期&nbsp;<input id="$8a8ad0a03dac251a013daeca4bf00c5b$" class="InputStyle2" style="HEIGHT: 19px; WIDTH: 28.07%" size="1" value="[只读]供应商付款审批单.实际付款日期" name="8a8ad0a03dac251a013daeca49500c3e">
                </td>
            </tr>
            <tr>
                <td class="FieldName" nowrap="">
                    付款项目内容概述
                </td>
                <td class="FieldValue" colspan="3">
                    <input id="$8a8acee27689743d017689af90b0150c$" class="InputStyle2" style="height: 30px; width: 86.76%;" size="50" value="[必须输入]供应商付款审批单.付款项目内容概述" name="8a8ad0a03dac251a013daeca49500c3e"><br/><span style="COLOR: #ff0000">请一句话概括描述（时间+地点+事由），不超过50个字符（25个汉字）</span>
                </td>
            </tr>
            <tr>
                <td class="FieldName" nowrap="">
                    付款项目内容详细说明
                </td>
                <td class="FieldValue" colspan="3">
                    <input id="$8a8ad094505f277a0150692270021b80$" class="InputStyle2" style="height: 74px; width: 86.83%;" size="55" value="[必须输入]供应商付款审批单.付款事由" name="8a8ad0a03dac251a013daeca49500c3e">
                </td>
            </tr>
            <tr>
                <td class="FieldName" nowrap="">
                    发票号码
                </td>
                <td class="FieldValue" colspan="3">
                    <input id="$8a8ad0a03dac251a013daeca4d090c77$" class="InputStyle2" style="width: 91.43%;" size="14" value="[必须输入]供应商付款审批单.备注" name="8a8ad0a03dac251a013daeca49500c3e">
                </td>
            </tr>
            <tr>
                <td class="FieldName" nowrap="">
                    合同结算条款
                </td>
                <td class="FieldValue" colspan="3">
                    <input id="$8a8ad0944c305396014c4a9dc3400174$" class="InputStyle2" style="width: 91.43%;" value="[可编辑]供应商付款审批单.结算条款" name="8a8ad0a03dac251a013daeca49500c3e">
                </td>
            </tr>
            <tr>
                <td class="FieldName" nowrap="">
                    是否方案报批或立项流程
                </td>
                <td class="FieldValue">
                    <input id="$8a8acee272e132520172e195454301a2$" class="InputStyle2" style="width: 30%;" value="[必须输入]供应商付款审批单.是否有方案报批" name="8a8ad0a03dac251a013daeca49500c3e">
                </td>
                <td class="FieldName" nowrap="">
                    方案报批或立项流程
                </td>
                <td class="FieldValue">
                    <input id="$8a8acee272e132520172e1922b8a01a0$" class="InputStyle2" style="width: 80%;" value="[可编辑]供应商付款审批单.关联方案报批" name="8a8ad0a03dac251a013daeca49500c3e">
                </td>
            </tr>
            <tr>
                <td class="FieldName" nowrap="">
                    相关流程
                </td>
                <td class="FieldValue" colspan="3">
                    <input id="$8a8ad0a03e35f8e8013e3b57eec125f1$" class="InputStyle2" style="width: 91.43%;" size="74" value="[可编辑]供应商付款审批单.相关单据" name="8a8ad0a03dac251a013daeca49500c3e">
                </td>
            </tr>
            <tr>
                <td class="FieldName" nowrap="">
                    广告投放申请
                </td>
                <td class="FieldValue" colspan="3">
                    <input id="$8a8ad02057e02a060157e4b29896360f$" class="InputStyle2" style="width: 91.43%;" value="[可编辑]供应商付款审批单.关联区域广告" name="8a8ad0a03dac251a013daeca49500c3e">
                </td>
            </tr>
            <tr>
                <td class="FieldName" nowrap="">
                    附件
                </td>
                <td class="FieldValue" colspan="3">
                    <input id="$8a8ad0a03dac251a013daeca4d190c79$" class="InputStyle2" style="width: 91.43%;" value="[可编辑]供应商付款审批单.附件" name="8a8ad0a03dac251a013daeca49500c3e"><span style="COLOR: #ff3300">请上传发票附件</span>
                </td>
            </tr>
            <tr>
                <td class="FieldName" nowrap="">
                    sfa照片
                </td>
                <td class="FieldValue" colspan="3" mark="createsfa">
                    &nbsp;<input id="$8a8ad0205b188bb3015b1d03262420f8$" class="InputStyle2" value="[隐藏]供应商付款审批单.SFA照片" name="8a8ad0a03dac251a013daeca49500c3e" style=""><input onclick="openwindow('8a8ad0205b188bb3015b1d03262420f8')" id="btn_sfa" type="button" style="">选择照片
                    <div id="div8a8ad0205b188bb3015b1d03262420f8" style="WIDTH: 100%"></div>
                </td>
            </tr>
            <tr>
                <td style="word-break: break-all;">
                    <span style="text-align: center;">前期是否已经全额提供发票</span>
                </td>
                <td colspan="3" style="word-break: break-all;">
                    <input id="$8a8ace0f773dad73017742b1a564079e$" class="InputStyle2" style="width: 30%;" value="[必须输入]供应商付款审批单.是否为国外发票" name="8a8ad0a03dac251a013daeca49500c3e"><span id="historynoSPAN">&nbsp; 历史单据：<input type="text" class="InputStyle2" id="$8a8ace5887e2af4c0187eae44f465dbf$" name="8a8ad0a03dac251a013daeca49500c3e" value="[可编辑]供应商付款审批单.历史单据编号" style=""></span>
                </td>
            </tr>
            <tr>
                <td class="FieldName">
                    是否属于安全生产费
                </td>
                <td class="FieldValue">
                    <input type="text" class="InputStyle2" id="$8a8ace5884662758018473f94aea240c$" name="8a8ad0a03dac251a013daeca49500c3e" value="[必须输入]供应商付款审批单.是否属于安全生产费" style="">
                </td>
                <td class="FieldName" id="aqscf01">
                    安全生产费使用（入账）标准
                </td>
                <td class="FieldValue" id="aqscf02">
                    <input type="text" class="InputStyle2" id="$8a8ace5884662758018473f94b09240e$" name="8a8ad0a03dac251a013daeca49500c3e" value="[可编辑]供应商付款审批单.安全生产生产费使用（入账）标准" style="">
                </td>
            </tr>
            <tr>
                <td>
                    &nbsp;操作
                </td>
                <td colspan="3" style="word-break: break-all;" align="left" valign="top">
                    <p>
                        &nbsp;&nbsp;<input onclick="pushInvoice();" id="ppcj" type="button" value="普票采集" style="">&nbsp;<input onclick="pullInvoice();" id="zphq" type="button" value="专票获取" style=""><span style="FONT-SIZE: 18px; COLOR: #ff0000"></span>
                    </p>
                    <p id="ext-gen95">
                        <span style="FONT-SIZE: 16px"><strong><span style="COLOR: #ff0000"><strong style="font-size: 16px; text-align: center; white-space: normal;"><span style="color: rgb(255, 0, 0);"></span></strong></span></strong></span>
                    </p>
                    <p style="margin-top: 0px; margin-bottom: 0px; padding: 0px; ">
                        <span style="font-size: 14px; color: rgb(255, 0, 0);"><strong>普票采集步骤：</strong></span>
                    </p>
                    <p style="margin-top: 0px; margin-bottom: 0px; padding: 0px; ">
                        <span style="font-size: 14px; color: rgb(0, 176, 80);"><strong>1、请通过手机拍照上传到<span style="font-size: 14px; color: rgb(255, 0, 0);">“电脑桌面”或图片另存为“电脑桌面”</span></strong></span>
                    </p>
                    <p style="margin-top: 0px; margin-bottom: 0px; padding: 0px;">
                        <span style="font-size: 14px; color: rgb(0, 176, 80);"><strong>2、点击<span style="font-size: 14px; color: rgb(255, 0, 0);">“普票采集”</span>按钮，点击浏览选择要报销<span style="font-size: 14px; color: rgb(255, 0, 0);">“上传的发票”</span>图片，系统会自动填充相关数据，进行普票采集后请进行校验。</strong></span>
                    </p>
                    <p style="margin-top: 0px; margin-bottom: 0px; padding: 0px; ">
                        <span style="font-size: 14px; color: rgb(0, 176, 80);"><strong>3、校验后请在<span style="font-size: 14px; color: rgb(255, 0, 0);">发票夹</span>内选择带出即可</strong></span>
                    </p>
                    <p style="margin-top: 0px; margin-bottom: 0px; padding: 0px; ">
                        <span style="font-size: 14px; color: rgb(255, 0, 0);"><strong>专票获取步骤：</strong></span>
                    </p>
                    <p style="margin-top: 0px; margin-bottom: 0px; padding: 0px;">
                        <span style="font-size: 14px; color: rgb(0, 176, 80);"><strong>注意：</strong></span>
                    </p>
                    <p style="margin-top: 0px; margin-bottom: 0px; padding: 0px;">
                        <span style="font-size: 14px; color: rgb(0, 176, 80);"><strong>1、专票请点击“<span style="font-size: 14px; color: rgb(255, 0, 0);">专票获取</span>”，别点普票采集。<br/>2、当天的发票，隔天再操作，</strong></span>
                    </p>
                    <p id="ext-gen95">
                        <span style="FONT-SIZE: 16px"><strong><span style="COLOR: #ff0000"><strong style="font-size: 16px; text-align: center; white-space: normal;"><span style="color: rgb(255, 0, 0);"></span></strong> </span></strong></span>
                    </p>
                    <p style="margin-top: 0px; margin-bottom: 0px; padding: 0px; white-space: normal;">
                        <span style="font-size: 14px; color: rgb(255, 0, 0);"><strong>财政类/国外发票步骤：</strong></span>
                    </p>
                    <p style="margin-top: 0px; margin-bottom: 0px; padding: 0px; white-space: normal;">
                        <span style="font-size: 14px; color: rgb(0, 176, 80);"><strong>注意：</strong></span>
                    </p>
                    <p style="margin-top: 0px; margin-bottom: 0px; padding: 0px; white-space: normal;">
                        <span style="font-size: 14px; color: rgb(0, 176, 80);"><strong>1、发票清单中的发票类型选“<span style="font-size: 14px; color: rgb(255, 0, 0);">财政类/国外发票</span>”<br/>2、发票清单手动输入发票信息</strong></span>
                    </p>
                    <p id="ext-gen95">
                        <br/>
                    </p>
                </td>
            </tr>
            <tr>
                <td colspan="1" rowspan="1" align="center" style="word-break: break-all;">
                    <strong style="text-align: center; white-space: normal; color: rgb(255, 0, 0);"><strong style="font-family: &quot;Microsoft YaHei&quot;, &quot;Segoe UI&quot;, Verdana, Tahoma; font-size: 16px; white-space: normal; color: rgb(255, 0, 0); text-align: center;">发票夹</strong></strong>
                </td>
                <td colspan="1" rowspan="1" style="word-break: break-all;">
                    <input type="text" class="InputStyle2" id="$8a8ace58851a7266018528a463cd1cdf$" name="8a8ad0a03dac251a013daeca49500c3e" value="[可编辑]供应商付款审批单.发票" style="">&nbsp;<strong style="text-align: center; white-space: normal; color: rgb(255, 0, 0); font-size: 14px;">普票采集</strong><strong style="text-align: center; white-space: normal; color: rgb(0, 176, 80); font-size: 14px;">校验后请点击左边<span style="font-size: 14px; color: rgb(255, 0, 0);">发票夹</span>内选择带出即可</strong><input onclick="showDig2()" type="button" value="删除发票" style="">
                </td>
                <td colspan="1" rowspan="1" style="word-break: break-all;">
                    <strong style="text-align: center; white-space: normal; color: rgb(255, 0, 0);">数据获取（选择发票夹数据会自动填充发票清单表数据）</strong>
                </td>
                <td colspan="1" rowspan="1"></td>
            </tr>
            </tbody>
        </table>
        <table id="oTable8a8ad0945548e36a0155c2d5bff814e8" class="detailtable" style="display: none" border="1">
            <caption>
                增值税专用发票填写表&nbsp;<span id="div8a8ad0945548e36a0155c2d5bff814e8button" name="div8a8ad0945548e36a0155c2d5bff814e8button"><a href="javascript:addrow('8a8ad0945548e36a0155c2d5bff814e8');"><img title="New" border="0" src="/images/plus.gif" width="11" height="11"/></a>&nbsp;<a href="javascript:delrow('8a8ad0945548e36a0155c2d5bff814e8');"><img title="Delete" border="0" src="/images/minus.gif" width="11" height="11"/></a>&nbsp;</span>
            </caption>
            <colgroup>
                <col width="10%">
                <col width="10%">
                <col width="10%">
                <col width="10%">
                <col width="10%">
                <col width="10%">
                <col width="10%">
                <col width="10%">







            </colgroup>
            <tbody>
            <tr class="Header firstRow" style="BACKGROUND: #8edddd" firstrow="firstRow">
                <td nowrap="">
                    <input onclick="selectAll(this,'8a8ad0945548e36a0155c2d5bff814e8')" id="check_node_all" type="checkbox" value="-1" name="check_node_all">OA单号
                </td>
                <td nowrap="">
                    发票号
                </td>
                <td nowrap="">
                    开票日期
                </td>
                <td nowrap="">
                    不含税金额
                </td>
                <td nowrap="">
                    税率
                </td>
                <td nowrap="">
                    税额
                </td>
                <td nowrap="">
                    价税合计
                </td>
                <td nowrap="">
                    开票项目
                </td>
            </tr>
            <tr class="DataLight">
                <td nowrap="">
                    <input id="$8a8ad0945548e36a0155c2e099b014e9$" class="InputStyle2" style="WIDTH: 80%" value="[只读]抵扣联交接单.OA单号" name="8a8ad0945548e36a0155c2d5bff814e8">
                </td>
                <td nowrap="">
                    <input id="$8a8ad0945548e36a0155c2e09a3c14eb$" class="InputStyle2" style="width: 80%;" value="[可编辑]抵扣联交接单.发票号" name="8a8ad0945548e36a0155c2d5bff814e8">
                </td>
                <td nowrap="">
                    <input id="$8a8ad0205c15b6b8015c1a5015cf1c26$" class="InputStyle2" style="width: 80%;" value="[可编辑]抵扣联交接单.开票日期" name="8a8ad0945548e36a0155c2d5bff814e8">
                </td>
                <td nowrap="">
                    <input id="$8a8ad0945548e36a0155c2e09ab914ef$" class="InputStyle2" style="WIDTH: 80%" value="[只读]抵扣联交接单.不含税金额" name="8a8ad0945548e36a0155c2d5bff814e8">
                </td>
                <td nowrap="">
                    <input id="$8a8ad0f855e7be41015601caad804979$" class="InputStyle2" style="width: 80%;" value="[只读]抵扣联交接单.税率" name="8a8ad0945548e36a0155c2d5bff814e8">
                </td>
                <td nowrap="">
                    <input id="$8a8ad0945548e36a0155c2e09b0714f1$" class="InputStyle2" style="width: 80%;" value="[只读]抵扣联交接单.税金" name="8a8ad0945548e36a0155c2d5bff814e8">
                </td>
                <td nowrap="">
                    <input id="$8a8ad0945548e36a0155c2e09b5614f3$" class="InputStyle2" style="WIDTH: 80%" value="[只读]抵扣联交接单.价税合计" name="8a8ad0945548e36a0155c2d5bff814e8">
                </td>
                <td nowrap="">
                    <input id="$8a8ad0de5d8ccd36015da1c4aa1168a7$" class="InputStyle2" style="width: 80%;" value="[可编辑]抵扣联交接单（专票）.发票项目" name="8a8ad0945548e36a0155c2d5bff814e8">
                </td>
            </tr>
            </tbody>
        </table>
        <div style="display: none">
            <table id="oTable8a8ad0f850d1a5d80150d585559159e6" class="detailtable" border="1">
                <caption>
                    银企直连子表<span id="div8a8ad0f850d1a5d80150d585559159e6button" name="div8a8ad0f850d1a5d80150d585559159e6button"><a href="javascript:resetaddrow();"><img title="New" border="0" src="/images/plus.gif" width="11" height="11"/></a>&nbsp;<a href="javascript:delrow('8a8ad0f850d1a5d80150d585559159e6');"><img title="Delete" border="0" src="/images/minus.gif" width="11" height="11"/></a>&nbsp;<a href="javascript:addrowbyexcel('8a8ad0f850d1a5d80150d585559159e6');"><img title="Excel" border="0" src="/images/excel.gif" width="11" height="11"/></a></span>
                </caption>
                <colgroup>
                    <col width="5%">
                    <col width="5%">
                    <col width="5%">
                    <col width="5%">
                    <col width="5%">
                    <col width="5%">
                    <col width="5%">
                    <col width="5%">
                    <col width="5%">
                    <col width="5%">
                    <col width="5%">
                    <col width="5%">
                    <col width="5%">
                    <col width="5%">
                    <col width="5%">
                    <col width="5%">
                    <col width="5%">
                    <col width="5%">
                    <col width="5%">


















                </colgroup>
                <tbody>
                <tr class="Header firstRow" style="BACKGROUND: #8edddd" firstrow="firstRow">
                    <td nowrap="">
                        <input onclick="selectAll(this,'8a8ad0f850d1a5d80150d585559159e6')" id="check_node_all" type="checkbox" value="-1" name="check_node_all" style="">公司
                    </td>
                    <td nowrap="">
                        付款日期
                    </td>
                    <td colspan="2" nowrap="">
                        付款类型
                    </td>
                    <td nowrap="">
                        流程编号
                    </td>
                    <td colspan="2" nowrap="">
                        流程名称
                    </td>
                    <td colspan="2" nowrap="">
                        收款方
                    </td>
                    <td nowrap="">
                        金额
                    </td>
                    <td nowrap="">
                        付款方式
                    </td>
                    <td nowrap="">
                        银行账号
                    </td>
                    <td colspan="2" nowrap="">
                        开户行
                    </td>
                    <td colspan="2" nowrap="">
                        银行名称
                    </td>
                    <td colspan="2" nowrap="">
                        银行省市
                    </td>
                </tr>
                <tr class="DataLight">
                    <td nowrap="">
                        <input id="$8a8ad0f850d1a5d80150d59b44ae59f7$" class="InputStyle2" style="width: 95%;" value="[可编辑]银企直连子表.公司代码" name="8a8ad0f850d1a5d80150d585559159e6">
                    </td>
                    <td nowrap="">
                        <input id="$8a8ad0f850d1a5d80150d59b452b59f9$" class="InputStyle2" style="WIDTH: 95%" value="[可编辑]银企直连子表.付款日期" name="8a8ad0f850d1a5d80150d585559159e6">
                    </td>
                    <td nowrap="">
                        <input id="$8a8ad0f850d1a5d80150d59b45c759fb$" class="InputStyle2" style="width: 95%;" value="[可编辑]银企直连子表.付款类型编号" name="8a8ad0f850d1a5d80150d585559159e6">
                    </td>
                    <td nowrap="">
                        <input id="$8a8ad0f850d1a5d80150d59b463559fd$" class="InputStyle2" style="WIDTH: 95%" value="[可编辑]银企直连子表.付款类型名称" name="8a8ad0f850d1a5d80150d585559159e6">
                    </td>
                    <td nowrap="">
                        <input id="$8a8ad0f850d1a5d80150d59b469259ff$" class="InputStyle2" style="width: 95%;" value="[可编辑]银企直连子表.流程编号" name="8a8ad0f850d1a5d80150d585559159e6">
                    </td>
                    <td nowrap="">
                        <input id="$8a8ad0f850d1a5d80150d59b46f05a01$" class="InputStyle2" style="width: 95%;" value="[可编辑]银企直连子表.流程名称编号" name="8a8ad0f850d1a5d80150d585559159e6">
                    </td>
                    <td nowrap="">
                        <input id="$8a8ad0f850d1a5d80150d59b474e5a03$" class="InputStyle2" style="WIDTH: 95%" value="[可编辑]银企直连子表.流程名称" name="8a8ad0f850d1a5d80150d585559159e6">
                    </td>
                    <td nowrap="">
                        <input id="$8a8ad0f850d1a5d80150d59b4ba35a05$" class="InputStyle2" style="width: 95%;" value="[可编辑]银企直连子表.收款方编号" name="8a8ad0f850d1a5d80150d585559159e6">
                    </td>
                    <td nowrap="">
                        <input id="$8a8ad0f850d1a5d80150d59b4dd65a07$" class="InputStyle2" style="width: 95%;" value="[可编辑]银企直连子表.收款方名称" name="8a8ad0f850d1a5d80150d585559159e6">
                    </td>
                    <td nowrap="">
                        <input id="$8a8ad0f850d1a5d80150d59b50185a11$" class="InputStyle2" style="width: 95%;" value="[必须输入]银企直连子表.付款金额" name="8a8ad0f850d1a5d80150d585559159e6">
                    </td>
                    <td nowrap="">
                        <input id="$8a8ad0f850d1a5d80150d59b50665a13$" class="InputStyle2" style="WIDTH: 95%" value="[必须输入]银企直连子表.付款方式" name="8a8ad0f850d1a5d80150d585559159e6">
                    </td>
                    <td nowrap="">
                        <input id="$8a8ad0f850d1a5d80150d59b4e535a09$" class="InputStyle2" style="width: 95%;" value="[可编辑]银企直连子表.银行账号" name="8a8ad0f850d1a5d80150d585559159e6">
                    </td>
                    <td nowrap="">
                        <input id="$8a8ad0f850d1a5d80150d59b4eff5a0d$" class="InputStyle2" style="width: 95%;" value="[可编辑]银企直连子表.银行行号" name="8a8ad0f850d1a5d80150d585559159e6">
                    </td>
                    <td nowrap="">
                        <input id="$8a8ad0f850d1a5d80150d59b4eb15a0b$" class="InputStyle2" style="width: 95%;" value="[可编辑]银企直连子表.开户行" name="8a8ad0f850d1a5d80150d585559159e6">
                    </td>
                    <td nowrap="">
                        <input id="$8a8ad0f850f9f4b70151130bf0890319$" class="InputStyle2" style="width: 95%;" value="[可编辑]银企直连子表.银行代码SAP" name="8a8ad0f850d1a5d80150d585559159e6">
                    </td>
                    <td nowrap="">
                        <input id="$8a8ad0f850f9f4b70151130bf0d7031b$" class="InputStyle2" style="width: 95%;" value="[可编辑]银企直连子表.银行名称SAP" name="8a8ad0f850d1a5d80150d585559159e6">
                    </td>
                    <td nowrap="">
                        <input id="$8a8ad0f850d1a5d80150d59b4f6c5a0f$" class="InputStyle2" style="width: 95%;" value="[可编辑]银企直连子表.银行省市代码" name="8a8ad0f850d1a5d80150d585559159e6">
                    </td>
                    <td nowrap="">
                        <input id="$8a8ad09550b837f50150d5b7e28a4d26$" class="InputStyle2" style="width: 95%;" value="[可编辑]银企直连子表.银行省市名称" name="8a8ad0f850d1a5d80150d585559159e6">
                    </td>
                </tr>
                <tr>
                    <td colspan="9">
                        <p style="TEXT-ALIGN: right">
                            合计
                        </p>
                    </td>
                    <td>
                        <input id="$8a8ad020514734200151520f668c461f$" class="InputStyle2" style="height: 19px; width: 54px;" size="4" value="[可编辑]供应商付款审批单.拆分合计" name="8a8ad0a03dac251a013daeca49500c3e">
                    </td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                </tr>
                </tbody>
            </table>
        </div>
        <table class="layouttable" style="display: none" border="1">
            <colgroup>
                <col width="12%">
                <col width="12%">
                <col width="12%">
                <col width="12%">
                <col width="12%">
                <col width="12%">
                <col width="12%">
                <col width="12%">







            </colgroup>
            <tbody>
            <tr class="firstRow">
                <td bgcolor="#8edddd" colspan="8">
                    <p style="TEXT-ALIGN: center">
                        <span style="FONT-SIZE: 16px"><strong>会计凭证信息</strong></span>
                    </p>
                </td>
            </tr>
            <tr>
                <td class="FieldName" nowrap="">
                    凭证日期
                </td>
                <td class="FieldValue">
                    <input id="$8a8ad0a03bdfcae1013c0955eb9405ca$" class="InputStyle2" style="height: 19px; width: 95%;" value="[只读]报销会计凭证-头信息.凭证日期" name="8a8ad0a03bdfcae1013c094fb2030578">
                </td>
                <td class="FieldName" nowrap="">
                    凭证类型
                </td>
                <td class="FieldValue">
                    <input id="$8a8ad0a03bdfcae1013c0955ebb405cc$" class="InputStyle2" style="height: 19px; width: 80.76%;" size="2" value="[可编辑]报销会计凭证-头信息.凭证类型" name="8a8ad0a03bdfcae1013c094fb2030578">
                </td>
                <td class="FieldName" nowrap="">
                    公司代码
                </td>
                <td class="FieldValue">
                    <input id="$8a8ad0a03bdfcae1013c0955ebc305ce$" class="InputStyle2" style="height: 19px; width: 78.61%;" size="9" value="[可编辑]报销会计凭证-头信息.公司代码" name="8a8ad0a03bdfcae1013c094fb2030578">
                </td>
                <td class="FieldName" nowrap="">
                    SAP凭证号
                </td>
                <td class="FieldValue">
                    <input id="$8a8ad0a03bdfcae1013c0955ebe205d0$" class="InputStyle2" style="width: 95%;" value="[只读]报销会计凭证-头信息.SAP凭证号" name="8a8ad0a03bdfcae1013c094fb2030578">
                </td>
            </tr>
            <tr>
                <td class="FieldName" nowrap="">
                    过账日期
                </td>
                <td class="FieldValue">
                    <input id="$8a8ad0a03bdfcae1013c0955ebf205d2$" class="InputStyle2" style="height: 19px; width: 95%;" value="[只读]报销会计凭证-头信息.过账日期" name="8a8ad0a03bdfcae1013c094fb2030578">
                </td>
                <td class="FieldName" nowrap="">
                    过账期间
                </td>
                <td class="FieldValue">
                    <input id="$8a8ad0a03bdfcae1013c0955ec1105d4$" class="InputStyle2" style="height: 19px; width: 86%;" size="8" value="[可编辑]报销会计凭证-头信息.过账期间" name="8a8ad0a03bdfcae1013c094fb2030578">
                </td>
                <td class="FieldName" nowrap="">
                    货币
                </td>
                <td class="FieldValue">
                    <input id="$8a8ad0a03bdfcae1013c0955ec2105d6$" class="InputStyle2" style="height: 19px; width: 76.31%;" size="1" value="[可编辑]报销会计凭证-头信息.货币" name="8a8ad0a03bdfcae1013c094fb2030578">
                </td>
                <td class="FieldName" nowrap="">
                    参考号
                </td>
                <td class="FieldValue">
                    <input id="$8a8ad0a03bdfcae1013c0955ec4005d8$" class="InputStyle2" style="WIDTH: 95%" value="[只读]报销会计凭证-头信息.参考号" name="8a8ad0a03bdfcae1013c094fb2030578">
                </td>
            </tr>
            <tr>
                <td class="FieldName" nowrap="">
                    抬头文本
                </td>
                <td class="FieldValue" colspan="5">
                    <input id="$8a8ad0a03bdfcae1013c0955ec5005da$" class="InputStyle2" style="height: 19px; width: 95%;" value="[可编辑]报销会计凭证-头信息.抬头文本" name="8a8ad0a03bdfcae1013c094fb2030578">
                </td>
                <td class="FieldName" nowrap="">
                    附件
                </td>
                <td class="FieldValue">
                    <input id="$8a8ad0a03bdfcae1013c0955ec6f05dc$" class="InputStyle2" style="WIDTH: 95%" value="[可编辑]报销会计凭证-头信息.附件" name="8a8ad0a03bdfcae1013c094fb2030578">
                </td>
            </tr>
            </tbody>
        </table>
        <table id="oTable8a8ad0a03dac251a013db0db05c23456" class="detailtable" style="display: none" border="1">
            <caption>
                借方凭证<span id="div8a8ad0a03dac251a013db0db05c23456button" name="div8a8ad0a03dac251a013db0db05c23456button"><a href="javascript:addrow('8a8ad0a03dac251a013db0db05c23456');"><img title="New" border="0" src="/images/plus.gif" width="11" height="11"/></a>&nbsp;<a href="javascript:delrow('8a8ad0a03dac251a013db0db05c23456');"><img title="Delete" border="0" src="/images/minus.gif" width="11" height="11"/></a>&nbsp;<a href="javascript:addrowbyexcel('8a8ad0a03dac251a013db0db05c23456');"></a></span>
            </caption>
            <colgroup>
                <col width="4%">
                <col width="4%">
                <col width="10%">
                <col width="20%">
                <col width="8%">
                <col width="8%">
                <col width="15%">
                <col width="5%">







            </colgroup>
            <tbody>
            <tr class="Header firstRow" style="BACKGROUND: #8edddd" firstrow="firstRow">
                <td nowrap="">
                    <input onclick="selectAll(this,'8a8ad0a03dac251a013db0db05c23456')" id="check_node_all" type="checkbox" value="-1" name="check_node_all">序号
                </td>
                <td nowrap="">
                    记账代码
                </td>
                <td nowrap="">
                    会计科目编号
                </td>
                <td nowrap="">
                    科目描述
                </td>
                <td nowrap="">
                    金额
                </td>
                <td nowrap="">
                    付款基准日
                </td>
                <td nowrap="">
                    行项目文本
                </td>
                <td nowrap="">
                    原因代码
                </td>
            </tr>
            <tr class="DataLight">
                <td nowrap="">
                    <input id="$8a8ad0a03dac251a013db0db064f3457$" class="InputStyle2" style="HEIGHT: 19px; WIDTH: 53.88%" size="4" value="[只读]供应商付款-借方凭证.借方序号" name="8a8ad0a03dac251a013db0db05c23456">
                </td>
                <td nowrap="">
                    <input id="$8a8ad0a03dac251a013db0db066e3459$" class="InputStyle2" style="height: 19px; width: 61.36%;" size="1" value="[可编辑]供应商付款-借方凭证.借方记账代码" name="8a8ad0a03dac251a013db0db05c23456">
                </td>
                <td nowrap="">
                    <input id="$8a8ad0a03dac251a013db0db067d345b$" class="InputStyle2" style="height: 19px; width: 83.15%;" size="5" value="[可编辑]供应商付款-借方凭证.借方会计科目编号" name="8a8ad0a03dac251a013db0db05c23456">
                </td>
                <td>
                    <input id="$8a8ad0a03dac251a013db0db069d345d$" class="InputStyle2" style="width: 98%;" value="[只读]供应商付款-借方凭证.借方科目描述" name="8a8ad0a03dac251a013db0db05c23456">
                </td>
                <td nowrap="">
                    <input id="$8a8ad0a03dac251a013db0db06ac345f$" class="InputStyle2" style="width: 95%;" value="[可编辑]供应商付款-借方凭证.借方金额" name="8a8ad0a03dac251a013db0db05c23456">
                </td>
                <td nowrap="">
                    <input id="$8a8ad0a03dac251a013db0db06cc3461$" class="InputStyle2" style="height: 19px; width: 106px;" size="1" value="[可编辑]供应商付款-借方凭证.付款基准日" name="8a8ad0a03dac251a013db0db05c23456">
                </td>
                <td nowrap="">
                    <input id="$8a8ad0a03dac251a013db0db06db3463$" class="InputStyle2" style="width: 95%;" value="[可编辑]供应商付款-借方凭证.借方行项目文本" name="8a8ad0a03dac251a013db0db05c23456">
                </td>
                <td nowrap="">
                    <input id="$8a8ad0a03dac251a013db0db070a3465$" class="InputStyle2" style="height: 19px; width: 81.16%;" size="12" value="[只读]供应商付款-借方凭证.原因代码" name="8a8ad0a03dac251a013db0db05c23456">
                </td>
            </tr>
            </tbody>
        </table>
        <table id="oTable8a8ad0a03f2bc884013f2c1046500215" class="detailtable" style="display: none" border="1">
            <caption>
                借方科目凭证<span id="div8a8ad0a03f2bc884013f2c1046500215button" name="div8a8ad0a03f2bc884013f2c1046500215button"><a href="javascript:addrow('8a8ad0a03f2bc884013f2c1046500215');"><img title="New" border="0" src="/images/plus.gif" width="11" height="11"/></a> <a href="javascript:delrow('8a8ad0a03f2bc884013f2c1046500215');"><img title="Delete" border="0" src="/images/minus.gif" width="11" height="11"/></a> <a href="javascript:addrowbyexcel('8a8ad0a03f2bc884013f2c1046500215');"></a></span>
            </caption>
            <colgroup>
                <col width="4%">
                <col width="4%">
                <col width="10%">
                <col width="20%">
                <col width="8%">
                <col width="8%">
                <col width="20%">
                <col width="5%">







            </colgroup>
            <tbody>
            <tr class="Header firstRow" style="BACKGROUND: #8edddd" firstrow="firstRow">
                <td nowrap="">
                    <input onclick="selectAll(this,'8a8ad0a03f2bc884013f2c1046500215')" id="check_node_all" type="checkbox" value="-1" name="check_node_all">序号
                </td>
                <td nowrap="">
                    记账代码
                </td>
                <td nowrap="">
                    会计科目编号
                </td>
                <td nowrap="">
                    科目描述
                </td>
                <td nowrap="">
                    金额
                </td>
                <td nowrap="">
                    成本中心
                </td>
                <td nowrap="">
                    行项目文本
                </td>
                <td nowrap="">
                    原因代码
                </td>
                <td>
                    &nbsp;实际费用科目
                </td>
            </tr>
            <tr class="DataLight">
                <td nowrap="">
                    <input id="$8a8ad0a03f2bc884013f2c1047a80216$" class="InputStyle2" style="WIDTH: 80%" value="[可编辑]B类付款-借方科目凭证.贷方序号" name="8a8ad0a03f2bc884013f2c1046500215">
                </td>
                <td nowrap="">
                    <input id="$8a8ad0a03f2bc884013f2c1047c70218$" class="InputStyle2" style="WIDTH: 80%" value="[可编辑]B类付款-借方科目凭证.贷方记账代码" name="8a8ad0a03f2bc884013f2c1046500215">
                </td>
                <td nowrap="">
                    <input id="$8a8ad0a03f2bc884013f2c1047f6021a$" class="InputStyle2" style="WIDTH: 80%" value="[可编辑]B类付款-借方科目凭证.贷方会计科目编号" name="8a8ad0a03f2bc884013f2c1046500215">
                </td>
                <td nowrap="">
                    <input id="$8a8ad0a03f2bc884013f2c104816021c$" class="InputStyle2" style="width: 80%;" value="[可编辑]B类付款-借方科目凭证.贷方科目描述" name="8a8ad0a03f2bc884013f2c1046500215">
                </td>
                <td nowrap="">
                    <input id="$8a8ad0a03f2bc884013f2c104844021e$" class="InputStyle2" style="width: 80%;" value="[可编辑]B类付款-借方科目凭证.贷方金额" name="8a8ad0a03f2bc884013f2c1046500215">
                </td>
                <td nowrap="">
                    <input id="$8a8ad0a03f889674013f88d54c12065e$" class="InputStyle2" style="height: 19px; width: 102px;" size="1" value="[可编辑]B类付款-借方科目凭证.成本中心" name="8a8ad0a03f2bc884013f2c1046500215">
                </td>
                <td nowrap="">
                    <input id="$8a8ad0a03f2bc884013f2c1048930222$" class="InputStyle2" style="width: 80%;" value="[可编辑]B类付款-借方科目凭证.贷方行项目文本" name="8a8ad0a03f2bc884013f2c1046500215">
                </td>
                <td nowrap="">
                    <input id="$8a8ad0a03f2bc884013f2c1048b20224$" class="InputStyle2" style="WIDTH: 80%" value="[可编辑]B类付款-借方科目凭证.原因代码" name="8a8ad0a03f2bc884013f2c1046500215">
                </td>
                <td>
                    &nbsp;<input id="$8a8ad0944b573a24014bfbfd531c04a9$" class="InputStyle2" value="[只读]B类付款-借方科目凭证.实际费用科目" name="8a8ad0a03f2bc884013f2c1046500215">
                </td>
            </tr>
            </tbody>
        </table>
        <table id="oTable8a8ad0a03bdfcae1013c095eda0406dc" class="detailtable" style="display: none" border="1">
            <caption>
                贷方凭证<span id="div8a8ad0a03bdfcae1013c095eda0406dcbutton" name="div8a8ad0a03bdfcae1013c095eda0406dcbutton"><a href="javascript:addrow('8a8ad0a03bdfcae1013c095eda0406dc');"><img title="New" border="0" src="/images/plus.gif" width="11" height="11"/></a>&nbsp;<a href="javascript:delrow('8a8ad0a03bdfcae1013c095eda0406dc');"><img title="Delete" border="0" src="/images/minus.gif" width="11" height="11"/></a>&nbsp;<a href="javascript:addrowbyexcel('8a8ad0a03bdfcae1013c095eda0406dc');"></a></span>
            </caption>
            <colgroup>
                <col width="4%">
                <col width="4%">
                <col width="10%">
                <col width="20%">
                <col width="8%">
                <col width="20%">
                <col width="5%">






            </colgroup>
            <tbody>
            <tr class="Header firstRow" style="BACKGROUND: #8edddd" firstrow="firstRow">
                <td nowrap="">
                    <input onclick="selectAll(this,'8a8ad0a03bdfcae1013c095eda0406dc')" id="check_node_all" type="checkbox" value="-1" name="check_node_all">序号
                </td>
                <td nowrap="">
                    记账代码
                </td>
                <td nowrap="">
                    会计科目编号
                </td>
                <td nowrap="">
                    科目描述
                </td>
                <td nowrap="">
                    金额
                </td>
                <td nowrap="">
                    行项目文本
                </td>
                <td nowrap="">
                    原因代码
                </td>
            </tr>
            <tr class="DataLight">
                <td nowrap="">
                    <input id="$8a8ad0a03bdfcae1013c0962c0bc0704$" class="InputStyle2" style="height: 19px; width: 62.32%;" size="8" value="[只读]贷方凭证.贷方序号" name="8a8ad0a03bdfcae1013c095eda0406dc">
                </td>
                <td nowrap="">
                    <input id="$8a8ad0a03bdfcae1013c0962c0eb0706$" class="InputStyle2" style="height: 19px; width: 55%;" size="3" value="[可编辑]贷方凭证.贷方记账代码" name="8a8ad0a03bdfcae1013c095eda0406dc">
                </td>
                <td nowrap="">
                    <input id="$8a8ad0a03bdfcae1013c0962c0fb0708$" class="InputStyle2" style="height: 19px; width: 74.27%;" size="1" value="[可编辑]贷方凭证.贷方会计科目编号" name="8a8ad0a03bdfcae1013c095eda0406dc">
                </td>
                <td>
                    <input id="$8a8ad0a03bdfcae1013c0962c11a070a$" class="InputStyle2" style="width: 98%;" value="[只读]贷方凭证.贷方科目描述" name="8a8ad0a03bdfcae1013c095eda0406dc">
                </td>
                <td nowrap="">
                    <input id="$8a8ad0a03bdfcae1013c0962c159070c$" class="InputStyle2" style="width: 95%;" value="[可编辑]贷方凭证.贷方金额" name="8a8ad0a03bdfcae1013c095eda0406dc">
                </td>
                <td nowrap="">
                    <input id="$8a8ad0a03bdfcae1013c0962c1a70710$" class="InputStyle2" style="width: 95%;" value="[可编辑]贷方凭证.贷方行项目文本" name="8a8ad0a03bdfcae1013c095eda0406dc">
                </td>
                <td nowrap="">
                    <input id="$8a8ad0a03bdfcae1013c0962c1e50739$" class="InputStyle2" style="HEIGHT: 19px; WIDTH: 67.32%" size="5" value="[可编辑]贷方凭证.原因代码" name="8a8ad0a03bdfcae1013c095eda0406dc">
                </td>
            </tr>
            </tbody>
        </table>
        <table id="oTable8a8ad0a03f408879013f4fb2fd4b20d2" class="detailtable" style="display: none" border="1">
            <caption>
                付款-贷方应付汇票凭证<span id="div8a8ad0a03f408879013f4fb2fd4b20d2button" name="div8a8ad0a03f408879013f4fb2fd4b20d2button"><a href="javascript:addrow('8a8ad0a03f408879013f4fb2fd4b20d2');"><img title="New" border="0" src="/images/plus.gif" width="11" height="11"/></a>&nbsp;<a href="javascript:delrow('8a8ad0a03f408879013f4fb2fd4b20d2');"><img title="Delete" border="0" src="/images/minus.gif" width="11" height="11"/></a>&nbsp;&nbsp; <span style="COLOR: #ff0000">提示：录入的特殊总账标识如果是字母的请用大写</span><a href="javascript:addrowbyexcel('8a8ad0a03f408879013f4fb2fd4b20d2');"></a></span>
            </caption>
            <colgroup>
                <col width="5%">
                <col width="5%">
                <col width="5%">
                <col width="8%">
                <col width="15%">
                <col width="5%">
                <col width="5%">
                <col width="25%">







            </colgroup>
            <tbody>
            <tr class="Header firstRow" style="BACKGROUND: #8edddd" firstrow="firstRow">
                <td nowrap="">
                    <input onclick="selectAll(this,'8a8ad0a03f408879013f4fb2fd4b20d2')" id="check_node_all" type="checkbox" value="-1" name="check_node_all" style="">序号
                </td>
                <td nowrap="">
                    记账代码
                </td>
                <td nowrap="">
                    G/L标识
                </td>
                <td nowrap="">
                    供应商编号
                </td>
                <td nowrap="">
                    供应商名称
                </td>
                <td nowrap="">
                    金额
                </td>
                <td nowrap="">
                    付款基准日
                </td>
                <td nowrap="">
                    行项目文本
                </td>
            </tr>
            <tr class="DataLight">
                <td nowrap="">
                    <input id="$8a8ad0a03f408879013f4fb2ff3f20d5$" class="InputStyle2" style="height: 19px; width: 36px;" size="1" value="[可编辑]付款-贷方应付汇票凭证.贷方序号" name="8a8ad0a03f408879013f4fb2fd4b20d2">
                </td>
                <td nowrap="">
                    <input id="$8a8ad0a03f408879013f4fb2ff5e20d7$" class="InputStyle2" style="height: 19px; width: 48px;" size="1" value="[可编辑]付款-贷方应付汇票凭证.贷方记账代码" name="8a8ad0a03f408879013f4fb2fd4b20d2">
                </td>
                <td nowrap="">
                    <input id="$8a8ad0a03f408879013f4fb2ff1020d3$" class="InputStyle2" style="height: 19px; width: 56px;" size="1" value="[可编辑]付款-贷方应付汇票凭证.特殊总账标识" name="8a8ad0a03f408879013f4fb2fd4b20d2">
                </td>
                <td nowrap="">
                    <input id="$8a8ad0a03f408879013f4fb2ff8d20d9$" class="InputStyle2" style="height: 19px; width: 120px;" size="6" value="[可编辑]付款-贷方应付汇票凭证.客户号" name="8a8ad0a03f408879013f4fb2fd4b20d2">
                </td>
                <td>
                    <input id="$8a8ad0a03f408879013f4fb2ffac20db$" class="InputStyle2" style="height: 19px; width: 93.29%;" value="[只读]付款-贷方应付汇票凭证.客户描述" name="8a8ad0a03f408879013f4fb2fd4b20d2">
                </td>
                <td nowrap="">
                    <input id="$8a8ad0a03f408879013f4fb2ffcb20dd$" class="InputStyle2" style="width: 80%;" value="[可编辑]付款-贷方应付汇票凭证.贷方金额" name="8a8ad0a03f408879013f4fb2fd4b20d2">
                </td>
                <td nowrap="">
                    <input id="$8a8ad0a03f408879013f4fb2fffa20df$" class="InputStyle2" style="height: 19px; width: 67px;" size="1" value="[可编辑]付款-贷方应付汇票凭证.付款基准日" name="8a8ad0a03f408879013f4fb2fd4b20d2">
                </td>
                <td nowrap="">
                    <input id="$8a8ad0a03f408879013f4fb3001a20e1$" class="InputStyle2" style="HEIGHT: 19px; WIDTH: 97.52%" value="[可编辑]付款-贷方应付汇票凭证.贷方行项目文本" name="8a8ad0a03f408879013f4fb2fd4b20d2">
                </td>
            </tr>
            </tbody>
        </table>
        <table id="oTable8a8ad0a03f408879013f4fb1185e20bb" class="detailtable" style="display: none" border="1">
            <caption>
                付款-贷方应收汇票凭证<span id="div8a8ad0a03f408879013f4fb1185e20bbbutton" name="div8a8ad0a03f408879013f4fb1185e20bbbutton"><a href="javascript:addrow('8a8ad0a03f408879013f4fb1185e20bb');"><img title="New" border="0" src="/images/plus.gif" width="11" height="11"/></a>&nbsp;<a href="javascript:delrow('8a8ad0a03f408879013f4fb1185e20bb');"><img title="Delete" border="0" src="/images/minus.gif" width="11" height="11"/></a>&nbsp;&nbsp; <span style="COLOR: #ff0000">提示：录入的特殊总账标识如果是字母的请用大写</span><a href="javascript:addrowbyexcel('8a8ad0a03f408879013f4fb1185e20bb');"></a></span>
            </caption>
            <colgroup>
                <col width="5%">
                <col width="5%">
                <col width="5%">
                <col width="8%">
                <col width="15%">
                <col width="5%">
                <col width="5%">
                <col width="25%">







            </colgroup>
            <tbody>
            <tr class="Header firstRow" style="BACKGROUND: #8edddd" firstrow="firstRow">
                <td nowrap="">
                    <input onclick="selectAll(this,'8a8ad0a03f408879013f4fb1185e20bb')" id="check_node_all" type="checkbox" value="-1" name="check_node_all">序号
                </td>
                <td nowrap="">
                    记账代码
                </td>
                <td nowrap="">
                    G/L标识
                </td>
                <td nowrap="">
                    客户编号
                </td>
                <td nowrap="">
                    客户名称
                </td>
                <td nowrap="">
                    金额
                </td>
                <td nowrap="">
                    付款基准日
                </td>
                <td nowrap="">
                    行项目文本
                </td>
            </tr>
            <tr class="DataLight">
                <td nowrap="">
                    <input id="$8a8ad0a03f408879013f4fb1263920be$" class="InputStyle2" style="HEIGHT: 19px; WIDTH: 54.17%" size="4" value="[可编辑]付款-贷方应收汇票凭证.贷方序号" name="8a8ad0a03f408879013f4fb1185e20bb">
                </td>
                <td nowrap="">
                    <input id="$8a8ad0a03f408879013f4fb1289a20c0$" class="InputStyle2" style="height: 19px; width: 66.4%;" size="10" value="[可编辑]付款-贷方应收汇票凭证.贷方记账代码" name="8a8ad0a03f408879013f4fb1185e20bb">
                </td>
                <td nowrap="">
                    <input id="$8a8ad0a03f408879013f4fb1252f20bc$" class="InputStyle2" style="height: 19px; width: 69.12%;" size="12" value="[可编辑]付款-贷方应收汇票凭证.特殊总账标识" name="8a8ad0a03f408879013f4fb1185e20bb">
                </td>
                <td nowrap="">
                    <input id="$8a8ad0a03f408879013f4fb12a2120c2$" class="InputStyle2" style="width: 80%;" value="[可编辑]付款-贷方应收汇票凭证.客户号" name="8a8ad0a03f408879013f4fb1185e20bb">
                </td>
                <td>
                    <input id="$8a8ad0a03f408879013f4fb12abd20c4$" class="InputStyle2" style="height: 19px; width: 95.37%;" size="18" value="[只读]付款-贷方应收汇票凭证.客户描述" name="8a8ad0a03f408879013f4fb1185e20bb">
                </td>
                <td nowrap="">
                    <input id="$8a8ad0a03f408879013f4fb12b7920c6$" class="InputStyle2" style="width: 80%;" value="[可编辑]付款-贷方应收汇票凭证.贷方金额" name="8a8ad0a03f408879013f4fb1185e20bb">
                </td>
                <td nowrap="">
                    <input id="$8a8ad0a03f408879013f4fb12ce020c8$" class="InputStyle2" style="height: 19px; width: 65px;" size="1" value="[可编辑]付款-贷方应收汇票凭证.付款基准日" name="8a8ad0a03f408879013f4fb1185e20bb">
                </td>
                <td nowrap="">
                    <input id="$8a8ad0a03f408879013f4fb12ec520ca$" class="InputStyle2" style="height: 19px; width: 97.28%;" value="[可编辑]付款-贷方应收汇票凭证.贷方行项目文本" name="8a8ad0a03f408879013f4fb1185e20bb">
                </td>
            </tr>
            </tbody>
        </table>
        <table id="oTable8a8ad09446dbc2090146ef63e43c4c6c" class="detailtable" border="1" style="width: 1342px;">
            <caption>
                分摊明细<span id="div8a8ad09446dbc2090146ef63e43c4c6cbutton" name="div8a8ad09446dbc2090146ef63e43c4c6cbutton"><a href="javascript:adddata();"><img title="New" border="0" src="/images/plus.gif" width="11" height="11"/></a>&nbsp;<a href="javascript:deldata();"><img title="Delete" border="0" src="/images/minus.gif" width="11" height="11"/></a>&nbsp;<a href="javascript:addrowbyexcel('8a8ad09446dbc2090146ef63e43c4c6c');"><img title="Excel" border="0" src="/images/excel.gif" width="11" height="11"/></a></span>
            </caption>
            <colgroup>
                <col width="16%">
                <col width="16%">
                <col width="16%">
                <col width="16%">
                <col width="16%">
                <col width="16%">
                <col width="16%">
                <col width="16%">
                <col width="16%">
                <col width="16%">
                <col width="16%">
                <col width="16%">
                <col width="16%">












            </colgroup>
            <tbody>
            <tr class="Header firstRow" style="BACKGROUND: #8edddd" firstrow="firstRow">
                <td nowrap="">
                    <input onclick="selectAll(this,'8a8ad09446dbc2090146ef63e43c4c6c')" id="check_node_all" type="checkbox" value="-1" name="check_node_all" style="">所属部门
                </td>
                <td style="display: none" nowrap="">
                    一级科目
                </td>
                <td nowrap="">
                    预算二级科目
                </td>
                <td nowrap="">
                    项目二级科目
                </td>
                <td nowrap="" style="display: none">
                    可用预算金额
                </td>
                <td nowrap="">
                    分摊管理科目
                </td>
                <td nowrap="">
                    分摊金额
                </td>
                <td nowrap="">
                    分摊客户
                </td>
                <td nowrap="">
                    分摊产品类别
                </td>
                <td nowrap="">
                    核减金额
                </td>
                <td nowrap="">
                    实报金额
                </td>
                <td style="display: none">
                    进项税额
                </td>
                <td style="display: none">
                    进项税额转出
                </td>
                <td style="display: none">
                    &nbsp;
                </td>
                <td style="display: none">
                    &nbsp;
                </td>
            </tr>
            <tr class="DataLight">
                <td nowrap="">
                    <input id="$8a8ad09446dbc2090146ef6856e84c80$" class="InputStyle2" style="width: 80%;" value="[必须输入]员工费用报销-分摊明细.分摊部门" name="8a8ad09446dbc2090146ef63e43c4c6c">
                </td>
                <td style="display: none" nowrap="">
                    <input id="$8a8acee27944a6a4017944cd6d8a1316$" class="InputStyle2" style="width: 80%;" value="[只读]员工费用报销-分摊明细.预算一级科目" name="8a8ad09446dbc2090146ef63e43c4c6c">
                </td>
                <td nowrap="">
                    <input id="$8a8ad09446dbc2090146ef6857174c82$" class="InputStyle2" style="width: 80%;" value="[只读]员工费用报销-分摊明细.科目" name="8a8ad09446dbc2090146ef63e43c4c6c">
                </td>
                <td nowrap="">
                    <input id="$8a8acee27f216d3b017f24ae97b71fec$" class="InputStyle2" style="width: 80%;" value="[可编辑]员工费用报销-分摊明细.项目二级科目" name="8a8ad09446dbc2090146ef63e43c4c6c">
                </td>
                <td nowrap="" style="display: none">
                    <input id="$8a8acee27370f1760173752453d213a1$" class="InputStyle2" style="width: 80%;" value="[只读]员工费用报销-分摊明细.可用预算金额" name="8a8ad09446dbc2090146ef63e43c4c6c">
                </td>
                <td nowrap="">
                    <input id="$8a8acee27693bf64017693dcc4db058b$" class="InputStyle2" style="width: 80%;" value="[必须输入]员工费用报销-分摊明细.所属管理科目" name="8a8ad09446dbc2090146ef63e43c4c6c">
                </td>
                <td nowrap="">
                    <input id="$8a8ad09446dbc2090146ef6857364c84$" class="InputStyle2" style="width: 80%;" value="[可编辑]员工费用报销-分摊明细.报销金额" name="8a8ad09446dbc2090146ef63e43c4c6c">
                </td>
                <td nowrap="">
                    <input id="$8a8acee27693bf64017693dcc51f058d$" class="InputStyle2" style="width: 80%;" value="[可编辑]员工费用报销-分摊明细.分摊客户编码" name="8a8ad09446dbc2090146ef63e43c4c6c">
                </td>
                <td nowrap="">
                    <input id="$8a8acee27693bf64017693dcc6500595$" class="InputStyle2" style="width: 80%;" value="[可编辑]员工费用报销-分摊明细.分摊产品物料编码" name="8a8ad09446dbc2090146ef63e43c4c6c">
                </td>
                <td nowrap="">
                    <input id="$8a8ad09446dbc2090146ef6857654c86$" class="InputStyle2" style="WIDTH: 80%" value="[只读]员工费用报销-分摊明细.扣减金额" name="8a8ad09446dbc2090146ef63e43c4c6c">
                </td>
                <td nowrap="">
                    <input id="$8a8ad09446dbc2090146ef6857844c88$" class="InputStyle2" style="WIDTH: 80%" value="[只读]员工费用报销-分摊明细.实际金额" name="8a8ad09446dbc2090146ef63e43c4c6c">
                </td>
                <td style="display: none">
                    <input id="$8a8acee27693bf64017693dcc68d0597$" class="InputStyle2" style="WIDTH: 80%" value="[可编辑]员工费用报销-分摊明细.进项税额" name="8a8ad09446dbc2090146ef63e43c4c6c">
                </td>
                <td style="display: none">
                    <input id="$8a8acee27693bf64017693dcc70c0599$" class="InputStyle2" style="WIDTH: 80%" value="[可编辑]员工费用报销-分摊明细.进项税额转出" name="8a8ad09446dbc2090146ef63e43c4c6c">
                </td>
                <td style="display: none">
                    &nbsp;<input id="$8a8acee273fbe6de0173fcdfc06a28a6$" class="InputStyle2" value="[隐藏]员工费用报销-分摊明细.分摊申请id" name="8a8ad09446dbc2090146ef63e43c4c6c" style="">
                </td>
                <td style="display: none">
                    &nbsp;<input id="$8a8acee273fbe6de0173fd59dd803e7b$" class="InputStyle2" value="[隐藏]员工费用报销-分摊明细.分摊流程id" name="8a8ad09446dbc2090146ef63e43c4c6c" style="">
                </td>
            </tr>
            <tr>
                <td>
                    &nbsp;
                </td>
                <td>
                    &nbsp;
                </td>
                <td>
                    &nbsp;
                </td>
                <td>
                    &nbsp;
                </td>
                <td style="display: none">
                    &nbsp;<input id="$8a8ad09448f76bc801493720a6292273$" class="InputStyle2" value="[只读]供应商付款审批单.分摊报销合计" name="8a8ad0a03dac251a013daeca49500c3e" style="">
                </td>
                <td>
                    &nbsp;
                </td>
                <td>
                    &nbsp;
                </td>
                <td>
                    &nbsp;<input id="$8a8ad09448f76bc801493720a6772275$" class="InputStyle2" value="[只读]供应商付款审批单.分摊扣减合计" name="8a8ad0a03dac251a013daeca49500c3e" style="">
                </td>
                <td>
                    &nbsp;<input id="$8a8ad09448f76bc801493720a6d52277$" class="InputStyle2" value="[只读]供应商付款审批单.分摊实际合计" name="8a8ad0a03dac251a013daeca49500c3e" style="">
                </td>
                <td style="display: none">
                    <input id="$8a8acee27ac94a50017acbeac415395a$" class="InputStyle2" style="WIDTH: 80%" value="[可编辑]供应商付款审批单.进项税额合计" name="8a8ad0a03dac251a013daeca49500c3e">
                </td>
                <td style="display: none">
                    <input id="$8a8acee27ac94a50017acbeac49c395c$" class="InputStyle2" style="WIDTH: 80%" value="[可编辑]供应商付款审批单.进项税额转出合计" name="8a8ad0a03dac251a013daeca49500c3e">
                </td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            </tbody>
        </table>
        <table id="oTable8a8acee26b98726f016bb1dff0bd15cd" class="detailtable" border="1">
            <caption>
                B/C类请款扣款表单<span id="div8a8acee26b98726f016bb1dff0bd15cdbutton" name="div8a8acee26b98726f016bb1dff0bd15cdbutton"> <input onclick="javascript:getmoney();" type="button" value="获取扣款信息" style="cursor: default;"></span>
            </caption>
            <colgroup>
                <col width="20%">
                <col width="14%">
                <col width="14%">
                <col width="14%">
                <col width="14%">




            </colgroup>
            <tbody>
            <tr class="Header firstRow" style="BACKGROUND: #8edddd" firstrow="firstRow">
                <td nowrap="">
                    <input onclick="selectAll(this,'8a8acee26b98726f016bb1dff0bd15cd')" id="check_node_all" type="checkbox" value="-1" name="check_node_all">关联扣款单
                </td>
                <td nowrap="">
                    扣款金额
                </td>
                <td nowrap="">
                    已扣金额
                </td>
                <td nowrap="">
                    未扣金额
                </td>
                <td nowrap="">
                    本次扣款金额
                </td>
            </tr>
            <tr class="DataLight">
                <td nowrap="">
                    <input id="$8a8acee26b98726f016bb1f65be718d4$" class="InputStyle2" style="width: 80%;" value="[只读]B/C类请款扣款表单.关联扣款单" name="8a8acee26b98726f016bb1dff0bd15cd">
                </td>
                <td nowrap="">
                    <input id="$8a8acee26b98726f016bb1f65c4518d8$" class="InputStyle2" style="width: 80%;" value="[只读]B/C类请款扣款表单.扣款金额" name="8a8acee26b98726f016bb1dff0bd15cd">
                </td>
                <td nowrap="">
                    <input id="$8a8acee26b98726f016bb1f65c7418da$" class="InputStyle2" style="width: 80%;" value="[只读]B/C类请款扣款表单.已扣金额" name="8a8acee26b98726f016bb1dff0bd15cd">
                </td>
                <td nowrap="">
                    <input id="$8a8acee26b98726f016bb1f65ca318dc$" class="InputStyle2" style="width: 80%;" value="[只读]B/C类请款扣款表单.未扣金额" name="8a8acee26b98726f016bb1dff0bd15cd">
                </td>
                <td nowrap="">
                    <input id="$8a8acee26b98726f016bb1f65cd118de$" class="InputStyle2" style="width: 80%;" value="[必须输入]B/C类请款扣款表单.本次扣款金额" name="8a8acee26b98726f016bb1dff0bd15cd">
                </td>
            </tr>
            <tr>
                <td colspan="4">
                    &nbsp;
                </td>
                <td>
                    &nbsp;合计：<input id="$8a8acee26b98726f016bb6fe03f3416b$" class="InputStyle2" value="[只读]供应商付款审批单.B/C类扣款金额" name="8a8ad0a03dac251a013daeca49500c3e" style="">
                </td>
            </tr>
            </tbody>
        </table>
        <table id="oTable8a8acee2709b706201709f58b2fe59a1" class="detailtable" border="1" style="width: 1516px;" width="-42">
            <caption>
                <p>
                    发票清单（C类)<span id="div8a8acee2709b706201709f58b2fe59a1button" name="div8a8acee2709b706201709f58b2fe59a1button">&nbsp;<a id="invoiceTbLineAdd" href="javascript:addplus('8a8acee2709b706201709f58b2fe59a1');"><img title="New" border="0" src="/images/plus.gif" width="11" height="11"/></a>&nbsp;<a href="javascript:delinvoice();"><img title="Delete" border="0" src="/images/minus.gif" width="11" height="11"/></a>&nbsp;<a href="javascript:addrowbyexcel('8a8acee2709b706201709f58b2fe59a1');"><img title="Excel" border="0" src="/images/excel.gif" width="11" height="11"/></a>&nbsp;<input onclick="queryImg();" type="button" value="查看发票" style="cursor: default;">&nbsp; <strong><span style="FONT-SIZE: 12px"><span style="COLOR: #ff0000">普票采集后，点击查看发票按钮，会显示出上传后的发票，以及对应的发票号，点击图片，可放大其发票。</span> </span></strong></span>
                </p><span name="div8a8acee2709b706201709f58b2fe59a1button"><p>
                    <span name="div8a8acee2709b706201709f58b2fe59a1button"><span style="COLOR: #ff0000"><span style="FONT-SIZE: 12px">从</span><input id="setrow1" style="width: 30px; cursor: default;"><span style="FONT-SIZE: 12px">到</span><input id="setrow2" style="width: 30px; cursor: default;"><span style="FONT-SIZE: 12px">行(若全部修改可不填)<strong>统一修改税率</strong></span></span><span style="FONT-SIZE: 12px"> <span style="COLOR: #000000"></span></span><select id="setsl"><option selected="">
                        -统一修改税率-
                    </option>
                    <option>
                        0%
                    </option>
                    <option>
                        1%
                    </option>
                    <option>
                        3%
                    </option>
                    <option>
                        5%
                    </option>
                    <option>
                        6%
                    </option>
                    <option>
                        9%
                    </option>
                    <option>
                        10%
                    </option>
                    <option>
                        11%
                    </option>
                    <option>
                        13%
                    </option>
                    <option>
                        16%
                    </option>
                    <option>
                        17%
                    </option></select><span style="FONT-SIZE: 12px"> </span></span>
                </p>
                <p>
                    <span name="div8a8acee2709b706201709f58b2fe59a1button"><span style="COLOR: #ff0000"><span style="FONT-SIZE: 12px">从</span><input id="setrow3" style="width: 30px; cursor: default;"><span style="FONT-SIZE: 12px">到</span><input id="setrow4" style="width: 30px; cursor: default;"><span style="FONT-SIZE: 12px">行(若全部修改可不填)<strong>统一修改是否代开发票</strong></span></span><span style="FONT-SIZE: 12px"> <span style="COLOR: #000000"></span></span><select id="setsfdkfp"><option selected="">
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
					-统一修改是否代开发票-
                    </option>
                    <option>
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
					是
                    </option>
                    <option>
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
					否
                    </option></select></span>
                </p><span name="div8a8acee2709b706201709f58b2fe59a1button"><p>
                    <span name="div8a8acee2709b706201709f58b2fe59a1button"><span style="FONT-SIZE: 16px; COLOR: #ff0000"><strong><span style="FONT-SIZE: 12px">税率设计场景：1、如果有不同的税率，支持录入对应的序号，自动写入子表税率字段2、如果相同税率选择税率自动写入子表字段3、如果就一条，可以自行人为选择</span></strong> </span></span>&nbsp;
                </p></span><strong>&nbsp;</strong> </span>
            </caption>
            <tbody>
            <tr class="Header firstRow" style="BACKGROUND: #8edddd" firstrow="firstRow">
                <td nowrap="" width="50">
                    <input onclick="selectAll(this,'8a8acee2709b706201709f58b2fe59a1')" id="check_node_all" type="checkbox" value="-1" name="check_node_all">序号
                </td>
                <td width="105" style="word-break: break-all;">
                    OA单号
                </td>
                <td width="105" style="word-break: break-all;">
                    发票代码
                </td>
                <td width="105" style="word-break: break-all;">
                    发票号
                </td>
                <td style="word-break: break-all;" width="105">
                    发票类型
                </td>
                <td style="word-break: break-all;" width="105">
                    发票种类
                </td>
                <td width="105">
                    开票日期
                </td>
                <td width="105">
                    购方名称
                </td>
                <td width="105">
                    购方识别号
                </td>
                <td nowrap="" width="105">
                    不含税金额
                </td>
                <td nowrap="" width="105">
                    税金
                </td>
                <td nowrap="" width="105">
                    价税合计
                </td>
                <td width="105">
                    税率
                </td>
                <td width="105">
                    税率数值
                </td>
                <td nowrap="" style="word-break: break-all;" width="105">
                    销售方名称
                </td>
                <td style="word-break: break-all;" width="105">
                    销售方税号
                </td>
                <td style="word-break: break-all;" width="105">
                    <p>
                        是否代开发票
                    </p>
                    <p>
                        /委托收款
                    </p>
                </td>
                <td width="105">
                    备注栏
                </td>
                <td width="105">
                    唯一标识
                </td>
                <td width="105" style="word-break: break-all;">
                    <p>
                        检验码
                    </p>
                    <p>
                        (校验码的后6位)
                    </p>
                </td>
                <td width="105">
                    图片id
                </td>
                <td width="105" style="word-break: break-all;display: none ">
                    发票类型代码
                </td>
                <td width="105" style="word-break: break-all;display: none  ">
                    发票种类
                </td>
            </tr>
            <tr class="DataLight">
                <td width="50">
                    <input type="text" class="InputStyle2" id="$8a8ace5887f056560187f9e26bd748bc$" name="8a8acee2709b706201709f58b2fe59a1" value="[只读]发票清单（B类非目录）.序号" style="">
                </td>
                <td width="105">
                    <input id="$8a8acee2709b706201709f5f8f305d3c$" class="InputStyle2" style="width: 80%;" value="[只读]发票清单（B类非目录）.OA单号" name="8a8acee2709b706201709f58b2fe59a1">
                </td>
                <td width="105" style="word-break: break-all;">
                    <input type="text" class="InputStyle2" style="width: 80px;" id="$8a8acee2758b7dc301758ce0fce455b8$" name="8a8acee2709b706201709f58b2fe59a1" value="[可编辑]发票清单（B类非目录）.发票代码">
                </td>
                <td style="word-break: break-all;" width="105">
                    <input type="text" class="InputStyle2" style="width: 80px;" id="$8a8acee2709b706201709f5f8ded5d30$" name="8a8acee2709b706201709f58b2fe59a1" value="[必须输入]发票清单（B类非目录）.发票号">
                </td>
                <td style="word-break: break-all;" width="105">
                    <input id="$8a8acee2755a1b2c01755cb3c46d43a3$" class="InputStyle2" style="width: 100px;" value="[必须输入]发票清单（B类非目录）.发票类型" name="8a8acee2709b706201709f58b2fe59a1">
                </td>
                <td width="105">
                    <input id="$8a8ace5887f056560187f96f821f3967$" class="InputStyle2" style="width: 100px;" name="8a8acee2709b706201709f58b2fe59a1" value="[必须输入]发票清单（B类非目录）.发票种类">
                </td>
                <td width="105">
                    <input type="text" class="InputStyle2" style="width: 80px;" id="$8a8acee2709b706201709f5f8ee05d3a$" name="8a8acee2709b706201709f58b2fe59a1" value="[可编辑]发票清单（B类非目录）.开票日期">
                </td>
                <td style="word-break: break-all;" width="105">
                    <input id="$8a8acee2758b7dc301758ce0fd8955c0$" class="InputStyle2" style="width: 150px;" value="[可编辑]发票清单（B类非目录）.购方名称" name="8a8acee2709b706201709f58b2fe59a1">
                </td>
                <td style="word-break: break-all;" width="105">
                    <input id="$8a8acee2758b7dc301758ce0fd6055be$" class="InputStyle2" style="width: 150px;" value="[可编辑]发票清单（B类非目录）.购方识别号" name="8a8acee2709b706201709f58b2fe59a1">
                </td>
                <td nowrap="" width="105">
                    <input id="$8a8acee2709b706201709f5f8f8c5d40$" class="InputStyle2" style="width: 60px;" value="[可编辑]发票清单（B类非目录）.不含税金额" name="8a8acee2709b706201709f58b2fe59a1">
                </td>
                <td nowrap="" width="105">
                    <input id="$8a8acee2709b706201709f5f8fb55d42$" class="InputStyle2" style="width: 60px;" value="[可编辑]发票清单（B类非目录）.税金" name="8a8acee2709b706201709f58b2fe59a1">
                </td>
                <td nowrap="" width="105">
                    <input id="$8a8acee2709b706201709f5f8fdd5d44$" class="InputStyle2" style="width: 60px;" value="[必须输入]发票清单（B类非目录）.价税合计" name="8a8acee2709b706201709f58b2fe59a1">
                </td>
                <td style="word-break: break-all;" width="105">
                    <input id="$8a8acee2709b706201709f5f8e7c5d36$" class="InputStyle2" style="width: 50px;" value="[可编辑]发票清单（B类非目录）.税率" name="8a8acee2709b706201709f58b2fe59a1">
                </td>
                <td style="word-break: break-all;" width="105">
                    <input id="$8a8acee2709b706201709f5f8eb05d38$" class="InputStyle2" style="width: 50px;" value="[只读]发票清单（B类非目录）.税率数值" name="8a8acee2709b706201709f58b2fe59a1">
                </td>
                <td nowrap="" width="105">
                    <input id="$8a8acee2709b706201709f5f8f615d3e$" class="InputStyle2" style="width: 150px;" value="[可编辑]发票清单（B类非目录）.供应商名称" name="8a8acee2709b706201709f58b2fe59a1">
                </td>
                <td style="word-break: break-all;" width="105">
                    <input id="$8a8acee2758b7dc301758ce0fddf55c4$" class="InputStyle2" style="width: 150px;" value="[可编辑]发票清单（B类非目录）.销售方识别号" name="8a8acee2709b706201709f58b2fe59a1">
                </td>
                <td width="105">
                    <input class="InputStyle2" id="$8a8ace5884cc88630184cc8ce962000b$" name="8a8acee2709b706201709f58b2fe59a1" value="[必须输入]发票清单（B类非目录）.是否代开发票/委托收款" style="width: 60%;">
                </td>
                <td width="105">
                    <input id="$8a8ace588562a55101857583c6ca10ca$" class="InputStyle2" style="width: 100px;" value="[可编辑]发票清单（B类非目录）.备注栏" name="8a8acee2709b706201709f58b2fe59a1">
                </td>
                <td style="word-break: break-all;" width="105">
                    <input id="$297ee92c754e268001754ef9166d0177$" class="InputStyle2" value="[隐藏]发票清单（B类非目录）.唯一标识" name="8a8acee2709b706201709f58b2fe59a1" style="">
                </td>
                <td style="word-break: break-all;" width="105">
                    <input id="$8a8acee2758b7dc301758ce0fd3855bc$" class="InputStyle2" value="[可编辑]发票清单（B类非目录）.检验码" name="8a8acee2709b706201709f58b2fe59a1" style="">
                </td>
                <td style="word-break: break-all;" width="105">
                    <input id="$8a8acee2758420d20175886f396d7957$" class="InputStyle2" value="[隐藏]发票清单（B类非目录）.图片id" name="8a8acee2709b706201709f58b2fe59a1" style="">
                </td>
                <td width="105" style="word-break: break-all;display: none">
                    <input type="text" class="InputStyle2" id="$8a8acee2758b7dc301758ce0fd0e55ba$" name="8a8acee2709b706201709f58b2fe59a1" value="[只读]发票清单（B类非目录）.发票类型代码" style="">
                </td>
                <td width="105" style="word-break: break-all;display: none ">
                    <input type="text" class="InputStyle2" id="$8a8acee2758d4d6901758de9433b214a$" name="8a8acee2709b706201709f58b2fe59a1" value="[只读]发票清单（B类非目录）.发票种类" style="">
                </td>
            </tr>
            <tr>
                <td colspan="8" width="105">
                    合计
                </td>
                <td width="105"></td>
                <td width="105">
                    <input id="$8a8acee27aed3c23017af00b5eeb6200$" class="InputStyle2" style="width: 80%;" value="[只读]供应商付款审批单.发票清单不含税金额合计" name="8a8ad0a03dac251a013daeca49500c3e">
                </td>
                <td width="105">
                    <input id="$8a8acee27aed3c23017af00b5f396202$" class="InputStyle2" style="width: 80%;" value="[只读]供应商付款审批单.发票清单税额合计" name="8a8ad0a03dac251a013daeca49500c3e">
                </td>
                <td width="105">
                    <input id="$8a8acee27aed3c23017af00b5f496204$" class="InputStyle2" style="width: 80%;" value="[只读]供应商付款审批单.发票清单价税合计" name="8a8ad0a03dac251a013daeca49500c3e">
                </td>
                <td width="105"></td>
                <td width="105"></td>
                <td width="105"></td>
                <td width="105"></td>
                <td width="105"></td>
                <td width="105"></td>
                <td width="105"></td>
                <td width="105"></td>
                <td width="105"></td>
                <td width="105" style="display: none;"></td>
                <td width="105" style="display: none;"></td>
            </tr>
            </tbody>
        </table>
    </div>
</center>

<script type="text/javascript" src="/js/sfa.js"></script><script type="text/javascript" src="/app/skshu/sale/getbudgetaffiliation.js"></script>
<!--初始化函数-->
<script>var isfirst = false;
var isfirst1 = true;
var win = null;
WeaverUtil.load(function () {
    //js 初始化函数
    jsInit();
    //初始化 监听
    initEventFun();
    //统一修改是否代开发票 20221212
    WeaverUtil.watch(document.getElementById('setsfdkfp'), function () {
        var row111 = $('#setrow3').val();
        var row222 = $('#setrow4').val();
        if (row111 == null || row111 == '') {
            row111 = 0;
        }
        if (row222 == null || row222 == '') {
            row222 = curindex_8a8acee2709b706201709f58b2fe59a1;
        }
        var sfdk = $('#setsfdkfp').val();
        if (sfdk == '是') {
            setdkfp(1, row111, row222);
        }
        if (sfdk == '否') {
            setdkfp(2, row111, row222);
        }
    });
    //设置前期是否已经全额提供发票 默认为 否
    var  requestid = document.getElementById('requestid').value;
    if( requestid == '' || requestid == undefined || requestid == null){
        $('#field_8a8ace0f773dad73017742b1a564079e').val('8a8acee277244dc3017737d7810b3d40');
    }

    setTimeout(fpjezd, 500)
    WeaverUtil.watch(document.getElementById('setsl'), function () {
        var row1 = $('#setrow1').val();
        var row2 = $('#setrow2').val();
        if (row1 == null || row1 == '') {
            row1 = 0;
        }
        if (row2 == null || row2 == '') {
            row2 = curindex_8a8acee2709b706201709f58b2fe59a1;
        }
        var sl = $('#setsl').val();
        if (sl == '17%') {
            setShuilv(1, row1, row2);
        }
        if (sl == '13%') {
            setShuilv(2, row1, row2);
        }
        if (sl == '10%') {
            setShuilv(3, row1, row2);
        }
        if (sl == '6%') {
            setShuilv(4, row1, row2);
        }
        if (sl == '3%') {
            setShuilv(5, row1, row2);
        }
        if (sl == '1%') {
            setShuilv(6, row1, row2);
        }
        if (sl == '0%') {
            setShuilv(7, row1, row2);
        }
        if (sl == '11%') {
            setShuilv(8, row1, row2);
        }
        if (sl == '5%') {
            setShuilv(9, row1, row2);
        }
        if (sl == '16%') {
            setShuilv(10, row1, row2);
        }
        if (sl == '9%') {
            setShuilv(11, row1, row2);
        }
    });
    if (document.getElementById('field_8a8ad0944a3c9caa014a4b80ccfb1ca8').value == '8a8ad0a03a4533e4013a45376ee50005') {
        $('#ppcj').show();
        $('#zphq').show();
        setNeedCheck('8a8acee26df673b7016df6a79f2304e6', false); //预计开具时间
        setNeedCheck('8a8ad0a03dac251a013daeca4b730c4f', true); //发票金额
        setNeedCheck('8a8ad0a03dac251a013daeca4d090c77', false);//发票号码
    }
    if (document.getElementById('field_8a8ad0944a3c9caa014a4b80ccfb1ca8').value == '8a8ad0a03a4533e4013a45376ee50006') {
        $('#ppcj').hide();
        $('#zphq').hide();
        setNeedCheck('8a8ad0a03dac251a013daeca4b730c4f', false);//发票金额
        setNeedCheck('8a8ad0a03dac251a013daeca4d090c77', false);//发票号码
        setNeedCheck('8a8ad0a03dac251a013daeca4d190c79file', false);//发票附件
    }

    WeaverUtil.watch(document.getElementById('field_8a8ad0944a3c9caa014a4b80ccfb1ca8'), function () {
        if (document.getElementById('field_8a8ad0944a3c9caa014a4b80ccfb1ca8').value == '8a8ad0a03a4533e4013a45376ee50005') {
            $('#ppcj').show();
            $('#zphq').show();
        }
        if (document.getElementById('field_8a8ad0944a3c9caa014a4b80ccfb1ca8').value == '8a8ad0a03a4533e4013a45376ee50006') {
            $('#ppcj').hide();
            $('#zphq').hide();
        }
    });
    // 是否有合同监听事件
    WeaverUtil.addEvent(document.getElementById('field_8a8ad09444905a35014494c320380502'), 'change', function () {
        var iskk = document.getElementById('field_8a8ad09444905a35014494c320380502').value;
        // 是的时候本次付款完合同是否结束必填
        if (iskk == '8a8ad0a03a4533e4013a45376ee50005') {
            setNeedCheck('8a8acee27825f9910178346f02e077e3', true);
        } else {
            setNeedCheck('8a8acee27825f9910178346f02e077e3', false);
        }
    });
    //20151126caixw-付款条件取数
    WeaverUtil.watch(document.getElementById('field_8a8ad0204c20e0d3014c2c24cd7c6564'), function () {
        paycomdition()
    });
    WeaverUtil.watch(document.getElementById('field_8a8ad0a03dac251a013daeca4b340c49'), function () {
        paycomdition()
    });

    WeaverUtil.watch(document.getElementById('field_8a8ad0a03dac251a013daeca4b340c49'), function () {
        if (!isfirst) {
            isfirst = true;
            return;
        }
        var gys = document.getElementById('field_8a8ad0a03dac251a013daeca4b340c49').value;
        var payterm = SQL('select payterms from uf_supplier where flowno=\'' + gys + '\'');
        if (payterm == '0002' || payterm == 'X003') {
            setNeedCheck('8a8ad0944c305396014c4a9dc3400174', true);
        } else {
            setNeedCheck('8a8ad0944c305396014c4a9dc3400174', false);
        }
        var docbankno = document.getElementById('field_8a8ad0a03dac251a013daeca4bc10c55').value;
        if (gys) {
            var sql = 'select owner,bankno,taxrate from uf_supplier where flowno=\'' + gys + '\'';
            DataService.getValues(sql, {
                callback: function (data) {
                    if (data && data.length >0) {
                        document.getElementById('field_8a8ad0944029a75a01403304939e3744').value = (data[0].owner == null ? '' : data[0].owner);
                        document.getElementById('field_8a8ad0944029a75a01403304939e3744' + 'span').innerHTML = (data[0].owner == null ? '' : data[0].owner);
                        document.getElementById('field_8a8ad0a03dac251a013daeca4bc10c55').value = (data[0].bankno == null ? '' : data[0].bankno);
                        document.getElementById('field_8a8ad0a03dac251a013daeca4bc10c55' + 'span').innerHTML = (data[0].bankno == null ? '' : data[0].bankno);
                        document.getElementById('field_8a8ad0944038bd1901403986d2f10e28').value = (data[0].taxrate == null ? '' : data[0].taxrate);
                    }
                }
            });
        }
    });

    var requestid = document.getElementById('requestid').value;
    var task1 = document.getElementById('field_8a8ad09444905a35014494c320770504');  //C类费用申请单
    WeaverUtil.watch(task1, function () {
        var sqlappmoney = 'select nvl(applymoney,0) from uf_whtapplyform where requestid=\'' + task1.value + '\'';
        var sqlpaymoeny = 'select nvl(sum(b.payamount),0) from uf_supplier_pay b where b.relatedwht=\'' + task1.value + '\' ';
        if (requestid != '') {
            sqlpaymoeny = sqlpaymoeny + ' and requestid<>\'' + requestid + '\'';
        }
        var appmoney = 0;
        var paymoeny = 0;
        var notpaymoney = 0;
        appmoney = SQL(sqlappmoney);
        paymoeny = SQL(sqlpaymoeny);
        notpaymoney = Math.round((parseFloat(appmoney) - parseFloat(paymoeny)) * 100) / 100;
        document.getElementById('field_8a8ad09444905a35014494ce49660518').value = appmoney;                                  //申请单总额
        document.getElementById('field_8a8ad09444905a35014494ce49660518span').innerHTML = appmoney;                //申请单总额
        document.getElementById('field_8a8ad09444905a35014494ce4985051a').value = paymoeny;                                    //已付
        document.getElementById('field_8a8ad09444905a35014494ce4985051aspan').innerHTML = paymoeny;                 //已付
        document.getElementById('field_8a8ad09444905a35014494ce4995051c').value = '';                             //未付
        document.getElementById('field_8a8ad09444905a35014494ce4995051c').value = notpaymoney;                             //未付
        document.getElementById('field_8a8ad09444905a35014494ce4995051cspan').innerHTML = notpaymoney;            //未付
        if (requestid == '') {
            //adddata();
        }
        addShareData();
    });

    var htbtn = document.getElementsByName('button_8a8ad0a03dac251a013daeca4bff0c5d')[0];//合同browser按钮
    var whtbtn = document.getElementsByName('button_8a8ad09444905a35014494c320770504')[0];//无合同browser按钮
    htbtn.onclick = function () {
        getHT();
    }
    whtbtn.onclick = function () {
        getWHT();
    }
    // 是否有合同判断
    var isconctact = document.getElementById('field_8a8ad09444905a35014494c320380502').value
    if (isconctact == '8a8ad0a03a4533e4013a45376ee50005') {                   //有合同
        setNeedCheck('8a8ad0de683181f2016831cd15ec1f00', true);  // 合同执行方式
        setNeedCheck('8a8ad0a03dac251a013daeca4bff0c5d', true);  //  合同
        setNeedCheck('8a8ad0944d65f4e2014d8ee79bcc66f4', false);  // 合同费用科目
        setNeedCheck('8a8ad09444905a35014494c320770504', false);  // C类
        setNeedCheck('8a8acee27825f9910178346f02e077e3', true);  // 本次付款完合同是否结束
        displayCon();
    } else if (isconctact == '8a8ad0a03a4533e4013a45376ee50006') {          //无合同
        setNeedCheck('8a8ad0de683181f2016831cd15ec1f00', false);  // 合同执行方式
        setNeedCheck('8a8ad0a03dac251a013daeca4bff0c5d', false);
        //modify by wujh 20210414合并申请与付款
        setNeedCheck('8a8ad0944d65f4e2014d8ee79bcc66f4', false);  // 合同费用科目
        setNeedCheck('8a8acee27825f9910178346f02e077e3', false);  // 本次付款完合同是否结束
        displayCpay();
    } else {
        setNeedCheck('8a8ad0de683181f2016831cd15ec1f00', false);  // 合同执行方式
        setNeedCheck('8a8ad0a03dac251a013daeca4bff0c5d', false);
        setNeedCheck('8a8ad09444905a35014494c320770504', false);
        setNeedCheck('8a8acee27825f9910178346f02e077e3', false);  // 本次付款完合同是否结束
        displayDefault();
    }
    initDefaultShare();

    var iscontract = document.getElementById('field_8a8ad09444905a35014494c320380502').value;
    if (iscontract == '8a8ad0a03a4533e4013a45376ee50005') {
        displayCon();
    }
    if (iscontract == '8a8ad0a03a4533e4013a45376ee50006') {
        displayCpay();
    }
    if (iscontract == '') {
        displayDefault();
    }
    var iskk = document.getElementById('field_8a8ad09444905a35014494c320380502').value;  //是否有合同
    var orgid2 = document.getElementById('field_8a8ad09444905a35014494d4294e0520').value;  //申请部门
    var a = document.getElementById('field_8a8ad09444905a35014494c320380502');
    WeaverUtil.addEvent(document.getElementById('field_8a8ad09444905a35014494c320380502'), 'change', function () {
        var gsyno = document.getElementsByName('field_8a8ad0a03dac251a013daeca4b340c49')[0];//供应商编号
        if (gsyno.value == '') {
            alert('请先选择供应商编号');
            document.getElementById('field_8a8ad09444905a35014494c320380502').value = '';
            return;
        }
        if (a.value == '8a8ad0a03a4533e4013a45376ee50005') {                   //有合同
            setNeedCheck('8a8ad0a03dac251a013daeca4bff0c5d', true);  //  合同
            setNeedCheck('8a8ad0944d65f4e2014d8ee79bcc66f4', false);  // 合同费用科目
            setNeedCheck('8a8ad09444905a35014494c320770504', false);  // C类
            setNeedCheck('8a8ad0de683181f2016831cd15ec1f00', true);  // 合同执行方式
            displayCon();
        } else if (a.value == '8a8ad0a03a4533e4013a45376ee50006') {          //无合同
            //add by linweiping 2021/12/30 添加C类供应商费用申请单必填项1  begin
            DWREngine.setAsync(false);//设置为同步获取数据
            // 大禹子公司下的所有部门id
            var sql = 'select l.oid from orgunitlink l,ORGUNIT o where l.oid=o.id and l.oid =\'' + orgid2 + '\' start with oid = \'8a8acee2729ccd0201729d1541f804c1\' connect by prior oid = pid';
            DataService.getValues(sql, {
                callback: function (data) {
                    if (data && data.length > 0) {
                        setNeedCheck('8a8ad09444905a35014494c320770504', true);
                    }
                }
            });
            DWREngine.setAsync(true);
            // add by linweiping 2021/12/30 添加C类供应商费用申请单必填项1 end
            setNeedCheck('8a8ad0a03dac251a013daeca4bff0c5d', false);
            //modify by wujh 20210414合并申请与付款
            setNeedCheck('8a8ad0944d65f4e2014d8ee79bcc66f4', false);  // 合同费用科目
            setNeedCheck('8a8ad0de683181f2016831cd15ec1f00', false);  // 合同执行方式
            displayCpay();
        } else {
            setNeedCheck('8a8ad0de683181f2016831cd15ec1f00', false);  // 合同执行方式
            setNeedCheck('8a8ad0a03dac251a013daeca4bff0c5d', false);
            setNeedCheck('8a8ad09444905a35014494c320770504', false);
            displayDefault();
        }
    });
    var b = document.getElementById('field_8a8acee272e132520172e195454301a2');
    WeaverUtil.addEvent(b, 'change', function () {
        if (b.value == '8a8ad0f8642a93d001642b47caf93ac0') {
            setNeedCheck('8a8acee272e132520172e1922b8a01a0', true); //   关联方案报批或立项申请流程
        } else {
            setNeedCheck('8a8acee272e132520172e1922b8a01a0', false); //关联方案报批或立项申请流程
        }
    });
    DWREngine.setAsync(false);
    var c = document.getElementById('field_8a8ad0944a3c9caa014a4b80ccfb1ca8');
    WeaverUtil.addEvent(c, 'change', function () {
        var gys2 = document.getElementById('field_8a8ad0a03dac251a013daeca4b340c49').value;
        var payterm2 = SQL('select payterms from uf_supplier where requestid=\'' + gys2 + '\'');
        if (c.value == '8a8ad0a03a4533e4013a45376ee50005') {
            setNeedCheck('8a8acee26df673b7016df6a79f2304e6', false); //预计开具时间
            setNeedCheck('8a8ad0a03dac251a013daeca4b730c4f', true); //发票份数
            setNeedCheck('8a8ad0a03dac251a013daeca4d090c77', false);//发票号码
            alert('温馨提示：有发票，请记得获取专票或者通过普票采集获取发票！出纳根据发票及完整资料给予付款！');
        } else {
            //setNeedCheck('8a8acee26df673b7016df6a79f2304e6', true); //预计开具时间
            setNeedCheck('8a8ad0a03dac251a013daeca4b730c4f', false); //发票份数
            setNeedCheck('8a8ad0a03dac251a013daeca4d090c77', false);//发票号码
            setNeedCheck('8a8ad0a03dac251a013daeca4d190c79file', false);//发票附件
            alert('温馨提示：收到发票请及时发起发票报送流程！');
            if (payterm2 == 'X001') {
                alert('预付款发票开具后，请走C类供应商发票报送流程后，发票交接给11楼总账范卡杰。');
            }
            var box = $('input[name=check_node_8a8acee2709b706201709f58b2fe59a1]');
            for (var i = 0; i < box.length; i++) {
                box.get(i).checked = true;
            }
            delrow('8a8acee2709b706201709f58b2fe59a1');
        }
    });
    var sfyfp = document.getElementById('field_8a8ad0944a3c9caa014a4b80ccfb1ca8').value;
    if (sfyfp != '8a8ad0a03a4533e4013a45376ee50005') {
        // setNeedCheck('8a8acee26df673b7016df6a79f2304e6', true); //预计开具时间
    }
    DWREngine.setAsync(true);

    //1.初始化时给一级科目添加监听，科目变化时，检查分摊表的客户和分摊类别是否变必填项，清空三级预算科目和二级预算科目
    WeaverUtil.watch(document.getElementById('field_8a8ad09448ba3de20148c3efb8c825a9'), function () {
        var c = document.getElementById('field_8a8ad09448ba3de20148c3efb8c825a9').value;
        var isnone = true;
        $('#oTable8a8ad09446dbc2090146ef63e43c4c6c').find('.DataLight').each(function (i) {
            isnone = false;
            var idx = document.getElementsByName('check_node_8a8ad09446dbc2090146ef63e43c4c6c')[i].value;
            checkOrginit(idx);
            document.getElementById('field_8a8acee27693bf64017693dcc4db058b_' + idx).value = '';//三级预算科目
            document.getElementById('field_8a8acee27693bf64017693dcc4db058b_' + idx + 'span').innerHTML = '<IMG src=http://10.10.78.98:8001/images/base/checkinput.gif align=absMiddle>';//三级预算科目
            document.getElementById('field_8a8ad09446dbc2090146ef6857174c82_' + idx).value = '';//二级预算科目
            document.getElementById('field_8a8ad09446dbc2090146ef6857174c82_' + idx + 'span').innerHTML = '';//二级预算科目
        });
        if (isnone) {
            adddata();
        }
    });
    //2.初始化页面时，加监听，本次申请付款金额 变化时，更新分摊明细表的分摊金额
    WeaverUtil.watch(document.getElementById('field_8a8ad0a03dac251a013daeca4d380c7d'), function () {
        $('#oTable8a8ad09446dbc2090146ef63e43c4c6c').find('.DataLight').each(function (i) {
            var idx = document.getElementsByName('check_node_8a8ad09446dbc2090146ef63e43c4c6c')[i].value;
            var checknodestemp = document.getElementsByName('check_node_8a8ad09446dbc2090146ef63e43c4c6c');
            var tempidx = checknodestemp[0].value;
            if (idx == tempidx) {
                document.getElementById('field_8a8ad09446dbc2090146ef6857364c84_' + idx).value = document.getElementById('field_8a8ad0a03dac251a013daeca4d380c7d').value;         //子表报销金额
            }
            if (idx > tempidx) {
                calFtInit();
            } else {
                document.getElementById('field_8a8ad09448f76bc801493720a6292273').value = document.getElementById('field_8a8ad09446dbc2090146ef6857364c84_' + tempidx).value;
                document.getElementById('field_8a8ad09448f76bc801493720a6292273span').innerHTML = document.getElementById('field_8a8ad09446dbc2090146ef6857364c84_' + tempidx).value;
                shareAmountTotal = document.getElementById('field_8a8ad09446dbc2090146ef6857364c84_' + tempidx).value;
            }
        });
    });

    var bxjeSub = $('input[name^=field_8a8ad09446dbc2090146ef6857364c84_]');    //子表报销金额
    var box = $('input[name=check_node_8a8ad09446dbc2090146ef63e43c4c6c]');
    if (requestid == '') {
        for (var i = 0; i < bxjeSub.length; i++) {
            if (bxjeSub.get(i).value == '') {
                box.get(i).checked = true;
            }
        }
    }
    delrow('8a8ad09446dbc2090146ef63e43c4c6c');
    //初始化数据
    initData();
    var kemu = $('input[name=field_8a8ad0944d65f4e2014d8ee79bcc66f4]');  //合同费用科目
    WeaverUtil.watch(kemu.get(0), function () {
        var kemun = document.getElementById('field_8a8ad0944d65f4e2014d8ee79bcc66f4').value;   //合同费用科目获取改变后的值
        var lastmemu = SQL(' select lastmemu from uf_budgetmemu where requestid=\'' + kemun + '\' ');
        document.getElementById('field_8a8ad09448ba3de20148c3efb8c825a9').value = lastmemu; //设置上级科目
        document.getElementById('field_8a8ad09448ba3de20148c3efb8c825a9span').innerHTML = SQL(' select memuname from uf_budgetmemu where requestid=\'' + lastmemu + '\' ');  //设置上级科目
        getYusuan();
    });
    //合同类型为直投广告，且广告性质为区域广告的时候必须关联广告投放申请
    var contact = document.getElementById('field_8a8ad0a03dac251a013daeca4bff0c5d');//合同
    WeaverUtil.watch(contact, function () {
        var sql = 'select posternature  from uf_stock_contract   where requestid=\'' + contact.value + '\' and ctrtype=\'8a8ad0a03ab9ea38013abb543121107d\' ';
        //alert(sql);
        var posternature = SQL(sql);
        if (posternature == '区域广告') {
            //setNeedCheck('8a8ad02057e02a060157e4b29896360f', true);
        } else {
            setNeedCheck('8a8ad02057e02a060157e4b29896360f', false);
        }
    });

    var fieldvalue = findSFAFieldForCreate();
    var fieldvalues = fieldvalue.split('---');
    objids = fieldvalues[0].split(',');
    objidnames = fieldvalues[1].split(',');
    showimgaeForCreate(objids);

    //add by wujh 20210121 是否有发票控制 begin
    //是否有发票
    sfyfpCg();
    //add by wujh 20210707 分摊表自动带出控制
    var kemu = document.getElementById('field_8a8ad09448ba3de20148c3efb8c825a9').value;//8a8ad0944d65f4e2014d8ee799e866f0');
    WeaverUtil.watch(kemu, function () {
        kmcg();
    });
    //20210225控制是否为国外发票--xiaohua    check by zjh 20230506   否为国外发票 ==>是否历史单据
    //设置 是否代开发票/委托收款 初始值为 否
    $("#field_8a8ace5884cc88630184cc8ce962000b_0").val('8a8ad0a03a4533e4013a45376ee50006');
    //移除子表的数据 同时隐藏添加行的按钮
    invoiceLineRemoveAndHideBtn();
    //发票类型初始化
    invoiceTypeInit();
    //设置历史单据是否必填
    setHistoryNoMneed();
    WeaverUtil.watch(document.getElementById('field_8a8ace0f773dad73017742b1a564079e'), function () {
        //设置历史单据是否必填
        setHistoryNoMneed();
    });

    //银行信息默认只读 added by wld on 2021/11/2 增设特殊付款选项，银行卡号可自行修改
    $('#field_8a8ad09451465b1901514ccf2f832778').attr('readonly', true);
    $('#field_8a8ad0a03dac251a013daeca4bc10c55').attr('readonly', true);
    WeaverUtil.addEvent($('#field_8a8acee27ca74b46017ca76b11790a82')[0], 'change', function () {
        var isspecialpay = $('#field_8a8acee27ca74b46017ca76b11790a82 option:selected').val();
        if (isspecialpay == '8a8acee26d7bc114016d7fac00cd083a') {
            $('#field_8a8ad09451465b1901514ccf2f832778').attr('readonly', false);
            $('#field_8a8ad0a03dac251a013daeca4bc10c55').attr('readonly', false);
        } else {
            $('#field_8a8ad09451465b1901514ccf2f832778').attr('readonly', true);
            $('#field_8a8ad0a03dac251a013daeca4bc10c55').attr('readonly', true);
        }


    });

    //支付币种,供应商类型字段默认带出值
    var zfbz = document.getElementById('field_8a8ad0f85ef5a579015ef9fc85370dda').value;//支付币种
    var gyslx = document.getElementById('field_8a8ad0f85ef5a579015ef9fc85a50ddc').value;//供应商类型
    if (zfbz == null || zfbz == '') {
        //支付币种,设置默认（人民币）
        document.getElementById('field_8a8ad0f85ef5a579015ef9fc85370dda').value = '5c78e08423194a4801232c5ff985025d';
    }
    if (gyslx = null || gyslx == '') {
        //供应商类型,设置默认（境内）
        document.getElementById('field_8a8ad0f85ef5a579015ef9fc85a50ddc').value = '8a8ad0de5ecd27ee015ef9f6bb317a77';
    }
    $('#oTable8a8ad09446dbc2090146ef63e43c4c6c').find('.DataLight').each(function (i) {
        var idx = document.getElementsByName('check_node_8a8ad09446dbc2090146ef63e43c4c6c')[i].value;
        budgetOrgOnclick(idx);
    });
    //add by 202211 是否属于安全生产费
    attchCheck3();
    var sfaqscf = document.getElementById('field_8a8ace5884662758018473f94aea240c');// 是否属于安全生产费
    WeaverUtil.addEvent(sfaqscf, 'change', function () {
        attchCheck3();
    });
    //费用科目 进行监听  如果选择是检测费时，进行弹窗提示
    WeaverUtil.watch(document.getElementById('field_8a8ad09448ba3de20148c3efb8c825a9'), function () {
        var kemu = document.getElementById('field_8a8ad09448ba3de20148c3efb8c825a9').value;
        if (kemu == '8a8acee278f8c3a80178f8d472341020') { //检测费
            alert('报销检测费时， 需同步提供盖章版合同/协议/缴费通知单/报价单，请在附件上传!');
        }
    });
    WeaverUtil.watch(document.getElementById('field_8a8ace58851a7266018528a463cd1cdf'), function () {
        invoicecl();
    });
    /***add by  czt 20230111  当选择开口合同:合同付款情况字段为:已申请金额:B元;已付C元;
     当选择闭口合同:合同付款情况字段为:合同总额A元:已申请金额:B元;已付C元;未付D元;  ***/
    WeaverUtil.watch(document.getElementById('field_8a8ad0de683181f2016831cd15ec1f00'), function () {
        //合同类型
        var obj = document.getElementById('field_8a8ad0de683181f2016831cd15ec1f00').value;
        //当合同类型为开口合同时，合同付款情况字段为:已申请金额:B元;已付C元;
        if (obj == '8a8ad0de683181f2016831da15e72843') {
            document.getElementById('ze').style.display = 'none';  //总额
            document.getElementById('zey').style.display = 'none';
            document.getElementById('field_8a8ad0a03dac251a013daeca4c2e0c61span').style.display = 'none';
            document.getElementById('wf').style.display = 'none';  //未付
            document.getElementById('wfy').style.display = 'none';
            document.getElementById('field_8a8ad0944029a75a01402d40b3f22d8dspan').style.display = 'none';
        } else {
            //当合同类型为闭口，合同付款情况字段为:合同总额A元:已申请金额:B元;已付C元;未付D元;
            document.getElementById('ze').style.display = 'inline-block';  //总额
            document.getElementById('zey').style.display = 'inline-block';
            document.getElementById('field_8a8ad0a03dac251a013daeca4c2e0c61span').style.display = '';
            document.getElementById('yljsq').style.display = 'inline-block';  //已累计申请
            document.getElementById('yljsqy').style.display = 'inline-block';
            document.getElementById('field_8a8ad0a03e12dcfc013e15ae25350190span').style.display = '';
            document.getElementById('yf').style.display = 'inline-block';  //已付
            document.getElementById('yfy').style.display = 'inline-block';
            document.getElementById('field_8a8ad09441c756ee0141d9f5cd301abfspan').style.display = '';
            document.getElementById('wf').style.display = 'inline-block';  //未付
            document.getElementById('wfy').style.display = 'inline-block';
            document.getElementById('field_8a8ad0944029a75a01402d40b3f22d8dspan').style.display = '';
        }
    });
});</script>
<!--业务处理-->
<script>//js 初始化函数 add by zjh 20230515
function jsInit() {
    //设置 融资方式 初始值 为网银支付
    $('#field_8a8acee276a8fdc00176a94389cc0865').val('8a8acee2742647600174289a64054c41');
    //设置 汇票使用比例 默认值为0
    $('#field_8a8acee27baac3a3017bab1a8c89123d').val('0');
}

//初始化 监听
function initEventFun() {
    //发票清单价税合计
    WeaverUtil.watch(document.getElementById('field_8a8acee27aed3c23017af00b5f496204'), function () {
        var priceTax = $(this).val();
        $('#field_8a8ad0a03dac251a013daeca4b730c4f').val(priceTax);
    });
    //本次申请付款金额
    WeaverUtil.watch(document.getElementById('field_8a8ad0a03dac251a013daeca4d380c7d'), function () {
        //获取 前期是否已经全额提供发票 的值
        var qysfyjqetgfp = $("#field_8a8ace0f773dad73017742b1a564079e").val();
        if(qysfyjqetgfp == '8a8acee277244dc3017737d7810b3d3f'){//是
            //获取本次申请付款金额的值
            var currentPrice = $("#field_8a8ad0a03dac251a013daeca4d380c7d").val();
            //设置发票金额
            $("#field_8a8ad0a03dac251a013daeca4b730c4f").val(currentPrice);
        }
    });
}

/**
 * 修改发票类型描述
 * index 下标
 * lxdm 类型代码
 */
function setFplxms(index, lxdm) {
    var ms = fplxms(lxdm);
    $('#field_8a8acee27af17d07017af2f38cd947d3_' + index).val(ms);
    $('#field_8a8acee27af17d07017af2f38cd947d3_' + index + 'span').html(ms);
}

/**
 * 发票类型描述
 */
function fplxms(lxdm) {
    debugger;
    switch (lxdm) {
        case '09':
            return '全电专票';
            break;
        case '90':
            return '全电普票';
            break;
        case '004':
            return '专票';
            break;
        case '007':
            return '普票';
            break;
        case '025':
            return '卷票';
            break;
        case '026':
            return '电票';
            break;
        case '027':
            return '通行费发票';
            break;
        case '028':
            return '电子专票';
            break;
        case '081':
            return '出租车票';
            break;
        case '082':
            return '火车票';
            break;
        case '083':
            return '定额票';
            break;
        case '084':
            return '飞机行程单票';
            break;
        case '085':
            return '通用机打发票';
            break;
        case '086':
            return '客运汽车发票';
            break;
        case '087':
            return '机动车发票';
            break;
        case '088':
            return '其他发票';
            break;
        default:
            break;
    }
}

function setShuilv(item, row1, row2) {
    for (var i = row1; i <= row2; i++) {
        $('#field_8a8acee2709b706201709f5f8e7c5d36_' + i).find('option:eq(' + item + ')').attr('selected', true);
    }
}

function setdkfp(item, row111, row222) {
    for (var i = row111; i <= row222; i++) {
        $('#field_8a8ace5884cc88630184cc8ce962000b_' + i).find('option:eq(' + item + ')').attr('selected', true);
    }
}

//发票标识不可为空
function fpbsnotnull() {
    var formid = '8a8acee2709b706201709f58b2fe59a1';
    var checknode = 'check_node_' + formid;
    //循环
    var checkboxes = document.getElementsByName(checknode);
    for (var i = 0; i < checkboxes.length; i++) {
        var index = checkboxes[i].value;
        //发票类型
        var invoiceType=$("#field_8a8acee2755a1b2c01755cb3c46d43a3_"+index).val();
        //列表行
        var line = $("#field_8a8ace5887f056560187f9e26bd748bc_"+index).val();
        //发票类型  不等于  “事业/财政类等其他发票” 或 “国外发票”
        if(invoiceType != '8a8acee271580b0501715e16d15b20e2' && invoiceType != '8a8ace5887eaf4f90187eea888ae3d54'){
            //发票标识
            var fpbs = $('#field_297ee92c754e268001754ef9166d0177_' + index).val();
            //发票号
            var fphm = $('#field_8a8acee2709b706201709f5f8ded5d30_' + index).val();
            if (fphm != null && fphm != '') {
                if (fpbs == '' || fpbs == null) {
                    SKSHU.CommonUtils.HLDialog.hlAlert('第 '+line+' 行，发票标识为空，请删除明细表中发票，重新获取发票');
                    return false;
                }
            }
        }
    }
    return true;
}

//查验
function chayan() {
    var bool;
    var index = curindex_8a8acee2709b706201709f58b2fe59a1;
    for (var i = 0; i <= index; i++) {
        var fplxdm = $('#field_8a8acee2758b7dc301758ce0fd0e55ba_' + i).val(); //发票类型代码  7
        var fphm = $('#field_8a8acee2709b706201709f5f8ded5d30_' + i).val(); //发票号    1
        var fpdm = $('#field_8a8acee2758b7dc301758ce0fce455b8_' + i).val(); //发票代码    2
        var kprq = $('#field_8a8acee2709b706201709f5f8ee05d3a_' + i).val(); //开票日期  13
        var hjje = $('#field_8a8acee2709b706201709f5f8f8c5d40_' + i).val(); //不含税金额    3
        var jshj = $('#field_8a8acee2709b706201709f5f8fdd5d44_' + i).val(); //价税合计         4
        var perid = $('#field_297ee92c754e268001754ef9166d0177_' + i).val(); //发票标识      5
        var jym = $('#field_8a8acee2758b7dc301758ce0fd3855bc_' + i).val(); //检验码          6
        var ghmc = $('#field_8a8acee2758b7dc301758ce0fd8955c0_' + i).val(); //购方名称      8
        var ghsbh = $('#field_8a8acee2758b7dc301758ce0fd6055be_' + i).val(); //购方识别号 9
        var xhmc = $('#field_8a8acee2709b706201709f5f8f615d3e_' + i).val(); //销售方名称 10
        var xhsbh = $('#field_8a8acee2758b7dc301758ce0fddf55c4_' + i).val(); //销售方识别号 11
        var fpdl = $('#field_8a8acee2758d4d6901758de9433b214a_' + i).val(); //发票种类    12
        var se = $('#field_8a8acee2709b706201709f5f8fb55d42_' + i).val()//税额
        var imgid = $('#field_8a8acee2758420d20175886f396d7957_' + i).val();//图片id
        var gyssbh = document.getElementById('field_8a8ad0a03dac251a013daeca4b340c49span').innerText;
        gyssbh = gyssbh.replace(/\s+/g, '');
        if (fplxdm != '004' && fplxdm != '' && fphm != '' && fphm != null && imgid != null && imgid != '') {  //fplxdm != '004' 去掉专票控制查验
            $.ajax({
                type: 'post',
                url: '/ServiceAction/com.eweaver.app.skshu.province.action.InvoiceCommitGys',
                dataType: 'json',
                async: false,
                data: {
                    'fphm': fphm,
                    'fpdm': fpdm,
                    'kprq': kprq,
                    'hjje': hjje,
                    'jshj': jshj,
                    'perid': perid,
                    'jym': jym,
                    'fplxdm': fplxdm,
                    'ghmc': ghmc,
                    'ghsbh': ghsbh,
                    'xhmc': xhmc,
                    'xhsbh': xhsbh,
                    'fpdl': fpdl,
                    'gyssbh': gyssbh,
                    'se': se,
                    'syje': jshj
                },
                success: function (data) {
                    if (data.code != '200') {
                        var msg = data.msg;
                        try {
                            msg = msg.split('#')[1];
                            if (msg != '' && msg != null) {
                                alert('发票号：' + fphm + '，存在错误：' + msg);
                            } else {
                                alert('发票号：' + fphm + '，存在异常!');
                            }
                        } catch (e) {
                            alert('发票号：' + fphm + '，存在异常!');
                        }
                        bool = false;
                    }
                }
            });
        }
    }
    return bool;
}

function delplus() {
    delrow('8a8acee2709b706201709f58b2fe59a1');
    getindex();
}

//修改发票金额和份数，上同
function getindex() {
    var index = curindex_8a8acee2709b706201709f58b2fe59a1;
    var j = 0;
    var sum = 0;
    for (var i = 0; i <= index; i++) {
        var fphm = $('#field_8a8acee2709b706201709f5f8ded5d30_' + i).val(); //发票号
        var jshj = $('#field_8a8acee2709b706201709f5f8fdd5d44_' + i).val(); //价税合计
        if (fphm != '' && fphm != null) {
            j++;
            sum = parseFloat(sum * 1000 + jshj * 1000) / 1000;
        }
    }
    $('#field_8a8ad09444905a35014494ce49d3051e').val(j);
    $('#field_8a8ad09444905a35014494ce49d3051espan').html(j);
    $('#field_8a8ad0a03dac251a013daeca4b730c4f').val(sum);
    $('#field_8a8ad0a03dac251a013daeca4b730c4fspan').html(sum);
}

//查看图片
function queryImg() {
    index = curindex_8a8acee2709b706201709f58b2fe59a1;
    var arr = new Array(index);
    var brr = new Array(index);
    for (var i = 0; i <= index; i++) {
        var imgid = $('#field_8a8acee2758420d20175886f396d7957_' + i).val();
        var fphm = $('#field_8a8acee2709b706201709f5f8ded5d30_' + i).val();
        if (imgid != null) {
            arr[i] = imgid;
            brr[i] = fphm;
        }
    }
    var param = new Object();
    param.arr = arr;
    param.brr = brr;
    var options = {
        content: '/app/skshu/province/QueryImageGys.jsp?arr=' + param.arr + '&brr=' + param.brr,
        btn1: function (index, layero) {
            debugger;
            //获取window对象
            var invoiceBody = SKSHU.CommonUtils.HLDialog.getIframeWindow(layero);
            //关闭浏览框
            SKSHU.CommonUtils.HLDialog.closeHLLoad(index);
        }
    };
    SKSHU.CommonUtils.HLDialog.openHLDialog(options);
}

function getCont() {
    var fkmoney = $('#field_8a8ad0a03dac251a013daeca4d380c7d').val();
    var fpmoney = $('#field_8a8ad0a03dac251a013daeca4b730c4f').val();
    var sfyfp = document.getElementById('field_8a8ad0944a3c9caa014a4b80ccfb1ca8').value;
    if (sfyfp != '8a8ad0a03a4533e4013a45376ee50006') {
        // 金额比较更改
        var ce = Math.round((parseFloat(fkmoney) - parseFloat(fpmoney)) * 100) / 100
        if (ce >0) {
            alert('付款金额不可大于发票金额');
            return false;
        }
    }
}

//采集
function pushInvoice() {
    var param = new Object();
    var gyssbh = document.getElementById('field_8a8ad0a03dac251a013daeca4b340c49span').innerText;
    param.name = gyssbh.replace(/\s+/g, '');
    //供应商名称
    var gysmc = document.getElementById('field_8a8ad0a03dac251a013daeca4b440c4bspan').innerText;
    gysmc = gysmc.replace(/\s+/g, '');
    if (param.name == '' || param.name == null) {
        alert('请先选择供应商');
        return;
    }
    param.userId = document.getElementById('currentuserid').value; //用户id
    var options = {
        content: '/app/skshu/province/workflowtransmit3.jsp?name=' + param.name + '&userId=' + param.userId,
        btn1: function (idx, layero) {
            //获取window对象
            var invoiceBody = SKSHU.CommonUtils.HLDialog.getIframeWindow(layero);
            //通过win对象调用子页面方法
            var result = invoiceBody.getInvoice();
            //关闭浏览框
            SKSHU.CommonUtils.HLDialog.closeHLLoad(idx);
            if (result == null) {
                return;
            }
        }
    }
    SKSHU.CommonUtils.HLDialog.openHLDialog(options);
}

//获取专票
function pullInvoice() {
    var param = new Object();
    var gyssbh = document.getElementById('field_8a8ad0a03dac251a013daeca4b340c49span').innerText;
    param.name = gyssbh.replace(/\s+/g, '');
    var burname = document.getElementById('field_8a8ad0204c20e0d3014c2c24cde9656d').value;
    param.burname = SQL('select OBJNAME from SELECTITEM where ID=\'' + burname + '\'');
    var gysmc = document.getElementById('field_8a8ad0a03dac251a013daeca4b440c4bspan').innerText;
    param.gysmc = gysmc.replace(/\s+/g, '');
    if (gyssbh == '' || burname == '') {
        alert('请先选择采购组织和供应商');
        return;
    }
    var invoicenostr = document.getElementById('field_8a8ad0a03dac251a013daeca4d090c77').value;
    var options = {
        content: '/app/skshu/province/QueryInvoice2.jsp?name=' + param.name + '&gysmc=' + param.gysmc + '&burname=' + param.burname,
        btn1: function (index, layero) {
            debugger;
            //获取window对象
            var invoiceBody = SKSHU.CommonUtils.HLDialog.getIframeWindow(layero);
            //通过win对象调用子页面方法
            var result = invoiceBody.check();
            //关闭浏览框
            SKSHU.CommonUtils.HLDialog.closeHLLoad(index);

            if (result == null) {
                return;
            }
            var index;
            index = curindex_8a8acee2709b706201709f58b2fe59a1;
            for (var j = 0; j <= index; j++) {
                for (var n = 0; n < result.length; n++) {
                    var perid = $('#field_297ee92c754e268001754ef9166d0177_' + j).val(); //发票标识
                    if (perid == result[n].perinvid) {
                        alert('发票清单中存在勾选的发票');
                        return;
                    }
                }
            }
            var sum = 0;
            for (var i = 0; i < result.length; i++) {
                var d = curindex_8a8acee2709b706201709f58b2fe59a1;
                if ($('#field_8a8acee2709b706201709f5f8ded5d30_' + d).val() == '') {
                    index = curindex_8a8acee2709b706201709f58b2fe59a1;
                } else {
                    addrow('8a8acee2709b706201709f58b2fe59a1'); //添加行
                    index = curindex_8a8acee2709b706201709f58b2fe59a1;
                }
                $('#field_8a8acee2709b706201709f5f8ded5d30_' + index).val(result[i].fphm); //发票号        1
                $('#field_8a8acee2709b706201709f5f8ded5d30_' + index + 'span').html(result[i].fphm); //发票号
                invoicenostr = invoicenostr + '、' + result[i].fphm;
                $('#field_8a8acee2709b706201709f5f8ee05d3a_' + index).val(result[i].kprq); //开票日期            2
                $('#field_8a8acee2709b706201709f5f8ee05d3a_' + index + 'span').html(result[i].kprq); //开票日期
                $('#field_8a8acee2709b706201709f5f8f8c5d40_' + index).val(result[i].hjje); //不含税金额            3
                $('#field_8a8acee2709b706201709f5f8f8c5d40_' + index + 'span').html(result[i].hjje); //不含税金额
                $('#field_8a8acee2709b706201709f5f8fdd5d44_' + index).val(result[i].jshj); //价税合计          4
                $('#field_8a8acee2709b706201709f5f8fdd5d44_' + index + 'span').html(result[i].jshj); //价税合计
                $('#field_297ee92c754e268001754ef9166d0177_' + index).val(result[i].perinvid); //发票标识      5
                $('#field_297ee92c754e268001754ef9166d0177_' + index + 'span').html(result[i].perinvid); //发票标识      5
                $('#field_8a8acee2758b7dc301758ce0fce455b8_' + index).val(result[i].fpdm); //发票代码   6
                $('#field_8a8acee2758b7dc301758ce0fce455b8_' + index + 'span').html(result[i].fpdm); //发票代码
                $('#field_8a8acee2758b7dc301758ce0fd0e55ba_' + index).val(result[i].fplxdm); //发票类型代码  8
                $('#field_8a8acee2758b7dc301758ce0fd0e55ba_' + index + 'span').html(result[i].fplxdm); //发票类型代码
                $('#field_8a8acee2758b7dc301758ce0fd8955c0_' + index).val(result[i].ghdwmc); //购方名称 9
                $('#field_8a8acee2758b7dc301758ce0fd8955c0_' + index + 'span').html(result[i].ghdwmc); //购方名称
                $('#field_8a8acee2758b7dc301758ce0fd6055be_' + index).val(result[i].ghdwsbh); //购方识别号 10
                $('#field_8a8acee2758b7dc301758ce0fd6055be_' + index + 'span').html(result[i].ghdwsbh); //购方识别号
                $('#field_8a8acee2709b706201709f5f8f615d3e_' + index).val(result[i].xhdwmc); //销售方名称 11
                $('#field_8a8acee2709b706201709f5f8f615d3e_' + index + 'span').html(result[i].xhdwmc); //销售方名称
                $('#field_8a8acee2758b7dc301758ce0fddf55c4_' + index).val(result[i].xhdwsbh); //销售方识别号 12
                $('#field_8a8acee2758b7dc301758ce0fddf55c4_' + index + 'span').html(result[i].xhdwsbh); //销售方识别号
                $('#field_8a8acee2758d4d6901758de9433b214a_' + index).val(result[i].fpdl); //发票种类    13
                $('#field_8a8acee2758d4d6901758de9433b214a_' + index + 'span').html(result[i].fpdl); //发票种类

                var hjje = result[i].hjje;
                var jshj = result[i].jshj;
                sum = sum * 1 + jshj * 1;
                var se = Math.round(parseFloat(jshj * 1000 - hjje * 1000)) / 1000;
                $('#field_8a8acee2709b706201709f5f8fb55d42_' + index).val(se); //税额
                $('#field_8a8acee2709b706201709f5f8fb55d42_' + index + 'span').html(se); //税额
            }
            if (invoicenostr.length >= 1) {
                if (invoicenostr.substring(0, 1) == '、') {
                    document.getElementById('field_8a8ad0a03dac251a013daeca4d090c77').value = invoicenostr.substring(1);
                } else {
                    document.getElementById('field_8a8ad0a03dac251a013daeca4d090c77').value = invoicenostr;
                }
            }
            getindex();
            //wshh 2201230 计算并自动回写分摊明细的分摊税额
        }
    }
    SKSHU.CommonUtils.HLDialog.openHLDialog(options);
}

//处理键盘事件 禁止后退键（Backspace）密码或单行、多行文本框除外
function forbidBackSpace(e) {
    var ev = e || window.event; //获取event对象
    var obj = ev.target || ev.srcElement; //获取事件源
    var t = obj.type || obj.getAttribute('type');
    //获取事件源类型
    //获取作为判断条件的事件类型
    var vReadOnly = obj.readOnly;
    var vDisabled = obj.disabled;
    //处理undefined值情况
    vReadOnly = (vReadOnly == undefined) ? false : vReadOnly;
    vDisabled = (vDisabled == undefined) ? true : vDisabled;
    //当敲Backspace键时，事件源类型为密码或单行、多行文本的，
    //并且readOnly属性为true或disabled属性为true的，则退格键失效
    var flag1 = ev.keyCode == 8 && (t == 'password' || t == 'text' || t == 'textarea') && (vReadOnly == true || vDisabled == true);
    //当敲Backspace键时，事件源类型非密码或单行、多行文本的，则退格键失效
    var flag2 = ev.keyCode == 8 && t != 'password' && t != 'text' && t != 'textarea';
    //判断
    if (flag2 || flag1) return false;
}

//禁止后退键  作用于IE、Chrome
document.onkeydown = forbidBackSpace;

function paycomdition() {
    document.getElementById('field_8a8ad0944038bd1901403986d2b30e24').value = '';
    document.getElementById('field_8a8ad0944038bd1901403986d2b30e24' + 'span').innerHTML = '';
    document.getElementById('field_8a8ad0944038bd1901403986d2e20e26').value = '';
    document.getElementById('field_8a8ad0944038bd1901403986d2e20e26' + 'span').innerHTML = '';
    var supplierno = document.getElementById('field_8a8ad0a03dac251a013daeca4b340c49').value;
    var purchorg = document.getElementById('field_8a8ad0204c20e0d3014c2c24cd7c6564').value;
    if (supplierno == '' || purchorg == '' || supplierno == null || purchorg == null) {
        return true;
    } else {
        var sqlpay = 'select a.zterm,a.zterm1  text1 from uf_supp_sub5 a left join uf_supplier b on a.requestid=b.requestid where  b.flowno=\'' + supplierno + '\' and a.bukrs=\'' + purchorg + '\'';
        DataService.getValues(sqlpay, {
            callback: function (data) {
                if (data && data.length > 0) {
                    document.getElementById('field_8a8ad0944038bd1901403986d2b30e24').value = (data[0].zterm == null ? '' : data[0].zterm);
                    document.getElementById('field_8a8ad0944038bd1901403986d2b30e24' + 'span').innerHTML = (data[0].zterm == null ? '' : data[0].zterm);
                    document.getElementById('field_8a8ad0944038bd1901403986d2e20e26').value = (data[0].text1 == null ? '' : data[0].text1);
                    document.getElementById('field_8a8ad0944038bd1901403986d2e20e26' + 'span').innerHTML = (data[0].text1 == null ? '' : data[0].text1);
                }
            }
        });
    }
}

var shareAmountTotal = document.getElementById('field_8a8ad0a03dac251a013daeca4d380c7d').value == '' ? 0 : document.getElementById('field_8a8ad0a03dac251a013daeca4d380c7d').value; //wshh 20201228
function addShareData() {
    var box = $('input[name=check_node_8a8ad09446dbc2090146ef63e43c4c6c]');
    for (var i = 0; i < box.length; i++) {
        box.get(i).checked = true;
    }
    delrow('8a8ad09446dbc2090146ef63e43c4c6c');
    var requestid = document.getElementById('field_8a8ad09444905a35014494c320770504').value;
    $.ajax({
        url: '/app/skshu/budget/budgetsharingaction.jsp',
        data: {action: 'getCShareDetail', requestid: requestid},
        type: 'post',
        async: false,
        dataType: 'json',
        success: function (data) {
            if (data.success) {
                if (data.shareDetail.length > 0) {
                    for (var i = 0; i < data.shareDetail.length; i++) {
                        var d = data.shareDetail[i];
                        addrow('8a8ad09446dbc2090146ef63e43c4c6c');
                        var idx = curindex_8a8ad09446dbc2090146ef63e43c4c6c;
                        document.getElementById('field_8a8ad09446dbc2090146ef6856e84c80_' + idx).value = d.orgId;
                        document.getElementById('field_8a8ad09446dbc2090146ef6856e84c80_' + idx + 'span').innerHTML = d.orgName;
                        document.getElementById('field_8a8acee273fbe6de0173fcdfc06a28a6_' + idx).value = d.id;
                        document.getElementById('field_8a8acee273fbe6de0173fd59dd803e7b_' + idx).value = d.workflowid;
                        getavilamount(idx);
                        var orgBtn = document.getElementById('field_8a8ad09446dbc2090146ef6856e84c80_' + idx);
                        var subjectBtn = document.getElementById('field_8a8ad09446dbc2090146ef6857174c82_' + idx);
                        WeaverUtil.watch(orgBtn, function () {
                            getavilamount(idx);
                            checkOrginit(idx);
                        });//加监听，所属部门变化时，1.重新计算明细行可用预算金额，2.check客户和分摊类型是否必填
                        WeaverUtil.watch(subjectBtn, function () {
                            getavilamount(idx);
                        }); //加监听，二级科目变化时，重新计算明细行可用预算金额
                        subject3Onclick(idx); //加监听，三级科目变化时，自动带出二级科目
                        customerOnclick(idx); //加点击事件，点击分摊客户时，只带出所属部门下的客户
                        var checknodestemp = document.getElementsByName('check_node_8a8ad09446dbc2090146ef63e43c4c6c');
                        var tempidx = checknodestemp[0].value;
                        if (idx == tempidx) {//第一行分摊明细，分摊金额取本次申请付款金额
                            var je = document.getElementById('field_8a8ad0a03dac251a013daeca4d380c7d').value == '' ? 0 : document.getElementById('field_8a8ad0a03dac251a013daeca4d380c7d').value;         //子表报销金额
                            document.getElementById('field_8a8ad09446dbc2090146ef6857364c84_' + idx).value = je;         //子表报销金额
                            document.getElementById('field_8a8ad09448f76bc801493720a6292273').value = je;
                            document.getElementById('field_8a8ad09448f76bc801493720a6292273span').innerHTML = je;
                            shareAmountTotal = je;
                        }
                        if (idx > tempidx) {
                            $('#field_8a8ad09446dbc2090146ef6857364c84_' + idx).on('keyup', function () {
                                calFtInit();
                            });//wshh 20201228
                        } else {
                            $('#field_8a8ad09446dbc2090146ef6857364c84_' + idx).blur(function () {
                                var shouhangjine = document.getElementById('field_8a8ad09446dbc2090146ef6857364c84_' + tempidx).value == '' ? 0 : document.getElementById('field_8a8ad09446dbc2090146ef6857364c84_' + tempidx).value;
                                document.getElementById('field_8a8ad09448f76bc801493720a6292273').value = shouhangjine;
                                document.getElementById('field_8a8ad09448f76bc801493720a6292273span').innerHTML = shouhangjine;
                                shareAmountTotal = shouhangjine;
                            });
                        }
                        $('#field_8a8ad09446dbc2090146ef6857364c84_' + tempidx).attr('readOnly', 'true');

                    }
                }
            } else {
                alert('获取申请分摊明细失败！');
            }
        }
    });
    //wshh
    document.getElementById('field_8a8ad09448f76bc801493720a6292273').value = shareAmountTotal;
    document.getElementById('field_8a8ad09448f76bc801493720a6292273span').innerHTML = shareAmountTotal;
}

//获取明细行可用预算金额
function getavilamount(index) {
    var orgId = document.getElementById('field_8a8ad09446dbc2090146ef6856e84c80_' + index).value;    //分摊组织
    var subjectId = document.getElementById('field_8a8ad09446dbc2090146ef6857174c82_' + index).value;    //分摊预算科目
    var applyOrgId = document.getElementById('field_8a8ad09444905a35014494d4294e0520').value;
    var kemu111 = document.getElementById('field_8a8ad09448ba3de20148c3efb8c825a9');
    if (kemu111.value != '8a8acee27f216d3b017f24463f400e95') {     //装饰公司措施费
        $.ajax({
            url: '/app/skshu/budget/budgetsharingaction.jsp',
            data: {action: 'getavilamount', orgId: orgId, subjectId: subjectId, applyOrgId: applyOrgId},
            type: 'post',
            async: false,
            dataType: 'json',
            success: function (data) {
                if (data.success) {
                    document.getElementById('field_8a8acee27370f1760173752453d213a1_' + index).value = data.avilamount;
                    document.getElementById('field_8a8acee27370f1760173752453d213a1_' + index + 'span').innerHTML = data.avilamount;
                    if (!data.flag) {
                        alert(data.message);
                    }
                } else {
                    alert('获取可用预算金额失败！');
                }
            }
        });
    }
}

function isProductTypeValid(index) {
    var productId = document.getElementById('field_8a8acee27693bf64017693dcc6500595_' + index).value;    //分摊产品类别
    if ('99999999' == productId) {
        document.getElementById('field_8a8acee27693bf64017693dcc6500595_' + index).value = '';
        document.getElementById('field_8a8acee27693bf64017693dcc6500595_' + index + 'span').innerHTML = '';
        alert('分摊产品类别选择有误，请重新选择，只能选择中小类产品！');
    }
    DWREngine.setAsync(false);
    if (productId != null && productId != '' && productId != undefined) {
        var sqlStr = 'select typeid,codename from uf_bugdet_typelist a where a.requestid=\'' + productId + '\' ';
        DataService.getValues(sqlStr, {
            callback: function (data) {
                if (data && data.length > 0) {
                    //alert(data[0].typeid);
                    if (data[0].typeid != '8a8ad0943fe1ba7f013fe554e25b03bf' && data[0].typeid != '8a8ad0943fe1ba7f013fe554e25b03c0') {
                        document.getElementById('field_8a8acee27693bf64017693dcc6500595_' + index).value = '';
                        document.getElementById('field_8a8acee27693bf64017693dcc6500595_' + index + 'span').innerHTML = '';
                        alert('不能选择产品大类【' + data[0].codename + '】，只能选择中小类！');
                    }
                }
            }
        });
    }
    DWREngine.setAsync(true);
}

//初始化默认分摊数据
function initDefaultShare() {
    $('#oTable8a8ad09446dbc2090146ef63e43c4c6c').find('.DataLight').each(function (i) {
        var idx = document.getElementsByName('check_node_8a8ad09446dbc2090146ef63e43c4c6c')[i].value;
        getavilamount(idx);
        subject3Onclick(idx); //加监听，三级科目变化时，自动带出二级科目
        var orgBtn = document.getElementById('field_8a8ad09446dbc2090146ef6856e84c80_' + idx);
        var subjectBtn = document.getElementById('field_8a8ad09446dbc2090146ef6857174c82_' + idx);
        WeaverUtil.watch(orgBtn, function () {
            getavilamount(idx);
        });
        WeaverUtil.watch(subjectBtn, function () {
            getavilamount(idx);
        });
        var productBtn = document.getElementById('field_8a8acee27693bf64017693dcc6500595_' + idx);
        WeaverUtil.watch(productBtn, function () {
            isProductTypeValid(idx);
        }); //加监听，分摊产品类别不能选择大类
    });
}

//判断预算分摊
function validateBudgetShare() {
    var resp;
    var orgids = '', subjects = '', moneys = '', shareIds = '', workflowIds = '';
    $('#oTable8a8ad09446dbc2090146ef63e43c4c6c').find('.DataLight').each(function (i) {
        var index = document.getElementsByName('check_node_8a8ad09446dbc2090146ef63e43c4c6c')[i].value;
        var orgId = document.getElementById('field_8a8ad09446dbc2090146ef6856e84c80_' + index).value;    //分摊组织
        var subjectId = document.getElementById('field_8a8ad09446dbc2090146ef6857174c82_' + index).value;    //分摊预算科目
        var money = document.getElementById('field_8a8ad09446dbc2090146ef6857364c84_' + index).value;    //分摊金额
        var shareId = document.getElementById('field_8a8acee273fbe6de0173fcdfc06a28a6_' + index).value;//分摊id
        var workflowId = document.getElementById('field_8a8acee273fbe6de0173fd59dd803e7b_' + index).value;//分摊流程id
        orgids += orgId + ',';
        subjects += subjectId + ',';
        moneys += money + ',';
        shareIds += shareId + ',';
        workflowIds += workflowId + ',';
    });
    var applyOrgId = document.getElementById('field_8a8ad09444905a35014494d4294e0520').value;
    $.ajax({
        url: '/app/skshu/budget/budgetsharingaction.jsp',
        data: {
            action: 'validate',
            orgids: orgids,
            subjects: subjects,
            moneys: moneys,
            applyOrgId: applyOrgId,
            shareIds: shareIds,
            workflowIds: workflowIds
        },
        type: 'post',
        async: false,
        dataType: 'json',
        success: function (data) {
            resp = data;
        }
    });
    return resp;
}

function removeHTMLTag(str) {
    str = str.replace(/<\/?[^>]*>/g, ''); //去除HTML tag
    str = str.replace(/[ | ]*\n/g, '\n'); //去除行尾空白
    str = str.replace(/\n[\s| | ]*\r/g, '\n'); //去除多余空行
    str = str.replace(/^\n+|\n+$/g, '');//去除回车符
    str = str.replace(/ /ig, ''); //去除多余空行
    str = str.replace(/&/ig, ''); //去除多余空
    str = str.replace(/nbsp;/ig, ''); //去除多余空
    str = str.replace(/ /ig, '');//去掉
    return str;
}

function checkOrginit(idx) {
    debugger
    var subjectIdcheck = document.getElementById('field_8a8ad09448ba3de20148c3efb8c825a9').value;    //报送一级预算科目
    var orgId = document.getElementById('field_8a8ad09446dbc2090146ef6856e84c80_' + idx).value;    //分摊部门
    var orgName = document.getElementById('field_8a8ad09446dbc2090146ef6856e84c80_' + idx + 'span').innerHTML;    //分摊部门
    var sqlStr = 'select kmdeptforkh,kmdeptforcp from uf_budgetmemu where REQUESTID= \'' + subjectIdcheck + '\' ';
    DWREngine.setAsync(false);
    DataService.getValues(sqlStr, {
        callback: function (data) {
            if (data && data.length > 0) {
                if (data[0].kmdeptforkh != null) {
                    var kmdept = data[0].kmdeptforkh.split(',');
                    var sqlStr2 = 'select count(1) cnt from orgunit org,orgunitlink a where org.id=a.oid and a.oid = \'' + orgId + '\' '
                        + 'AND (';
                    for (i = 0; i < kmdept.length; i++) {
                        if (i == 0) {
                            sqlStr2 = sqlStr2 + 'A .col1 LIKE \'%' + kmdept[i] + '%\' '//--大客户中心32位ID
                        } else {
                            sqlStr2 = sqlStr2 + ' OR  A .col1 LIKE \'%' + kmdept[i] + '%\' '//--大客户中心32位ID
                        }
                    }
                    sqlStr2 = sqlStr2 + ') and org.typeid in(\'2c91a0302a87f19c012a894ce1650003\',\'2c90e44369009cca016900b600d60004\',\'2c90e44369009cca016900b65ada0005\',\'8a8ad0a03d7c8380013d7d2f570104b2\')';
                    DataService.getValues(sqlStr2, {
                        callback: function (data2) {
                            if (data2 && data2.length > 0) {
                                if (data2[0].cnt > 0) {
                                    var customer = document.getElementById('field_8a8acee27693bf64017693dcc51f058d_' + idx).value;    //分摊客户
                                    if (customer == null || customer == '') {
                                        //document.getElementById('field_8a8acee27693bf64017693dcc51f058d_' + idx + 'span').innerHTML = '<IMG src=http://10.10.78.98:8001/images/base/checkinput.gif align=absMiddle>';
                                        //alert(orgName+'的分摊客户必填');
                                        //return false;
                                    }
                                } else {
                                    var lb = document.getElementById('field_8a8acee27693bf64017693dcc51f058d_' + idx).value;    //分摊产品类别
                                    if (lb == null || lb == '') {
                                        document.getElementById('field_8a8acee27693bf64017693dcc51f058d_' + idx + 'span').innerHTML = '';
                                    }
                                }
                            }
                        }
                    })
                }
                if (data[0].kmdeptforcp != null) {
                    var kmdept = data[0].kmdeptforcp.split(',');
                    var sqlStr2 = 'select count(1) cnt from orgunit org,orgunitlink a where org.id=a.oid and a.oid = \'' + orgId + '\' '
                        + 'AND (';
                    for (i = 0; i < kmdept.length; i++) {
                        if (i == 0) {
                            sqlStr2 = sqlStr2 + 'A .col1 LIKE \'%' + kmdept[i] + '%\' '//--大客户中心32位ID
                        } else {
                            sqlStr2 = sqlStr2 + ' OR  A .col1 LIKE \'%' + kmdept[i] + '%\' '//--大客户中心32位ID
                        }
                    }
                    sqlStr2 = sqlStr2 + ') and org.typeid in(\'2c91a0302a87f19c012a894ce1650003\',\'2c90e44369009cca016900b600d60004\',\'2c90e44369009cca016900b65ada0005\',\'8a8ad0a03d7c8380013d7d2f570104b2\')';
                    DataService.getValues(sqlStr2, {
                        callback: function (data2) {
                            if (data2 && data2.length > 0) {
                                if (data2[0].cnt > 0) {
                                    var lb = document.getElementById('field_8a8acee27693bf64017693dcc6500595_' + idx).value;    //分摊产品类别
                                    if (lb == null || lb == '') {
                                        //document.getElementById('field_8a8acee27693bf64017693dcc6500595_' + idx + 'span').innerHTML = '<IMG src=http://10.10.78.98:8001/images/base/checkinput.gif align=absMiddle>';
                                        //alert(orgName+'的分摊产品类别必填');
                                        //return false;
                                    }
                                } else {
                                    var lb = document.getElementById('field_8a8acee27693bf64017693dcc6500595_' + idx).value;    //分摊产品类别
                                    if (lb == null || lb == '') {
                                        document.getElementById('field_8a8acee27693bf64017693dcc6500595_' + idx + 'span').innerHTML = '';
                                    }

                                }
                            }
                        }
                    })
                }
            }
        }
    });
    DWREngine.setAsync(true);
}

function checkOrg(idx) {
    var subjectIdcheck = document.getElementById('field_8a8ad09448ba3de20148c3efb8c825a9').value;    //报送一级预算科目
    var orgId = document.getElementById('field_8a8ad09446dbc2090146ef6856e84c80_' + idx).value;    //分摊部门
    var orgName = document.getElementById('field_8a8ad09446dbc2090146ef6856e84c80_' + idx + 'span').innerHTML;    //分摊部门
    var sqlStr = 'select kmdeptforkh,kmdeptforcp from uf_budgetmemu where REQUESTID= \'' + subjectIdcheck + '\' ';
    DWREngine.setAsync(false);
    DataService.getValues(sqlStr, {
        callback: function (data) {
            if (data && data.length > 0) {
                if (data[0].kmdeptforkh != null) {
                    var kmdept = data[0].kmdeptforkh.split(',');
                    var sqlStr2 = 'select count(1) cnt from orgunit org,orgunitlink a where org.id=a.oid and a.oid = \'' + orgId + '\' '
                        + 'AND (';
                    for (i = 0; i < kmdept.length; i++) {
                        if (i == 0) {
                            sqlStr2 = sqlStr2 + 'A .col1 LIKE \'%' + kmdept[i] + '%\' '//--大客户中心32位ID
                        } else {
                            sqlStr2 = sqlStr2 + ' OR  A .col1 LIKE \'%' + kmdept[i] + '%\' '//--大客户中心32位ID
                        }
                    }
                    sqlStr2 = sqlStr2 + ') and org.typeid in(\'2c91a0302a87f19c012a894ce1650003\',\'2c90e44369009cca016900b600d60004\',\'2c90e44369009cca016900b65ada0005\',\'8a8ad0a03d7c8380013d7d2f570104b2\')';
                    DataService.getValues(sqlStr2, {
                        callback: function (data2) {
                            if (data2 && data2.length > 0) {
                                if (data2[0].cnt > 0) {
                                    var customer = document.getElementById('field_8a8acee27693bf64017693dcc51f058d_' + idx).value;    //分摊客户
                                    if (customer == null || customer == '') {
                                        alert(orgName + 的分摊客户必填);
                                        return false;
                                    }
                                }
                            }
                        }
                    })
                }
                if (data[0].kmdeptforcp != null) {
                    var kmdept = data[0].kmdeptforcp.split(',');
                    var sqlStr2 = 'select count(1) cnt from orgunit org,orgunitlink a where org.id=a.oid and a.oid = \'' + orgId + '\' '
                        + 'AND (';
                    for (i = 0; i < kmdept.length; i++) {
                        if (i == 0) {
                            sqlStr2 = sqlStr2 + 'A .col1 LIKE \'%' + kmdept[i] + '%\' '//--大客户中心32位ID
                        } else {
                            sqlStr2 = sqlStr2 + ' OR  A .col1 LIKE \'%' + kmdept[i] + '%\' '//--大客户中心32位ID
                        }

                    }
                    sqlStr2 = sqlStr2 + ') and org.typeid in(\'2c91a0302a87f19c012a894ce1650003\',\'2c90e44369009cca016900b600d60004\',\'2c90e44369009cca016900b65ada0005\',\'8a8ad0a03d7c8380013d7d2f570104b2\')';
                    DataService.getValues(sqlStr2, {
                        callback: function (data2) {
                            if (data2 && data2.length > 0) {
                                if (data2[0].cnt > 0) {
                                    var lb = document.getElementById('field_8a8acee27693bf64017693dcc6500595_' + idx).value;    //分摊产品类别
                                    if (lb == null || lb == '') {
                                        alert(orgName + 的分摊产品类别必填)
                                        return false;
                                    }
                                }
                            }
                        }
                    })
                }
            }
        }
    });
    DWREngine.setAsync(true);
    return true;
}

function getHT() {
    var gsyno = document.getElementsByName('field_8a8ad0a03dac251a013daeca4b340c49')[0];//供应商编号
    if (gsyno.value == '') {
        alert('请先选择供应商编号');
        return;
    }
    //brows框 add by 郑界华  begin 控制合同可用性   当流程结束之后合同不可被搜索出来
    var param = 'sqlwhere=1=1 and suppno in (select requestid from uf_supplier where flowno=\'' + gsyno.value + '\') and  not exists(select 1 from uf_supplier_pay where nvl(payedtoend,\'8a8acee27825f991017834707924781a\') =  \'8a8acee27825f9910178347079247819\' and  contractno=uf_stock_contract.requestid and requestid in (select rb.id from requestbase rb where rb.isfinished = 1)) ';
    getrefobj('field_8a8ad0a03dac251a013daeca4bff0c5d', 'field_8a8ad0a03dac251a013daeca4bff0c5dspan', '8a8acee273c77cb60173d666fd11181a', param, '/workflow/request/formbase.jsp?requestid=', '0');
}

function getWHT() {
    var gsyno = document.getElementsByName('field_8a8ad0a03dac251a013daeca4b340c49')[0];//供应商编号
    if (gsyno.value == '') {
        alert('请先选择供应商编号');
        return;
    }
    var param = 'sqlwhere=1=1 and supplyno in (\'' + gsyno.value + '\') ';
    getrefobj('field_8a8ad09444905a35014494c320770504', 'field_8a8ad09444905a35014494c320770504span', '8a8ad094449b41570144b90848c53ddf', param, '/workflow/request/formbase.jsp?requestid=', '0');
}

//合同
function displayCon() {
    document.getElementById('div6').style.display = '';            //合同执行方式
    document.getElementById('div1').style.display = '';            //合同数据
    document.getElementById('div2').style.display = 'none';   //C类数据
    document.getElementById('div3').style.display = '';           //预算数据1，有合同时要进行预算控制
    document.getElementById('div4').style.display = '';           //预算数据2，有合同时要进行预算控制
    document.getElementById('button_8a8ad0a03dac251a013daeca4b340c49').style.display = 'none'; //供应商按钮不可编辑
    document.getElementById('field_8a8ad09444905a35014494c320770504').value = '';     //C类申请单
    document.getElementById('field_8a8ad09444905a35014494ce49660518').value = '';     //总额
    document.getElementById('field_8a8ad09444905a35014494ce4985051a').value = '';     //已付
    document.getElementById('field_8a8ad09444905a35014494ce4995051c').value = '';     //未付
}

//C类
function displayCpay() {
    document.getElementById('div6').style.display = 'none';            //合同执行方式
    document.getElementById('div1').style.display = 'none';            //合同数据
    document.getElementById('div2').style.display = '';                    //C类数据
    document.getElementById('div3').style.display = 'none';           //预算数据1，有合同时要进行预算控制
    document.getElementById('div4').style.display = 'none';           //预算数据2，有合同时要进行预算控制
    document.getElementById('button_8a8ad0a03dac251a013daeca4b340c49').style.display = 'none'; //供应商按钮不可编辑
    document.getElementById('field_8a8ad0a03dac251a013daeca4bff0c5d').value = '';    //合同编号
    document.getElementById('field_8a8ad0a03dac251a013daeca4c0f0c5f').value = '';     //合同名称
    document.getElementById('field_8a8ad0a03dac251a013daeca4c2e0c61').value = '';   //合同总额
    document.getElementById('field_8a8ad09441c756ee0141d9f5cd301abf').value = '';    //已付
    document.getElementById('field_8a8ad0944029a75a01402d40b3f22d8d').value = '';    //未付
    document.getElementById('field_8a8ad0944d65f4e2014d8ee7955466ea').value = '';   //本月预算申请金额
    document.getElementById('field_8a8ad0944d65f4e2014d8ee7964e66ec').value = '';    //本月累计申请金额
    document.getElementById('field_8a8ad0944d65f4e2014d8ee7979666ee').value = '';    //本月可用预算金额
    document.getElementById('field_8a8ad0de683181f2016831cd15ec1f00').value = '';	//合同执行方式
    document.getElementById('field_8a8ad0a03e12dcfc013e15ae25350190').value = '';	//已累计申请
}

//默认
function displayDefault() {
    document.getElementById('div6').style.display = 'none'; 			//合同执行方式
    document.getElementById('div1').style.display = 'none';            //合同数据
    document.getElementById('div2').style.display = 'none';           //C类数据
    document.getElementById('div3').style.display = 'none';           //预算数据1，有合同时要进行预算控制
    document.getElementById('div4').style.display = 'none';           //预算数据2，有合同时要进行预算控制
    document.getElementById('button_8a8ad0a03dac251a013daeca4b340c49').style.display = ''; //供应商按钮可编辑
    document.getElementById('field_8a8ad09444905a35014494c320770504').value = '';      //申请单
    document.getElementById('field_8a8ad09444905a35014494ce49660518').value = '';     //总额
    document.getElementById('field_8a8ad09444905a35014494ce4985051a').value = '';     //已付
    document.getElementById('field_8a8ad09444905a35014494ce4995051c').value = '';     //未付
    document.getElementById('field_8a8ad0a03dac251a013daeca4bff0c5d').value = '';    //合同编号
    document.getElementById('field_8a8ad0a03dac251a013daeca4c0f0c5f').value = '';     //合同名称
    document.getElementById('field_8a8ad0a03dac251a013daeca4c2e0c61').value = '';   //合同总额
    document.getElementById('field_8a8ad09441c756ee0141d9f5cd301abf').value = '';    //已付
    document.getElementById('field_8a8ad0944029a75a01402d40b3f22d8d').value = '';    //未付
    document.getElementById('field_8a8ad0de683181f2016831cd15ec1f00').value = '';	//合同执行方式
    document.getElementById('field_8a8ad0a03e12dcfc013e15ae25350190').value = '';	//已累计申请
}

function urlsrys() {
    var htporder = document.getElementById('field_8a8ad0a03dac251a013daeca4bff0c5d').value;
    var istract = document.getElementById('field_8a8ad09444905a35014494c320380502').value;
    var rt = document.getElementById('field_8a8ad09444905a35014494c320770504').value;
    if (document.getElementById('field_8a8ad0a03dac251a013daeca4bff0c5d').value != '') {
        var hturl = '/ServiceAction/com.eweaver.workflow.report.servlet.ReportAction?action=search&isformbase=1&reportid=8a8ad0a03f21c80e013f21db7738007a&con8a8ad0a03f21c80e013f21d8e2810022_value=' + htporder;
        onUrl(hturl, '合同请购明细', '');
    }
    if (istract != '' && rt != '') {
        var hturl = '/ServiceAction/com.eweaver.workflow.report.servlet.ReportAction?action=search&isformbase=1&reportid=8a8ad09444e35b2d0144f22ba5c04805&con8a8ad09444e35b2d0144f23eaa094831_value=' + rt;
        onUrl(hturl, 'C类供应商付款明细', '');
    }
}

function customerOnclick(idx) {
    //给分摊客户加点击事件，只带出所属部门下的分摊客户
    document.getElementsByName('button_8a8acee27693bf64017693dcc51f058d_' + idx)[0].onclick = function () {
        var ftmb = document.getElementById('field_8a8ad09446dbc2090146ef6856e84c80_' + idx).value; // 分摊部门
        if (ftmb == '' || ftmb == 'undefinde' || ftmb == undefined) {
            alert('请先选择所属部门！');
            return;
        }
        var typeid = '';
        DWREngine.setAsync(false);
        var sql = 'SELECT typeid from orgunit WHERE id=\'' + ftmb + '\' ';
        DataService.getValues(sql, function (data) {
            if (data && data.length) {
                typeid = data[0].typeid;
            }
        });
        DWREngine.setAsync(true);
        var param = '';
        if (typeid == '4028804d2083a7ed012083ebb988005b') {//事业部
            param = 'con8a8acee27982a8fe017983649b32194b_value=' + encodeURI(ftmb);
        } else if (typeid == '2c90e44369009cca016900b600d60004') {//省区
            param = 'con8a8acee27982a8fe017983649b45194d_value=' + encodeURI(ftmb);
        } else if (typeid == '2c90e44369009cca016900b57af20003') {//大区
            param = 'con8a8acee27982a8fe017983649b39194c_value=' + encodeURI(ftmb);
        }
        getrefobj('field_8a8acee27693bf64017693dcc51f058d_' + idx, 'field_8a8acee27693bf64017693dcc51f058d_' + idx + 'span',
            '8a8acee27982a8fe017983c86b792a7d', param, '', '0');
    }
}

function subject3Onclick(idx) {
    var glkm = document.getElementById('button_8a8acee27693bf64017693dcc4db058b_' + idx);//  所属管理科目
    //给所属管理科目加监听，带出二级科目
    WeaverUtil.watch(document.getElementById('field_8a8acee27693bf64017693dcc4db058b_' + idx), function () {
        var yskm_3 = document.getElementById('field_8a8acee27693bf64017693dcc4db058b_' + idx).value;
        if (yskm_3 != '' && yskm_3 != 'undefinde' && yskm_3 != undefined) {
            DWREngine.setAsync(false);
            var menuname = '';
            var menuid = '';
            var sql = 'select requestid ,memuname from uf_budgetmemu where requestid=(select LASTMEMU from UF_MANAGE_SUBJECT where requestid=\'' + yskm_3 + '\') ';
            DataService.getValues(sql, function (data) {
                if (data && data.length) {
                    menuname = data[0].memuname;
                    menuid = data[0].requestid;
                }
            });
            document.getElementById('field_8a8ad09446dbc2090146ef6857174c82_' + idx).value = menuid;
            document.getElementById('field_8a8ad09446dbc2090146ef6857174c82_' + idx + 'span').innerHTML = menuname;
            DWREngine.setAsync(true);
        }
    })
    //给所属管理科目（三级科目）加点击事件，只带出一级科目下的三级科目
    glkm.onclick = function () {
        var yskm_1 = document.getElementById('field_8a8ad09448ba3de20148c3efb8c825a9').value; // 预算一级科目
        if (yskm_1 == '' || yskm_1 == 'undefinde' || yskm_1 == undefined) {
            alert('请先选择预算科目！');
            return;
        }
        DWREngine.setAsync(false);
        var memucode = '';
        var sql = 'select MEMUCODE from uf_budgetmemu WHERE REQUESTID=\'' + yskm_1 + '\' ';
        DataService.getValues(sql, function (data) {
            if (data && data.length) {
                memucode = data[0].memucode;
            }
        });
        DWREngine.setAsync(true);
        var param = 'con8a8acee2797969c6017979a9143f0f66_value=' + encodeURI(memucode);
        getrefobj('field_8a8acee27693bf64017693dcc4db058b_' + idx, 'field_8a8acee27693bf64017693dcc4db058b_' + idx + 'span',
            '8a8acee2797969c6017979b1b28210f1', param, '', '0');

    }
}

//以下为加载分摊子表的代码
var requestid = document.getElementById('requestid').value;

function deldata() {
    var checknodestemp = document.getElementsByName('check_node_8a8ad09446dbc2090146ef63e43c4c6c');
    var tempidx = checknodestemp[0].value;

    var isFirst = false;
    var formid_new = '8a8ad09446dbc2090146ef63e43c4c6c';
    var checknode = 'check_node_' + formid_new;
    var checkboxes = document.getElementsByName(checknode);
    for (var i = 0; i < checkboxes.length; i++) {
        var idx = document.getElementsByName(checknode)[i].value;
        if (document.getElementsByName(checknode)[i].checked == true) {
            if (idx == tempidx) {
                alert('第一行不允许删除！');
                isFirst = true;
            }
        }
    }
    if (!isFirst) {
        delrow('8a8ad09446dbc2090146ef63e43c4c6c');
        calFtInit();
    }

}

function adddata() {
    var val = document.getElementById('field_8a8ad09448ba3de20148c3efb8c825a9').value;                                   //主表科目
    var vals = document.getElementById('field_8a8ad09448ba3de20148c3efb8c825a9span').innerHTML;
    if (val != '') {
        addrow('8a8ad09446dbc2090146ef63e43c4c6c');
        var idx = curindex_8a8ad09446dbc2090146ef63e43c4c6c;
        budgetOrgOnclick(idx);
        document.getElementById('field_8a8ad09446dbc2090146ef6857174c82_' + idx).value = val;                                 //子表科目
        document.getElementById('field_8a8ad09446dbc2090146ef6857174c82_' + idx + 'span').innerHTML = vals;
        //modify by wujh 20210511 默认为费用归属部门
        document.getElementById('field_8a8ad09446dbc2090146ef6856e84c80_' + idx).value = document.getElementById('field_8a8ad09448ba3de20148c3efb7ed25a5').value;         //费用部门
        document.getElementById('field_8a8ad09446dbc2090146ef6856e84c80_' + idx + 'span').innerHTML = document.getElementById('field_8a8ad09448ba3de20148c3efb7ed25a5span').innerHTML;
        // getavilamount(idx);
        var orgBtn = document.getElementById('field_8a8ad09446dbc2090146ef6856e84c80_' + idx);
        var subjectBtn = document.getElementById('field_8a8ad09446dbc2090146ef6857174c82_' + idx);
        var productBtn = document.getElementById('field_8a8acee27693bf64017693dcc6500595_' + idx);
        WeaverUtil.watch(orgBtn, function () {
            getavilamount(idx);
            checkOrginit(idx);
        });//加监听，所属部门变化时，1.重新计算明细行可用预算金额，2.check客户和分摊类型是否必填
        WeaverUtil.watch(subjectBtn, function () {
            getavilamount(idx);
        }); //加监听，二级科目变化时，重新计算明细行可用预算金额
        WeaverUtil.watch(productBtn, function () {
            isProductTypeValid(idx);
        }); //加监听，分摊产品类别不能选择大类
        subject3Onclick(idx); //加监听，三级科目变化时，自动带出二级科目
        customerOnclick(idx); //加点击事件，点击分摊客户时，只带出所属部门下的客户
        var checknodestemp = document.getElementsByName('check_node_8a8ad09446dbc2090146ef63e43c4c6c');
        var tempidx = checknodestemp[0].value;
        if (idx == tempidx) {//第一行分摊明细，分摊金额取本次申请付款金额
            var je = document.getElementById('field_8a8ad0a03dac251a013daeca4d380c7d').value == '' ? 0 : document.getElementById('field_8a8ad0a03dac251a013daeca4d380c7d').value;         //子表报销金额
            document.getElementById('field_8a8ad09446dbc2090146ef6857364c84_' + idx).value = je;         //子表报销金额
            document.getElementById('field_8a8ad09448f76bc801493720a6292273').value = je;
            document.getElementById('field_8a8ad09448f76bc801493720a6292273span').innerHTML = je;
            shareAmountTotal = je;
        }
        if (idx > tempidx) {
            $('#field_8a8ad09446dbc2090146ef6857364c84_' + idx).on('keyup', function () {
                calFtInit();
            });//wshh 20201228
        } else {
            $('#field_8a8ad09446dbc2090146ef6857364c84_' + idx).blur(function () {
                var shouhangjine = document.getElementById('field_8a8ad09446dbc2090146ef6857364c84_' + tempidx).value == '' ? 0 : document.getElementById('field_8a8ad09446dbc2090146ef6857364c84_' + tempidx).value;
                document.getElementById('field_8a8ad09448f76bc801493720a6292273').value = shouhangjine;
                document.getElementById('field_8a8ad09448f76bc801493720a6292273span').innerHTML = shouhangjine;
                shareAmountTotal = shouhangjine;
            });
        }
        $('#field_8a8ad09446dbc2090146ef6857364c84_' + tempidx).attr('readOnly', 'true');
    }
    // 自动计算可用预算金额 2022/10/21 begin
    $('#oTable8a8ad09446dbc2090146ef63e43c4c6c').find('.DataLight').each(function (i) {          //分摊明细子表
        var idx = document.getElementsByName('check_node_8a8ad09446dbc2090146ef63e43c4c6c')[i].value;
        WeaverUtil.addEvent(document.getElementById('field_8a8acee27f216d3b017f24ae97b71fec_' + idx), 'change', function () {
            debugger;
            var kyysje = document.getElementById('field_8a8acee27370f1760173752453d213a1_' + idx).value; //可用预算金额
            var qtxgsq = document.getElementById('field_8a8ad0a03e35f8e8013e3b57eec125f1').value; //其他相关申请
            var ejkm = document.getElementById('field_8a8ad09448ba3de20148c3efb8c825a9').value;
            var sql = 'select xcglfje,hqclfje,xckqje,jjsje,sdjphfje,input016,csfje,input014,input012,input010,input008,input006,input004,input002 from uf_proj_budget where requestid=\'' + qtxgsq + '\''; //找到相关申请的各费用
            var xmejkm = document.getElementById('field_8a8acee27f216d3b017f24ae97b71fec_' + idx).value; //项目二级科目
            var sql1 = 'select nvl(sum(a.bxmoney),0) bxmoney from uf_genaralfeepay3 a, uf_genaralfeepay b where a.xmglkm = \'' + xmejkm + '\' and a.requestid = b.requestid and b.elseflow!=\'' + qtxgsq + '\' and b.budgetitem!=\'8a8acee27f216d3b017f24463f400e95\' ';  //项目管理费（数据库中已有的）
            var xmgl = '';
            var suma = 0;
            var sumb = 0;
            DWREngine.setAsync(false);//设置为同步获取数据
            DataService.getValues(sql, {
                callback: function (data) {
                    if (data && data.length > 0) {
                        if (xmejkm == '8a8acee27f216d3b017f248febec1bf7') {    //现场客情费
                            var xckqf1 = data[0].xckqje == null ? '' : data[0].xckqje;
                            suma = parseFloat(xckqf1);
                            document.getElementById('field_8a8acee27693bf64017693dcc4db058b_' + idx).value = '8a8acee279ea7a560179ea8a171629e7';  //招待费-招待费
                            document.getElementById('field_8a8acee27693bf64017693dcc4db058b_' + idx + 'span').innerHTML = '8a8acee279ea7a560179ea8a171629e7';
                        } else if (xmejkm == '8a8acee27f216d3b017f248febec1bf8') {    //居间费
                            var jjf1 = data[0].jjsje == null ? '' : data[0].jjsje;
                            suma = parseFloat(jjf1);
                            document.getElementById('field_8a8acee27693bf64017693dcc4db058b_' + idx).value = '8a8acee279ea7a560179ea8a3e542ff5';  //其他费用-其他费用
                            document.getElementById('field_8a8acee27693bf64017693dcc4db058b_' + idx + 'span').innerHTML = '8a8acee279ea7a560179ea8a3e542ff5';
                        } else if (xmejkm == '8a8acee27f216d3b017f248febec1bf9') {    //总包配合费
                            var zbphf1 = data[0].sdjphfje == null ? '' : data[0].sdjphfje;
                            suma = parseFloat(zbphf1);
                            document.getElementById('field_8a8acee27693bf64017693dcc4db058b_' + idx).value = '8a8acee279ea7a560179ea8a3e542ff5';  //其他费用-其他费用
                            document.getElementById('field_8a8acee27693bf64017693dcc4db058b_' + idx + 'span').innerHTML = '8a8acee279ea7a560179ea8a3e542ff5';
                        } else if (xmejkm == '8a8acee27f216d3b017f248febec1bfa') {    //水电费
                            var sdf1 = data[0].input016 == null ? '' : data[0].input016;
                            suma = parseFloat(sdf1);
                            document.getElementById('field_8a8acee27693bf64017693dcc4db058b_' + idx).value = '8a8acee279ea7a560179ea8a2f472dda';  //水电费-电费
                            document.getElementById('field_8a8acee27693bf64017693dcc4db058b_' + idx + 'span').innerHTML = '8a8acee279ea7a560179ea8a2f472dda';
                        } else if (xmejkm == '8a8acee27f216d3b017f248febec1bfb') {    //材料检测费
                            var cljcf1 = data[0].csfje == null ? '' : data[0].csfje;
                            suma = parseFloat(cljcf1);
                            document.getElementById('field_8a8acee27693bf64017693dcc4db058b_' + idx).value = '8a8acee279ea7a560179ea8a221d2bbf';  //检测费-其他检测费
                            document.getElementById('field_8a8acee27693bf64017693dcc4db058b_' + idx + 'span').innerHTML = '8a8acee279ea7a560179ea8a221d2bbf';
                        } else if (xmejkm == '8a8acee27f216d3b017f248febec1bfc') {    //文明施工配套费
                            var wmsgptf1 = data[0].input014 == null ? '' : data[0].input014;
                            suma = parseFloat(wmsgptf1);
                            document.getElementById('field_8a8acee27693bf64017693dcc4db058b_' + idx).value = '8a8acee279ea7a560179ea8a17a22a03';  //办公费-其办公费
                            document.getElementById('field_8a8acee27693bf64017693dcc4db058b_' + idx + 'span').innerHTML = '8a8acee279ea7a560179ea8a17a22a03';
                        } else if (xmejkm == '8a8acee27f216d3b017f248febec1bfd') {    //内业资料费
                            var nyzlf1 = data[0].input012 == null ? '' : data[0].input012;
                            suma = parseFloat(nyzlf1);
                            document.getElementById('field_8a8acee27693bf64017693dcc4db058b_' + idx).value = '8a8acee279ea7a560179ea8a17a22a03';  //办公费-其办公费
                            document.getElementById('field_8a8acee27693bf64017693dcc4db058b_' + idx + 'span').innerHTML = '8a8acee279ea7a560179ea8a17a22a03';
                        } else if (xmejkm == '8a8acee27f216d3b017f248febec1bfe') {    //二次转运费
                            var eczyf1 = data[0].input010 == null ? '' : data[0].input010;
                            suma = parseFloat(eczyf1);
                            document.getElementById('field_8a8acee27693bf64017693dcc4db058b_' + idx).value = '8a8acee279ea7a560179ea8a3e542ff5';  //其他费用-其他费用
                            document.getElementById('field_8a8acee27693bf64017693dcc4db058b_' + idx + 'span').innerHTML = '8a8acee279ea7a560179ea8a3e542ff5';
                        } else if (xmejkm == '8a8acee27f216d3b017f248febec1bff') {    //安全保证金
                            var aqbzj1 = data[0].input008 == null ? '' : data[0].input008;
                            suma = parseFloat(aqbzj1);
                            document.getElementById('field_8a8acee27693bf64017693dcc4db058b_' + idx).value = '8a8acee279ea7a560179ea8a3e542ff5';  //其他费用-其他费用
                            document.getElementById('field_8a8acee27693bf64017693dcc4db058b_' + idx + 'span').innerHTML = '8a8acee279ea7a560179ea8a3e542ff5';
                        } else if (xmejkm == '8a8acee27f216d3b017f248febed1c02') {    //其他费用
                            var qtfy1 = data[0].input002 == null ? '' : data[0].input002;
                            suma = parseFloat(qtfy1);
                            document.getElementById('field_8a8acee27693bf64017693dcc4db058b_' + idx).value = '8a8acee279ea7a560179ea8a3e542ff5';  //其他费用-其他费用
                            document.getElementById('field_8a8acee27693bf64017693dcc4db058b_' + idx + 'span').innerHTML = '8a8acee279ea7a560179ea8a3e542ff5';
                        } else {
                            suma = 0;
                            alert('该关联项目预算表无对应二级科目金额!');
                        }
                    }
                }
            });
            DWREngine.setAsync(true);
            DWREngine.setAsync(false);//设置为同步获取数据
            DataService.getValues(sql1, {
                callback: function (data) {
                    if (data && data.length > 0) {
                        var xcglf2 = data[0].bxmoney == null ? '' : data[0].bxmoney;  //现场管理费
                        sumb = parseFloat(xcglf2);
                    }
                }
            });
            DWREngine.setAsync(true);//设置为同步获取数据
            var sumc = Math.round((parseFloat(suma) - parseFloat(sumb)) * 100) / 100;
            kyysje = parseFloat(sumc);
            document.getElementById('field_8a8acee27370f1760173752453d213a1_' + idx + 'span').innerHTML = parseFloat(sumc); //可用预算金额
        });
    });
    //自动计算可用预算金额 2022/10/21 end
}

function initData() {
    var orgid1 = $('[name=field_8a8ad0a03dac251a013daeca4b150c45]').val();   //区域
    var orgid2 = $('[name=field_8a8ad09444905a35014494d4294e0520]').val();   //申请人部门
    var applier = $('[name=field_8a8ad0a03dac251a013daeca4b050c43]').val();   //申请人
    var sqlJudge = 'select * from (select distinct t.provinceid  from  uf_issuedarea t,formbase fb where t.requestid=fb.id and fb.isdelete=0) a where \'' + orgid1 + '\' in a.provinceid';
    DWREngine.setAsync(false);
    DataService.getValues(sqlJudge, function (data) {
        var budgetDepartment = getBudgetDepartment();//获取当前人员的预算归口
        if (data && data.length) {//判断该区域是省区
            $('[name=field_8a8ad0944d65f4e2014d8ee79ae266f2]').val(budgetDepartment);   //------------------
            $('[name=field_8a8ad0944d65f4e2014d8ee79ae266f2span]').html(SQL('select objname from orgunit where id=\'' + budgetDepartment + '\''));   //----------------
        } else {//判断该区域非省区
            $('[name=field_8a8ad0944d65f4e2014d8ee79ae266f2]').val(budgetDepartment);   //----------
            $('[name=field_8a8ad0944d65f4e2014d8ee79ae266f2span]').html(SQL('select objname from orgunit where id=\'' + budgetDepartment + '\''));
        }
    });
    DWREngine.setAsync(true);
}

//预算科目change事件
function getYusuan() {
    var budgetcentralized = $('[name=field_8a8ad0944d65f4e2014d8ee79ae266f2]').val(); //预算归口
    var applydate = $('[name=field_8a8ad0a03dac251a013daeca4b250c47]').val();
    var yearmonth = applydate.substring(0, 7);  //年月
    var kemu = $('input[name=field_8a8ad0944d65f4e2014d8ee79bcc66f4]').val();//合同费用科目
    var curentmonth = getcurentmonth(yearmonth.substring(5, 7));
    var year = yearmonth.substring(0, 4);
    var monthb = new Number(yearmonth.substring(5, 7));
    if (monthb > 1) {
        monthb = monthb - 1;
    }
    var sql = 'select nvl(sum(' + curentmonth + '),0) price from uf_monthbudgetmanage a left join uf_monthmanageapply b on a.department=b.department and a.province=b.province and a.budgetyear=b.budgetyear  where a.province=\'' + budgetcentralized + '\'and a.sechondcode=(select memucode from uf_budgetmemu where requestid=\'' + kemu + '\') and a.freetype!=\'2\' and b.aplyflag=\'1\' and a.budgetyear=\'' + year + '\' and b.month=\'' + monthb + '\'';
    var yusuanMoney = 0;
    DWREngine.setAsync(false);
    DataService.getValues(sql, function (data) {
        if (data && data.length) {
            yusuanMoney = parseFloat(data[0].price);
        }
    });
    DWREngine.setAsync(true);
    if (yusuanMoney == 0) {
        //  alert('你所在的区域或部门本月的业务招待预算为0或无预算！');
    }
    $('[name=field_8a8ad0944d65f4e2014d8ee7955466ea]').val(yusuanMoney);     //预算金额
    $('[name=field_8a8ad0944d65f4e2014d8ee7955466easpan]').html(yusuanMoney);  //预算金额
    var monthapply = getMonthApply()
    $('[name=field_8a8ad0944d65f4e2014d8ee7964e66ec]').val(monthapply);      //累计申请总额
    $('[name=field_8a8ad0944d65f4e2014d8ee7964e66ecspan]').html(monthapply);  //累计申请总额
}

//获取本月累计申请金额
function getMonthApply() {
    var yearmonth = $('[name=field_8a8ad0a03dac251a013daeca4b250c47]').val().substring(0, 7); //年月
    var budgetcentralized = $('[name=field_8a8ad0944d65f4e2014d8ee79ae266f2]').val();//预算归口
    var kemu = $('input[name=field_8a8ad0944d65f4e2014d8ee79bcc66f4]').val(); //合同费用科目
    var requestid = document.getElementById('requestid').value;
    var monthApply = 0;
    DWREngine.setAsync(false);
    //总共本月累计申请
    var totalSql = 'select nvl(sum(applyamount),0) applyamount from v_monthbudgetcostapply where applydate=\'' + yearmonth + '\' and region=\'' + budgetcentralized + '\' and memucode=(select memucode from uf_budgetmemu where requestid=\'' + kemu + '\')';
    DataService.getValues(totalSql, function (data) {
        if (data && data.length) {
            monthApply = parseFloat(data[0].applyamount);
        }
    });
    if (isStringEmpty(requestid) == false) {
        //不为空，需要减掉自己申请, FLAG = 1 表示员工费用申请
        var sqlMySelf = totalSql + ' and requestid =\'' + requestid + '\' ';
        DataService.getValues(sqlMySelf, function (data) {
            if (data && data.length) {
                var myApply = parseFloat(data[0].applyamount);
                monthApply = monthApply - myApply;
            }
        });
    }
    DWREngine.setAsync(true);
    return monthApply;
}

function getcurentmonth(yearmonth) {
    if (yearmonth == '01') {
        curentmonth = 'JANUARYPRICE1';
    }
    if (yearmonth == '02') {
        curentmonth = 'FEBRUARYPRICE1';
    }
    if (yearmonth == '03') {
        curentmonth = 'MARCHPRICE1';
    }
    if (yearmonth == '04') {
        curentmonth = 'APRILPRICE1';
    }
    if (yearmonth == '05') {
        curentmonth = 'MAYPRICE1';
    }
    if (yearmonth == '06') {
        curentmonth = 'JUNEPRICE1';
    }
    if (yearmonth == '07') {
        curentmonth = 'JULYPRICE1';
    }
    if (yearmonth == '08') {
        curentmonth = 'AUGUSTPRICE1';
    }
    if (yearmonth == '09') {
        curentmonth = 'SEPTEMBERPRICE1';
    }
    if (yearmonth == '10') {
        curentmonth = 'OCTOBERPRICE1';
    }
    if (yearmonth == '11') {
        curentmonth = 'NOVEMBERPRICE1';
    }
    if (yearmonth == '12') {
        curentmonth = 'DECEMBERPRICE1';
    }
    return curentmonth;
}

//验证字符是否为空
function isStringEmpty(obj) {
    if (obj == '' || obj == null || obj == undefined) {
        return true;
    }
    return false;
}

function openwindow(objid) {
    var flowid = '';
    var date = $('input[name=\'field_8a8ad0a03dac251a013daeca4b250c47\']').val();//申请时间
    var stuff = document.getElementsByName('field_8a8ad0a03dac251a013daeca4b050c43')[0].value;  //申请人
    var limit = 8;//限制张数
    var url = '/app/sale/selectpicture.jsp?type=10&stuffnum=' + stuff + '&flag=' + objid + '&date=' + date + '&limit=' + limit + '&sid=' + (new Date()).getTime();
    showDialog(url, objid);
}

//获取扣款事件
var getmoneyFlag = false;

function getmoney() {
    getmoneyFlag = true;
    DWREngine.setAsync(false);
    var requestid = document.getElementById('requestid').value;

    var formid = '8a8acee26b98726f016bb1dff0bd15cd';
    var checknode = 'check_node_' + formid;
    var checkboxes = document.getElementsByName(checknode);
    for (var i = 0; i < checkboxes.length; i++) {
        checkboxes[i].checked = true;
    }
    delrow(formid);
    DWREngine.setAsync(false);
    var idx = rowindex_8a8acee26b98726f016bb1dff0bd15cd;
    var ekorg = document.getElementById('field_8a8ad0204c20e0d3014c2c24cd7c6564').value; //采购组织
    var gysbh = document.getElementById('field_8a8ad0a03dac251a013daeca4b340c49').value; //供应商编号
    if (ekorg == '' || gysbh == '') {
        alert('请选择采购组织/供应商编号');
        getmoneyFlag = false;
        return false;
    }

    var sql = 'select a.requestid,a.flowno,a.fklx,a.realamount ,nvl(sum(c.bckkje),0) ykkje , (a.realamount-nvl(sum(c.bckkje),0)) wkkje from uf_gyskkbd a left join requestbase b  on  a.requestid=b.id and b.isdelete=0 and b.isfinished=1 left join uf_bclkk c on a.requestid=c.glkkd ';
    if (requestid != '') {
        sql = sql + ' and c.requestid <>\'' + requestid + '\' ';
    }
    sql = sql + 'where  a.gysbmcod=\'' + gysbh + '\'  and a.companycode=\'' + ekorg + '\'  and a.fklx=\'8a8acee26b98726f016bb00b81bf5364\'   group by a.requestid,a.flowno,a.fklx,a.realamount ';
    DataService.getValues(sql, {
        callback: function (data) {
            if (data && data.length > 0) {
                for (var i = 0; i < data.length; i++) {
                    var realamount = (data[i].realamount == null ? '' : data[i].realamount);     //扣款总额
                    var wkkje = (data[i].wkkje == null ? '' : data[i].wkkje);    //未扣金额
                    var ykkje = (data[i].ykkje == null ? '' : data[i].ykkje);    //已扣金额
                    //  alert(realamount );
                    if (parseFloat(realamount) > parseFloat(ykkje)) {
                        addrow('8a8acee26b98726f016bb1dff0bd15cd');
                        document.getElementById('field_8a8acee26b98726f016bb1f65be718d4_' + idx).value = (data[i].requestid == null ? '' : data[i].requestid);
                        document.getElementById('field_8a8acee26b98726f016bb1f65be718d4_' + idx + 'span').innerHTML = (data[i].flowno == null ? '' : data[i].flowno);
                        document.getElementById('field_8a8acee26b98726f016bb1f65c4518d8_' + idx).value = (data[i].realamount == null ? '' : data[i].realamount);
                        document.getElementById('field_8a8acee26b98726f016bb1f65c4518d8_' + idx + 'span').innerHTML = (data[i].realamount == null ? '' : data[i].realamount);
                        document.getElementById('field_8a8acee26b98726f016bb1f65c7418da_' + idx).value = (data[i].ykkje == null ? '' : data[i].ykkje);
                        document.getElementById('field_8a8acee26b98726f016bb1f65c7418da_' + idx + 'span').innerHTML = (data[i].ykkje == null ? '' : data[i].ykkje);
                        document.getElementById('field_8a8acee26b98726f016bb1f65ca318dc_' + idx).value = (data[i].wkkje == null ? '' : data[i].wkkje);
                        document.getElementById('field_8a8acee26b98726f016bb1f65ca318dc_' + idx + 'span').innerHTML = (data[i].wkkje == null ? '' : data[i].wkkje);
                        document.getElementById('field_8a8acee26b98726f016bb1f65cd118de_' + idx).value = (data[i].wkkje == null ? '' : data[i].wkkje);
                        idx++;
                    }
                }
            }
        }
    });
}

//判断是否暂缓结算
function sfzhjs() {
    var flg = false;
    var gysno = document.getElementById('field_8a8ad0a03dac251a013daeca4b340c49').value; //供应商编号
    var gsdm = document.getElementById('field_8a8ad0204c20e0d3014c2c24cd7c6564').value; //公司代码
    var sql = ' select get_humres_name(s.reqman) reqman,s.suppno,p.flowno,s.suppname,s.settdate,s.company,l.objdesc from uf_supp_settle s,requestbase r,selectitem l,uf_supplier p where p.flowno=\'' + gysno + '\'  and l.objdesc=\'' + gsdm + '\' and s.settdate>to_char(sysdate,\'yyyy-mm-dd\') and s.requestid=r.id and s.company=l.id and p.requestid=s.suppno  ';
    DWREngine.setAsync(false);
    DataService.getValues(sql, {
        callback: function (data) {
            if (data && data.length > 0) {
                var m = data[0].reqman;
                var d = data[0].settdate;
                alert('该供应商存在 “暂缓结算” 申请(暂缓至：' + d + ')，无法提交。可联系：' + m + '咨询暂缓原由');
                flg = true;
            }
        }
    });
    return flg;
}

//判断是否有应收应付互抵单未关联
function sfyysyf() {
    var flg = false;
    var ysyfno = document.getElementById('field_8a8ad0944c305396014c4e53427a0b0f').value;//应收应付申请单
    var gysno = document.getElementById('field_8a8ad0a03dac251a013daeca4b340c49').value;
    var checksql = 'select flowno from uf_accountspayable  where suppliercode=\'' + gysno + '\'  and isused is null';
    DWREngine.setAsync(false);
    DataService.getValues(checksql, {
        callback: function (data) {
            if (data && data.length > 0) {
                alert('该供应商还有应收应付互抵单未使用，请关联应收应付互抵单！');
                flg = true;
            }
        }
    });
    return flg;
}

function hasht() {
    var flght = false;
    var sfyht = document.getElementById('field_8a8ad09444905a35014494c320380502').value; //是否有合同
    if (sfyht == '8a8ad0a03a4533e4013a45376ee50006') {          // 否
        var gysbm = document.getElementById('field_8a8ad0a03dac251a013daeca4b340c49').value;  // 供应商编码
        var params = [gysbm];
        var sql = 'select t.ctrno,t.CTRNAME,t.SUPPNO,t.SUPPNAME,s.FLOWNO from uf_stock_contract t,uf_supplier s where t.notpay>0 and s.REQUESTID=t.SUPPNO and s.flowno=?';
        DWREngine.setAsync(false);//设置为同步获取数据
        DataService.getValuesNewByMap(sql, params, {
            callback: function (data) {
                if (data && data.length > 0) {
                    flght = true;
                }
            }
        });
        if (flght) {
            //var msg = '该供应商存在未付款合同，请确认该合同内容是否为本次付款用途。若是，“是否有合同”选择是，并点击确定，若不是，请点击取消。';
            var msg = '系统检测到该供应商存在未付款合同,请确认是否要关联合同再提交，是的话“取消”该操作重新选择合同之后再提交！';
            if (confirm(msg)) {
                return false;
            }
        }
    }
    return flght;
}

/** 判断分摊明细中的部门是否有成本中心（选择的采购组织代码） **/
function pdsfycbzx() {
    var isok = true;
    var gsdm = document.getElementById('field_8a8ad0204c20e0d3014c2c24cd7c6564').value;   //公司代码
    DWREngine.setAsync(false);
    $('#oTable8a8ad09446dbc2090146ef63e43c4c6c').find('.DataLight').each(function (i) {
        var idx = document.getElementsByName('check_node_8a8ad09446dbc2090146ef63e43c4c6c')[i].value;
        var ftbm = document.getElementById('field_8a8ad09446dbc2090146ef6856e84c80_' + idx).value;   //分摊部门
        //财务>>财务基础设置>>OA组织架构与成本中心已对应列表 以此参照
        var sql = 'select dept,gsdm from uf_depttocost where dept=\'' + ftbm + '\' and gsdm=\'' + gsdm + '\' ';
        DataService.getValues(sql, {
            callback: function (data) {
                if (data && data.length > 0) {
                } else {
                    alert('分摊明细中，第' + (Number(idx)) + '行,无' + gsdm + '成本中心无法分摊,请重新选择(上级部门)。');
                    var ftbmbtn = document.getElementsByName('button_8a8ad09446dbc2090146ef6856e84c80_' + idx)[0];//分摊部门按钮
                    var ftid = '8a8ad09446dbc2090146ef6856e84c80_' + idx;
                    var fbrosid = '402881e60bfee880010bff17101a000c';
                    ftbmbtn.onclick = function () {
                        getrefobj('field_' + ftid, 'field_' + ftid + 'span', fbrosid, '', '/workflow/request/formbase.jsp?requestid=', '0');
                    }
                    isok = false;
                }
            }
        });
    });
    return isok;
}

// 20201224 wshh 中类点击触发 如果大类已选择，中类根据大类联动，否则就展示所有中类（并在选择中类后回写大类）
function dlOnclick(idx) {
    var dl = document.getElementById('button_8a8acee27693bf64017693dcc58d058f_' + idx);//  大类
    dl.onclick = function () {
        var typeIdDL = '8a8ad0943fe1ba7f013fe554e25b03be';
        var param = 'con8a8ad094430d516101432d7fb5164320_value=' + typeIdDL;
        getrefobj('field_8a8acee27693bf64017693dcc58d058f_' + idx, 'field_8a8acee27693bf64017693dcc58d058f_' + idx + 'span',
            '8a8ad094430d516101432d8554e24357', param, '', '0');
    }
}

// 20201224 wshh 中类点击触发 如果大类已选择，中类根据大类联动，否则就展示所有中类（并在选择中类后回写大类）
function zlOnclick(idx) {
    var zl = document.getElementById('button_8a8acee27693bf64017693dcc5cc0591_' + idx);//  中类
    zl.onclick = function () {
        var dl = document.getElementById('field_8a8acee27693bf64017693dcc58d058f_' + idx).value; // 大类
        var typeIdZL = '8a8ad0943fe1ba7f013fe554e25b03bf';
        if (dl == '' || dl == 'undefinde' || dl == undefined) {
            var param = 'con8a8ad094430d516101432d7fb5164320_value=' + typeIdZL;
            getrefobj('field_8a8acee27693bf64017693dcc5cc0591_' + idx, 'field_8a8acee27693bf64017693dcc5cc0591_' + idx + 'span',
                '8a8ad094430d516101432d8554e24357', param, '', '0');
        } else {
            var param = 'con8a8ad094430d516101432d7fb5264322_value=' + encodeURI(dl.trim());
            param = param + '&con8a8ad094430d516101432d7fb5164320_value=' + typeIdZL;
            getrefobj('field_8a8acee27693bf64017693dcc5cc0591_' + idx, 'field_8a8acee27693bf64017693dcc5cc0591_' + idx + 'span',
                '8a8ad094430d516101432d8554e24357', param, '', '0');
        }
    }
}

// 20201224 wshh 小类点击触发 如果中类已选择，小类根据中类联动，否则就展示所有小类（并在选择小类后回写大类,中类）
function xlOnclick(idx) {
    var xl = document.getElementById('button_8a8acee27693bf64017693dcc60c0593_' + idx);//  小类
    xl.onclick = function () {
        var zl = document.getElementById('field_8a8acee27693bf64017693dcc5cc0591_' + idx).value; // 中类
        var typeIdxL = '8a8ad0943fe1ba7f013fe554e25b03c0';
        if (zl == '' || zl == 'undefinde' || zl == undefined) {
            //alert('请先选择！');
            //return;
            var param = 'con8a8ad094430d516101432d7fb5164320_value=' + typeIdxL;
            getrefobj('field_8a8acee27693bf64017693dcc60c0593_' + idx, 'field_8a8acee27693bf64017693dcc60c0593_' + idx + 'span',
                '8a8ad094430d516101432d8554e24357', param, '', '0');
        } else {
            var param = 'con8a8ad094430d516101432d7fb5264322_value=' + encodeURI(zl.trim());
            param = param + '&con8a8ad094430d516101432d7fb5164320_value=' + typeIdxL;
            getrefobj('field_8a8acee27693bf64017693dcc60c0593_' + idx, 'field_8a8acee27693bf64017693dcc60c0593_' + idx + 'span',
                '8a8ad094430d516101432d8554e24357', param, '', '0');
        }
    }
}

// 20201224 wshh 物料点击触发 如果大小中类已选择，物料根据大小中类联动，否则就展示所有（并在选择后回写大类,中类，小类）
function wlOnclick(idx) {
    var wl = document.getElementById('button_8a8acee27693bf64017693dcc6500595_' + idx);//  物料
    wl.onclick = function () {
        var dl = document.getElementById('field_8a8acee27693bf64017693dcc58d058f_' + idx).value; // 大类
        var zl = document.getElementById('field_8a8acee27693bf64017693dcc5cc0591_' + idx).value; // 中类
        var xl = document.getElementById('field_8a8acee27693bf64017693dcc60c0593_' + idx).value; // 小类
        var param = '';
        if (dl == '' || dl == 'undefinde' || dl == undefined) {
            //alert('请先选择！');
            //return;
        } else {
            param = param + 'con8a8ad0205271d353015286315d0a7104_value=' + dl;
        }
        if (zl == '' || zl == 'undefinde' || zl == undefined) {
            //alert('请先选择！');
            //return;
        } else {
            param = param + '&con8a8ad0205271d353015286315e627106_value=' + zl;
        }
        if (xl == '' || xl == 'undefinde' || xl == undefined) {
            //alert('请先选择！');
            //return;
        } else {
            param = param + '&con8a8ad0205271d353015286315fe9710a_value=' + xl;
        }
        getrefobj('field_8a8acee27693bf64017693dcc6500595_' + idx, 'field_8a8acee27693bf64017693dcc6500595_' + idx + 'span',
            '8a8ad0a03ad8ab39013ad8bdb1cb00dd', param, '/workflow/request/formbase.jsp?requestid=', '0');

    }
}

//绑定回写事件 20201225 wshh
function bandingHX() {
    try {
        //分摊明细绑定事件
        $('#oTable8a8ad09446dbc2090146ef63e43c4c6c').find('.DataLight').each(function (i) {
            var idx = document.getElementsByName('check_node_8a8ad09446dbc2090146ef63e43c4c6c')[i].value;
            var typeIdDL = '8a8ad0943fe1ba7f013fe554e25b03be';
            var typeIdZL = '8a8ad0943fe1ba7f013fe554e25b03bf';
            var typeIdXL = '8a8ad0943fe1ba7f013fe554e25b03c0';
            //中类改变事件
            var zl = document.getElementsByName('field_8a8acee27693bf64017693dcc5cc0591_' + idx)[0];
            WeaverUtil.watch(zl, function () {
                //回写大类，清空小类和物料编码
                var sql1 = 'select t.requestid,t.upcodeid,t.typeid,t.codename,t1.codename upcodetxt from uf_bugdet_typelist t ';
                sql1 = sql1 + ' left join uf_bugdet_typelist t1 on t1.REQUESTID = t.upcodeid  where t.TYPEID =\'' + typeIdZL + '\' ';
                sql1 = sql1 + ' and t.REQUESTID =\'' + zl.value + '\'';
                DataService.getValues(sql1, {
                    callback: function (data) {
                        if (data && data.length > 0) {
                            var requestIdDL = data[0].upcodeid;
                            document.getElementById('field_8a8acee27693bf64017693dcc58d058f_' + idx).value = requestIdDL;//回写大类
                            document.getElementById('field_8a8acee27693bf64017693dcc58d058f_' + idx + 'span').innerHTML = data[0].upcodetxt;//回写大类
                        }
                    }
                });
            });
            //小类改变事件
            var xl = document.getElementsByName('field_8a8acee27693bf64017693dcc60c0593_' + idx)[0];
            WeaverUtil.watch(xl, function () {
                //回写大类和中类，清空物料编码
                var sql2 = 'select t.requestid,t.upcodeid,T2.CODENAME upcodetxt,T2.upcodeid parentupcodeid,t3.CODENAME parentupcodetxt from uf_bugdet_typelist  t ' +
                    ' LEFT JOIN uf_bugdet_typelist t2 on T2.REQUESTID=t.UPCODEID and t2.TYPEID=\'' + typeIdZL + '\' ';
                sql2 = sql2 + ' LEFT JOIN uf_bugdet_typelist t3 on t3.requestid = t2.UPCODEID';
                sql2 = sql2 + ' where t.TYPEID =\'' + typeIdXL + '\'';
                sql2 = sql2 + ' and t.REQUESTID =\'' + xl.value + '\'';
                DataService.getValues(sql2, {
                    callback: function (data) {
                        if (data && data.length > 0) {
                            var requestIdDL = data[0].parentupcodeid;
                            var requestIdZL = data[0].upcodeid;
                            document.getElementById('field_8a8acee27693bf64017693dcc58d058f_' + idx).value = requestIdDL;//回写大类
                            document.getElementById('field_8a8acee27693bf64017693dcc58d058f_' + idx + 'span').innerHTML = data[0].parentupcodetxt;//回写大类
                            document.getElementById('field_8a8acee27693bf64017693dcc5cc0591_' + idx).value = requestIdZL;//中类
                            document.getElementById('field_8a8acee27693bf64017693dcc5cc0591_' + idx + 'span').innerHTML = data[0].upcodetxt;//中类
                        }
                    }
                });
            });
            //物料改变事件 uf_bom_info
            var wl = document.getElementsByName('field_8a8acee27693bf64017693dcc6500595_' + idx)[0];
            WeaverUtil.watch(wl, function () {
                //回写大类和中类和小类
                var sql3 = ' select t.xcpdl,t.xcpzl,t.xcpxl,T1.CODENAME xcpdltxt,T2.CODENAME xcpzltxt,T3.CODENAME xcpxltxt from uf_bom_info t';
                sql3 = sql3 + ' LEFT JOIN uf_bugdet_typelist t1 on t1.REQUESTID=t.XCPDL LEFT JOIN uf_bugdet_typelist t2 on t2.REQUESTID=t.xcpzl LEFT JOIN uf_bugdet_typelist t3 on t3.REQUESTID=t.xcpxl where 1=1 ';
                sql3 = sql3 + ' and t.REQUESTID =\'' + wl.value + '\'';
                DataService.getValues(sql3, {
                    callback: function (data) {
                        if (data && data.length > 0) {
                            var requestIdDL = data[0].xcpdl;
                            var requestIdZL = data[0].xcpzl;
                            var requestIdXL = data[0].xcpxl;
                            document.getElementById('field_8a8acee27693bf64017693dcc58d058f_' + idx).value = requestIdDL;//回写大类
                            document.getElementById('field_8a8acee27693bf64017693dcc58d058f_' + idx + 'span').innerHTML = data[0].xcpdltxt;//回写大类
                            document.getElementById('field_8a8acee27693bf64017693dcc5cc0591_' + idx).value = requestIdZL;//回写中类
                            document.getElementById('field_8a8acee27693bf64017693dcc5cc0591_' + idx + 'span').innerHTML = data[0].xcpzltxt;//回写中类
                            document.getElementById('field_8a8acee27693bf64017693dcc60c0593_' + idx).value = requestIdXL;//回写小类
                            document.getElementById('field_8a8acee27693bf64017693dcc60c0593_' + idx + 'span').innerHTML = data[0].xcpxltxt;//回写小类
                        }
                    }
                });
            });
            var ftbm = document.getElementsByName('field_8a8ad09446dbc2090146ef6856e84c80_' + idx)[0];//分摊部门改变事件
            WeaverUtil.watch(ftbm, function () {
                var ftbmValue = ftbm.value;
                var yskmValue = document.getElementsByName('field_8a8ad09446dbc2090146ef6857174c82_' + idx)[0].value;
                if (ftbmValue == '' || ftbmValue == 'undefinde' || ftbmValue == undefined
                    || yskmValue == '' || yskmValue == 'undefinde' || yskmValue == undefined) {
                    //隐藏 分摊客户 大类 中类 小类 物料
                    yincang(idx);
                } else {
                    //判断分摊部门和科目 是否显示 分摊客户 大类 中类 小类 物料
                    var sql3 = 'select count(1) cnt from orgunit a,orgunitlink b where a.id=b.oid and (b.COL1 like \'%8a8ad0a038d53d3a0138d54023200006%\' or b.COL1 like \'%8a8ad0a038d53d3a0138d54023200006%\')';
                    sql3 = sql3 + ' and a.id =\'' + ftbmValue + '\'';
                    DataService.getValues(sql3, {
                        callback: function (data) {
                            if (data && data.length > 0) {
                                if (data[0].cnt > 0) {
                                    if (yskmValue == '8a8acee2766efb2d01766f73645e5465' || yskmValue == '8a8acee2766efb2d01766f735dc85320'
                                        || yskmValue == '8a8acee2766efb2d01766f735e495339' || yskmValue == '8a8acee2766efb2d01766f737965584d'
                                        || yskmValue == '8a8acee2766efb2d01766f735ec45352' || yskmValue == '8a8acee2766efb2d01766f73a9786117') {
                                        //运输费  广告费  业务宣传费  物料消耗  样板物料 --显示 分摊客户 大类 中类 小类 物料
                                        document.getElementById('button_8a8acee27693bf64017693dcc51f058d_' + idx).disabled = false; //分摊客户
                                        setNeedCheck('8a8acee27693bf64017693dcc51f058d_' + idx, false);
                                        document.getElementById('button_8a8acee27693bf64017693dcc58d058f_' + idx).disabled = false; //大类
                                        setNeedCheck('8a8acee27693bf64017693dcc58d058f_' + idx, false);
                                        document.getElementById('button_8a8acee27693bf64017693dcc5cc0591_' + idx).disabled = false; //中类
                                        setNeedCheck('8a8acee27693bf64017693dcc5cc0591_' + idx, false);
                                        document.getElementById('button_8a8acee27693bf64017693dcc60c0593_' + idx).disabled = false; //小类
                                        setNeedCheck('8a8acee27693bf64017693dcc60c0593_' + idx, false);
                                        document.getElementById('button_8a8acee27693bf64017693dcc6500595_' + idx).disabled = false; //物料
                                        setNeedCheck('8a8acee27693bf64017693dcc6500595_' + idx, false);
                                    } else if (yskmValue == '8a8acee2766efb2d01766f73bb046450') {//信用减值损失  --显示 分摊客户 隐藏-- 大类 中类 小类 物料
                                        document.getElementById('button_8a8acee27693bf64017693dcc51f058d_' + idx).disabled = false; //分摊客户
                                        setNeedCheck('8a8acee27693bf64017693dcc51f058d_' + idx, false);
                                        document.getElementById('button_8a8acee27693bf64017693dcc58d058f_' + idx).disabled = true; //大类
                                        setNeedCheck('8a8acee27693bf64017693dcc58d058f_' + idx, true);
                                        document.getElementById('button_8a8acee27693bf64017693dcc5cc0591_' + idx).disabled = true; //中类
                                        setNeedCheck('8a8acee27693bf64017693dcc5cc0591_' + idx, true);
                                        document.getElementById('button_8a8acee27693bf64017693dcc60c0593_' + idx).disabled = true; //小类
                                        setNeedCheck('8a8acee27693bf64017693dcc60c0593_' + idx, true);
                                        document.getElementById('button_8a8acee27693bf64017693dcc6500595_' + idx).disabled = true; //物料
                                        setNeedCheck('8a8acee27693bf64017693dcc6500595_' + idx, true);
                                    } else {//隐藏 分摊客户 大类 中类 小类 物料
                                        yincang(idx);
                                    }
                                } else {//隐藏 分摊客户 大类 中类 小类 物料
                                    yincang(idx);
                                }
                            }
                        }
                    });
                }
            });
            var yskm = document.getElementsByName('field_8a8ad09446dbc2090146ef6857174c82_' + idx)[0];//预算科目改变事件
            WeaverUtil.watch(yskm, function () {
                var ftbmValue = document.getElementsByName('field_8a8ad09446dbc2090146ef6856e84c80_' + idx)[0].value;
                var yskmValue = yskm.value;
                if (ftbmValue == '' || ftbmValue == 'undefinde' || ftbmValue == undefined
                    || yskmValue == '' || yskmValue == 'undefinde' || yskmValue == undefined) {
                    //隐藏 分摊客户 大类 中类 小类 物料
                    yincang(idx);
                } else {
                    //判断分摊部门和科目 是否显示 分摊客户 大类 中类 小类 物料
                    var sql3 = 'select count(1) cnt from orgunit a,orgunitlink b where a.id=b.oid and (b.COL1 like \'%8a8ad0a038d53d3a0138d54023200006%\' or b.COL1 like \'%8a8ad0a038d53d3a0138d54023200006%\')';
                    sql3 = sql3 + ' and a.id =\'' + ftbmValue + '\'';
                    DataService.getValues(sql3, {
                        callback: function (data) {
                            if (data && data.length > 0) {
                                if (data[0].cnt > 0) {
                                    if (yskmValue == '8a8acee2766efb2d01766f73645e5465' || yskmValue == '8a8acee2766efb2d01766f735dc85320'
                                        || yskmValue == '8a8acee2766efb2d01766f735e495339' || yskmValue == '8a8acee2766efb2d01766f737965584d'
                                        || yskmValue == '8a8acee2766efb2d01766f735ec45352' || yskmValue == '8a8acee2766efb2d01766f73a9786117') {
                                        //运输费  广告费  业务宣传费  物料消耗  样板物料 --显示 分摊客户 大类 中类 小类 物料
                                        document.getElementById('button_8a8acee27693bf64017693dcc51f058d_' + idx).disabled = false; //分摊客户
                                        setNeedCheck('8a8acee27693bf64017693dcc51f058d_' + idx, false);
                                        document.getElementById('button_8a8acee27693bf64017693dcc58d058f_' + idx).disabled = false; //大类
                                        setNeedCheck('8a8acee27693bf64017693dcc58d058f_' + idx, false);
                                        document.getElementById('button_8a8acee27693bf64017693dcc5cc0591_' + idx).disabled = false; //中类
                                        setNeedCheck('8a8acee27693bf64017693dcc5cc0591_' + idx, false);
                                        document.getElementById('button_8a8acee27693bf64017693dcc60c0593_' + idx).disabled = false; //小类
                                        setNeedCheck('8a8acee27693bf64017693dcc60c0593_' + idx, false);
                                        document.getElementById('button_8a8acee27693bf64017693dcc6500595_' + idx).disabled = false; //物料
                                        setNeedCheck('8a8acee27693bf64017693dcc6500595_' + idx, false);
                                    } else if (yskmValue == '8a8acee2766efb2d01766f73bb046450') {//信用减值损失  --显示 分摊客户 隐藏-- 大类 中类 小类 物料
                                        document.getElementById('button_8a8acee27693bf64017693dcc51f058d_' + idx).disabled = false; //分摊客户
                                        setNeedCheck('8a8acee27693bf64017693dcc51f058d_' + idx, false);

                                        document.getElementById('button_8a8acee27693bf64017693dcc58d058f_' + idx).disabled = true; //大类
                                        setNeedCheck('8a8acee27693bf64017693dcc58d058f_' + idx, true);
                                        document.getElementById('field_8a8acee27693bf64017693dcc58d058f_' + idx).value = '';//回写大类
                                        document.getElementById('field_8a8acee27693bf64017693dcc58d058f_' + idx + 'span').innerHTML = '';//回写大类


                                        document.getElementById('button_8a8acee27693bf64017693dcc5cc0591_' + idx).disabled = true; //中类
                                        setNeedCheck('8a8acee27693bf64017693dcc5cc0591_' + idx, true);
                                        document.getElementById('field_8a8acee27693bf64017693dcc5cc0591_' + idx).value = '';//回写中类
                                        document.getElementById('field_8a8acee27693bf64017693dcc5cc0591_' + idx + 'span').innerHTML = '';//回写中类

                                        document.getElementById('button_8a8acee27693bf64017693dcc60c0593_' + idx).disabled = true; //小类
                                        setNeedCheck('8a8acee27693bf64017693dcc60c0593_' + idx, true);
                                        document.getElementById('field_8a8acee27693bf64017693dcc60c0593_' + idx).value = '';//回写小类
                                        document.getElementById('field_8a8acee27693bf64017693dcc60c0593_' + idx + 'span').innerHTML = '';//回写小类

                                        document.getElementById('button_8a8acee27693bf64017693dcc6500595_' + idx).disabled = true; //物料
                                        setNeedCheck('8a8acee27693bf64017693dcc6500595_' + idx, true);
                                        document.getElementById('field_8a8acee27693bf64017693dcc6500595_' + idx).value = '';//回写物料
                                        document.getElementById('field_8a8acee27693bf64017693dcc6500595_' + idx + 'span').innerHTML = '';//回写物料
                                    } else {//隐藏 分摊客户 大类 中类 小类 物料
                                        yincang(idx);
                                    }
                                } else {//隐藏 分摊客户 大类 中类 小类 物料
                                    yincang(idx);
                                }
                            }
                        }
                    });
                }
            });
        });
    } catch (e) {
        alert(e.message);
    }
} //20201225 wshh
function yincang(idx) {
    document.getElementById('button_8a8acee27693bf64017693dcc51f058d_' + idx).disabled = true; //分摊客户
    setNeedCheck('8a8acee27693bf64017693dcc51f058d_' + idx, true);
    document.getElementById('field_8a8acee27693bf64017693dcc51f058d_' + idx).value = '';//回写分摊客户
    document.getElementById('field_8a8acee27693bf64017693dcc51f058d_' + idx + 'span').innerHTML = '';//回写分摊客户

    document.getElementById('button_8a8acee27693bf64017693dcc58d058f_' + idx).disabled = true; //大类
    setNeedCheck('8a8acee27693bf64017693dcc58d058f_' + idx, true);
    document.getElementById('field_8a8acee27693bf64017693dcc58d058f_' + idx).value = '';//回写大类
    document.getElementById('field_8a8acee27693bf64017693dcc58d058f_' + idx + 'span').innerHTML = '';//回写大类

    document.getElementById('button_8a8acee27693bf64017693dcc5cc0591_' + idx).disabled = true; //中类
    setNeedCheck('8a8acee27693bf64017693dcc5cc0591_' + idx, true);
    document.getElementById('field_8a8acee27693bf64017693dcc5cc0591_' + idx).value = '';//回写中类
    document.getElementById('field_8a8acee27693bf64017693dcc5cc0591_' + idx + 'span').innerHTML = '';//回写中类

    document.getElementById('button_8a8acee27693bf64017693dcc60c0593_' + idx).disabled = true; //小类
    setNeedCheck('8a8acee27693bf64017693dcc60c0593_' + idx, true);
    document.getElementById('field_8a8acee27693bf64017693dcc60c0593_' + idx).value = '';//回写小类
    document.getElementById('field_8a8acee27693bf64017693dcc60c0593_' + idx + 'span').innerHTML = '';//回写小类

    document.getElementById('button_8a8acee27693bf64017693dcc6500595_' + idx).disabled = true; //物料
    setNeedCheck('8a8acee27693bf64017693dcc6500595_' + idx, true);
    document.getElementById('field_8a8acee27693bf64017693dcc6500595_' + idx).value = '';//回写物料
    document.getElementById('field_8a8acee27693bf64017693dcc6500595_' + idx + 'span').innerHTML = '';//回写物料
}

//分摊金额变化时监听 wshh 20201228
function calFtInit() {
    var shareAmountTemp = 0;
    var checknodestemp = document.getElementsByName('check_node_8a8ad09446dbc2090146ef63e43c4c6c');
    var tempidx = checknodestemp[0].value;
    $('#oTable8a8ad09446dbc2090146ef63e43c4c6c').find('.DataLight').each(function (i) {
        var idx = document.getElementsByName('check_node_8a8ad09446dbc2090146ef63e43c4c6c')[i].value;
        if (idx > tempidx) {
            var shareAmount = document.getElementById('field_8a8ad09446dbc2090146ef6857364c84_' + idx).value;//报销金额
            if (shareAmount == '' || shareAmount == 'undefinde' || shareAmount == undefined) {
                shareAmount = 0;
            }
            shareAmountTemp = (parseFloat(shareAmountTemp) + parseFloat(shareAmount)).toFixed(2);
        }
        var oneShareAmount = (parseFloat(shareAmountTotal) - parseFloat(shareAmountTemp)).toFixed(2);
        document.getElementById('field_8a8ad09446dbc2090146ef6857364c84_' + tempidx).value = oneShareAmount;
    })
    //20210714变更1,倒减金额不能有负数
    if (document.getElementById('field_8a8ad09446dbc2090146ef6857364c84_' + tempidx).value < 0) {
        alert('首行分摊金额不能是负数，请重新调整其他行的分摊金额。');
    }
}

//  add by wujh20210121 是否有发票控制
function sfyfpCg() {
    //是否有发票
    var ishasfp = document.getElementById('field_8a8ad0944a3c9caa014a4b80ccfb1ca8').value;
    if (ishasfp == '8a8ad0a03a4533e4013a45376ee50006') { // 选否时自动签收
        // 获取当前时间
        var currentDate = new Date();
        currentDate = currentDate.getFullYear() + '-' + (currentDate.getMonth() + 1 > 9 ? '' : '0') + (currentDate.getMonth() +
                1) + '-' + (currentDate.getDate() > 9 ? '' : '0') + currentDate.getDate() + ' ' + (currentDate.getHours()) + ':' +
            (currentDate.getMinutes()) + ':' + (currentDate.getSeconds());
        document.getElementById('field_8a8ad09448ba3de20148bed0786c0287').value = '8a8ad09448ba3de20148bec97d410230';
        document.getElementById('field_8a8ad09448ba3de20148bed077a10283').value = '402881e70be6d209010be75668750014';
        document.getElementById('field_8a8ad09448ba3de20148bed0780e0285').value = currentDate;
    } else {
        document.getElementById('field_8a8ad09448ba3de20148bed0786c0287').value = '';
        document.getElementById('field_8a8ad09448ba3de20148bed077a10283').value = '';
        document.getElementById('field_8a8ad09448ba3de20148bed0780e0285').value = '';
    }
}

//分摊表自动带出控制
function kmcg() {
    var kemu = document.getElementById('field_8a8ad09448ba3de20148c3efb8c825a9').value;//8a8ad0944d65f4e2014d8ee799e866f0').value;
    if (kemu) {
        adddata();
    }
}

function delinvoice() {
    delplus('8a8acee2709b706201709f58b2fe59a1');
    var invoicenostr = '';
    $('#oTable8a8acee2709b706201709f58b2fe59a1').find('.DataLight').each(function (i) { //发票清单
        var idx = document.getElementsByName('check_node_8a8acee2709b706201709f58b2fe59a1')[i].value;
        var invoice = document.getElementById('field_8a8acee2709b706201709f5f8ded5d30_' + idx).value;
        invoicenostr = invoicenostr + '、' + invoice;
    });
    if (invoicenostr.length >= 1) {

        document.getElementById('field_8a8ad0a03dac251a013daeca4d090c77').value = invoicenostr.substring(1);

    }
}

//设置历史单据是否必填   -- add by   zjh  20230506
function setHistoryNoMneed() {
    //前期是否已经全额提供发票
    var isinvoiceearlly = document.getElementById('field_8a8ace0f773dad73017742b1a564079e').value;
    if (isinvoiceearlly == '8a8acee277244dc3017737d7810b3d3f') {//是
        //历史单据 span
        $("#historynoSPAN").show(500);
        //设置必填历史单据必填
        setNeedCheck('8a8ace5887e2af4c0187eae44f465dbf', true);
        //主表发票金额可操作
        document.getElementById('field_8a8ad0a03dac251a013daeca4b730c4f').readOnly = false;
        //移除子表的数据 同时隐藏添加行的按钮
        invoiceLineRemoveAndHideBtn();
        //设置是否有发票值 -- 否
        $("#field_8a8ad0944a3c9caa014a4b80ccfb1ca8").val('8a8ad0a03a4533e4013a45376ee50006');
        //
    } else {
        //历史单据 span
        $("#historynoSPAN").hide(500);
        //设置历史单据数据为空
        $("#field_8a8ace5887e2af4c0187eae44f465dbf").val('');
        //主表发票金额不可操作
        document.getElementById('field_8a8ad0a03dac251a013daeca4b730c4f').readOnly = true;
        //设置必填历史单据非
        setNeedCheck('8a8ace5887e2af4c0187eae44f465dbf', false);
        //添加子表的数据 同时显示添加行的按钮
        invoiceLineAddAndShowBtn();
        //设置是否有发票值 -- 是  8a8ad0a03a4533e4013a45376ee50005
        $("#field_8a8ad0944a3c9caa014a4b80ccfb1ca8").val('8a8ad0a03a4533e4013a45376ee50005');
    }

}

//移除子表的数据 同时隐藏添加行的按钮
function invoiceLineRemoveAndHideBtn() {
    var formid = '8a8acee2709b706201709f58b2fe59a1';
    var checknode = 'check_node_' + formid;
    //新建时删除子表中的行
    var checkboxes = document.getElementsByName(checknode);
    for (var i = 0; i < checkboxes.length; i++) {
        checkboxes[i].checked = true;
    }
    //移除子表
    delinvoice();
    //隐藏添加按钮
    $("#invoiceTbLineAdd").hide(200);
}
//添加子表的数据 同时显示添加行的按钮
function invoiceLineAddAndShowBtn() {
    //显示添加按钮
    $("#invoiceTbLineAdd").show(200);
    //添加行
    addplus('8a8acee2709b706201709f58b2fe59a1');
}

//发票类型初始化  8a8acee2755a1b2c01755cb3c46d43a3  add by zjh 20230506
function invoiceTypeInit() {
    var formid = '8a8acee2709b706201709f58b2fe59a1';
    var checknode = 'check_node_' + formid;
    //新建时删除子表中的行
    var checkboxes = document.getElementsByName(checknode);
    for (var i = 0; i < checkboxes.length; i++) {
        var index = checkboxes[i].value;
        //发票类型控制字段
        setInvoiceTypeChange(index);
        //设置发票类型监听
        WeaverUtil.watch(document.getElementById('field_8a8acee2755a1b2c01755cb3c46d43a3_' + index), function () {
            setInvoiceTypeChange(index);
        });
    }
}

//发票类型控制字段
function setInvoiceTypeChange(index) {
    //获取发票类型
    var invoiceType = $("#field_8a8acee2755a1b2c01755cb3c46d43a3_" + index).val();
    //国外发票  事业/财政类等其他发票
    if (invoiceType == '8a8ace5887eaf4f90187eea888ae3d54' || invoiceType == '8a8acee271580b0501715e16d15b20e2') {//选择  国外发票  或  事业/财政类等其他发票
        //设置非读
        setReadOnly(index, false);
    } else {
        //设置只读
        setReadOnly(index, true);
    }
}

function addplus(id) {
    addrow(id);
    sfwgfp();
}

function sfwgfp() {
    var index = curindex_8a8acee2709b706201709f58b2fe59a1;
    //设置 是否代开发票/委托收款 初始值为 否
    $("#field_8a8ace5884cc88630184cc8ce962000b_" + index).val('8a8ad0a03a4533e4013a45376ee50006');
    //初始化控制只读
    setReadOnly(index, true);
    //设置发票类型监听
    WeaverUtil.watch(document.getElementById('field_8a8acee2755a1b2c01755cb3c46d43a3_' + index), function () {
        setInvoiceTypeChange(index);
    });
}

function setReadOnly(index, status) {
    document.getElementById('field_8a8acee2709b706201709f5f8ded5d30_' + index).readOnly = status;
    document.getElementById('field_8a8acee2758b7dc301758ce0fce455b8_' + index).readOnly = status;
    document.getElementById('field_8a8acee2709b706201709f5f8ee05d3a_' + index).readOnly = status;
    document.getElementById('field_8a8acee2709b706201709f5f8f615d3e_' + index).readOnly = status;
    document.getElementById('field_8a8acee2758b7dc301758ce0fddf55c4_' + index).readOnly = status;
    document.getElementById('field_8a8acee2758b7dc301758ce0fd8955c0_' + index).readOnly = status;
    document.getElementById('field_8a8acee2758b7dc301758ce0fd6055be_' + index).readOnly = status;
    document.getElementById('field_8a8acee2709b706201709f5f8f8c5d40_' + index).readOnly = status;
    document.getElementById('field_8a8acee2709b706201709f5f8fb55d42_' + index).readOnly = status;
    document.getElementById('field_8a8acee2709b706201709f5f8fdd5d44_' + index).readOnly = status;
}

function budgetOrgOnclick(idx) {
    document.getElementsByName('button_8a8ad09446dbc2090146ef6856e84c80_' + idx)[0].onclick = function () {
        //更改broswer框
        var param = '';
        getrefobj('field_8a8ad09446dbc2090146ef6856e84c80_' + idx, 'field_8a8ad09446dbc2090146ef6856e84c80_' + idx + 'span', '402881e60bfee880010bff17101a000c', param, '', '0');
    }
}

//判断发票清单内的供应商名称、购方名称与主体是否一致  add by czt  --20221111
function fpqdxxpd() {
    var flg = true;
    var gysname = $('#field_8a8ad0a03dac251a013daeca4b440c4b').val(); //供应商名称
    var gfmcid = $('#field_8a8ad0204c20e0d3014c2c24cde9656d').val(); //采购组织
    var gfmcMain = SQL('select objname from selectitem where id =\'' + gfmcid + '\'');
    $('input[name*=\'8a8acee2709b706201709f5f8f305d3c\']').each(function (i, n) {
        i = $(this).attr('id').split('_')[2];
        var isdkfp = $('#field_8a8ace5884cc88630184cc8ce962000b_' + i).val();//是否代开发票
        var fpgfmc = $('#field_8a8acee2758b7dc301758ce0fd8955c0_' + i).val();//发票购方名称
        if (isdkfp == '8a8ad0a03a4533e4013a45376ee50006') {//为否 进行校验
            var fpgysmc = $('#field_8a8acee2709b706201709f5f8f615d3e_' + i).val();//发票供应商名称
            if (fpgysmc != null && fpgysmc != '') {
                if (gysname.indexOf('(') > -1) { //供应商名称含英文
                    if (fpgysmc.indexOf('（') > -1) {
                        fpgysmc = fpgysmc.replace('（', '(');
                        fpgysmc = fpgysmc.replace('）', ')');
                    }
                }
                if (gysname.indexOf('（') > -1) { //供应商名称含中文
                    if (fpgysmc.indexOf('(') > -1) {
                        fpgysmc = fpgysmc.replace('(', '（');
                        fpgysmc = fpgysmc.replace(')', '）');
                    }
                }
                if (gysname != fpgysmc) {
                    alert('发票清单明细中的供应商名称跟主体供应商名称不一致！');
                    flg = false;
                    return;
                }
            }
            if (fpgfmc != null && fpgfmc != '') {
                if (fpgfmc.indexOf('(') > -1) {
                    fpgfmc = fpgfmc.replace('(', '（');
                    fpgfmc = fpgfmc.replace(')', '）');
                }
                if (gfmcMain != fpgfmc) {
                    alert('发票清单明细中的购方名称跟主体采购组织名称不一致！');
                    flg = false;
                    return;
                }
            }
        } else if (isdkfp == '8a8ad0a03a4533e4013a45376ee50005') { //代开发票  需要校验 购方名称与主体是否一致
            if (fpgfmc != null && fpgfmc != '') {
                if (fpgfmc.indexOf('(') > -1) {
                    fpgfmc = fpgfmc.replace('(', '（');
                    fpgfmc = fpgfmc.replace(')', '）');
                }
                if (gfmcMain != fpgfmc) {
                    alert('发票清单明细中的购方名称跟主体采购组织名称不一致！');
                    flg = false;
                    return;
                }
            }
        }
    });
    return flg;
}

// add by 202211 是否属于安全生产费
function attchCheck3() {
    var obj3 = document.getElementById('field_8a8ace5884662758018473f94aea240c');      // 是否属于安全生产费

    if (obj3.value == '8a8ad0a03d4809f1013d4d96e5fb0a30') {   //是
        setNeedCheck('8a8ace5884662758018473f94b09240e', true);  //  必填
        $('#aqscf01').show();
        $('#aqscf02').show();
    } else if (obj3.value == '8a8acee283ee61180183f46088c41125') {
        setNeedCheck('8a8ace5884662758018473f94b09240e', false);  //  非必填
        document.getElementById('field_8a8ace5884662758018473f94b09240e').value = '';
        $('#aqscf01').hide();
        $('#aqscf02').hide();
    } else {
        $('#aqscf01').hide();
        $('#aqscf02').hide();
    }
}

/*   wqg 20181122 判断是否存在重复单 */
function sfcfsq() {
    var flg = false;
    var requestid = document.getElementById('requestid').value;
    var sqrq = document.getElementById('field_8a8ad0a03dac251a013daeca4b250c47').value; //申请日期
    var yy = sqrq.substr(0, 4);
    var mmdd = sqrq.substr(4, 10);
    var sqrqks = (Number(yy) - 1) + mmdd
    var supplierno = document.getElementById('field_8a8ad0a03dac251a013daeca4b340c49').value; //供应商
    var realpaymoney = document.getElementById('field_8a8ad0a03dac251a013daeca4d380c7d').value; //申请金额
    var sql =
        'select t.flowno,n.objname,f.currentnodeid,t.supplierno,t.applydate,t.realpaymoney from uf_supplier_pay  t left join requestinfo f on f.requestid=t.requestid left join nodeinfo n on f.currentnodeid=n.id where t.supplierno=\'' +
        supplierno + '\'   and t.realpaymoney=\'' + realpaymoney + '\'' +
        'and f.currentnodeid <> \'8a8ad0a03c0ee297013c0f1790f00567\' and f.currentnodeid <> \'8a8ad0b966e6553b0166f30970734119\'  and f.currentnodeid <> \'8a8ad0a03f234209013f243d5a7d487a\'   and t.applydate<=\'' +
        sqrq + '\' and   t.applydate>=\'' + sqrqks + '\' ';
    if (!!requestid) {
        sql += ' and t.requestid <>\'' + requestid + '\'';
    }
    DWREngine.setAsync(false);//设置为同步获取数据
    DataService.getValues(sql, {
        callback: function (data) {
            if (data && data.length > 0) {
                var ts = '';
                for (var k = 0; k < data.length; k++) {
                    var flowno = data[k].flowno;
                    var applydate = data[k].applydate;
                    ts = ts + applydate + ' ' + flowno + ';  ';
                }

                var msg = '系统检测到该收款人存在相同金额的申请记录(' + ts + ')，是否确认提交';
                if (confirm(msg) == false) {
                    flg = true;
                }
            }
        }
    });
    DWREngine.setAsync(true);//设置为同步获取数据
    return flg;
}

function kemujt() {
    var flg = true;
    var kemu = document.getElementById('field_8a8ad09448ba3de20148c3efb8c825a9').value;
    if (kemu == '8a8acee278f8c3a80178f8d472341020') { //检测费
        var AttachmentControl = document.getElementById('field_8a8ad0a03dac251a013daeca4d190c79file').value;
        if (!!!AttachmentControl) {
            alert('报销检测费时，需同步提供盖章版合同/协议/缴费通知单/报价单，请在附件上传!');
            setNeedCheck('8a8ad0a03dac251a013daeca4d190c79file', true);  //附件必填
            flg = false;
            return;
        }
    }
    return flg;
}

function invoicecl() {
    var formid_new = '8a8acee2709b706201709f58b2fe59a1';
    var checknode = 'check_node_' + formid_new;
    var checkboxes = document.getElementsByName(checknode);
    for (var i = 0; i < checkboxes.length; i++) {
        var idx = document.getElementsByName(checknode)[i].value;
        var che = document.getElementsByName(checknode)[i].checked = true;
    }
    delrow('8a8acee2709b706201709f58b2fe59a1');
    var proid = $('#field_8a8ace58851a7266018528a463cd1cdf').val();
    var invoicenostr = document.getElementById('field_8a8ad0a03dac251a013daeca4d090c77').value;
    $.ajax({
        type: 'post',
        url: '/ServiceAction/com.eweaver.app.skshu.province.action.InvoiceUpload',
        dataType: 'json',
        data: {
            'proid': proid
        },
        success: function (data) {
            var summoney = 0;
            debugger;
            for (var i = 0; i < data.list.length; i++) {
                addrow('8a8acee2709b706201709f58b2fe59a1');
                var currowindex = curindex_8a8acee2709b706201709f58b2fe59a1;

                $('#field_8a8acee2709b706201709f5f8ded5d30_' + currowindex).val(data.list[i].fphm);//发票号
                $('#field_8a8acee2709b706201709f5f8ded5d30_' + currowindex + 'span').html(data.list[i].fphm);
                invoicenostr = invoicenostr + '、' + data.list[i].fphm;

                $('#field_8a8acee2709b706201709f5f8ee05d3a_' + currowindex).val(data.list[i].kprq);//开票日期
                $('#field_8a8acee2709b706201709f5f8ee05d3a_' + currowindex + 'span').html(data.list[i].kprq);

                $('#field_8a8acee2758b7dc301758ce0fce455b8_' + currowindex).val(data.list[i].fpdm);//发票代码
                $('#field_8a8acee2758b7dc301758ce0fce455b8_' + currowindex + 'span').html(data.list[i].fpdm);

                $('#field_8a8acee2709b706201709f5f8f615d3e_' + currowindex).val(data.list[i].xhdwhmc);//供应商名称
                $('#field_8a8acee2709b706201709f5f8f615d3e_' + currowindex + 'span').html(data.list[i].xhdwhmc);

                $('#field_8a8acee2758b7dc301758ce0fddf55c4_' + currowindex).val(data.list[i].xhdwsbh);//供应商税号
                $('#field_8a8acee2758b7dc301758ce0fddf55c4_' + currowindex + 'span').html(data.list[i].xhdwsbh);

                $('#field_8a8acee2758b7dc301758ce0fd8955c0_' + currowindex).val(data.list[i].ghdwmc);//购方名称
                $('#field_8a8acee2758b7dc301758ce0fd8955c0_' + currowindex + 'span').html(data.list[i].ghdwmc);

                $('#field_8a8acee2758b7dc301758ce0fd6055be_' + currowindex).val(data.list[i].ghdwsbh);//购方税号
                $('#field_8a8acee2758b7dc301758ce0fd6055be_' + currowindex + 'span').html(data.list[i].ghdwsbh);

                $('#field_8a8acee2758420d20175886f396d7957_' + currowindex).val(data.list[i].attachId);//图片id
                $('#field_8a8acee2758420d20175886f396d7957_' + currowindex + 'span').html(data.list[i].attachId);
                var fpdl = data.list[i].fpdl;
                if (fpdl == null || fpdl == '') {
                    fpdl = '其他';
                }
                $('#field_8a8acee2758d4d6901758de9433b214a_' + currowindex).val(data.list[i].fpdl);//发票种类
                $('#field_8a8acee2758d4d6901758de9433b214a_' + currowindex + 'span').html(data.list[i].fpdl);


                $('#field_8a8acee2758b7dc301758ce0fd0e55ba_' + currowindex).val(data.list[i].fplxdm);//发票类型代码
                $('#field_8a8acee2758b7dc301758ce0fd0e55ba_' + currowindex + 'span').html(data.list[i].fplxdm);
                //setFplxms(currowindex, data.list[i].fplxdm);
                $('#field_297ee92c754e268001754ef9166d0177_' + currowindex).val(data.list[i].perinvid); //发票标识
                $('#field_297ee92c754e268001754ef9166d0177_' + currowindex + 'span').html(data.list[i].perinvid); //发票标识
                //add by yesong 20230224 全电票无校验码判断
                var jym = data.list[i].jym;
                if (jym != null && jym != '' && jym != undefined) {
                    jym = jym.slice(-6);
                }
                $('#field_8a8acee2758b7dc301758ce0fd3855bc_' + currowindex).val(jym); //检验码
                $('#field_8a8acee2758b7dc301758ce0fd3855bc_' + currowindex + 'span').html(jym); //检验码

                var hjje = data.list[i].hjje;
                var jshj = data.list[i].jshj;
                var se = data.list[i].se;
                hjje = Math.round(parseFloat(jshj * 1000 - se * 1000)) / 1000;
                $('#field_8a8acee2709b706201709f5f8f8c5d40_' + currowindex).val(hjje);//不含税金额
                $('#field_8a8acee2709b706201709f5f8f8c5d40_' + currowindex + 'span').html(hjje);

                $('#field_8a8acee2709b706201709f5f8fb55d42_' + currowindex).val(se);//税额
                $('#field_8a8acee2709b706201709f5f8fb55d42_' + currowindex + 'span').html(se);

                $('#field_8a8acee2709b706201709f5f8fdd5d44_' + currowindex).val(data.list[i].jshj);//价税合计
                $('#field_8a8acee2709b706201709f5f8fdd5d44_' + currowindex + 'span').html(data.list[i].jshj);
                var jshj = data.list[i].jshj;
                summoney = parseFloat(summoney * 1000 + jshj * 1000) / 1000;

                if (invoicenostr.length >= 1) {
                    if (invoicenostr.substring(0, 1) == '、') {
                        document.getElementById('field_8a8ad0a03dac251a013daeca4d090c77').value = invoicenostr.substring(1);
                    } else {
                        document.getElementById('field_8a8ad0a03dac251a013daeca4d090c77').value = invoicenostr;
                    }
                }
            }
            $('#field_8a8acee27aed3c23017af00b5f496204').val(summoney);
            getindex();
        }
    });

}

function showDig2() {
    var userId = document.getElementById('currentuserid').value; //用户id
    var options = {
        content: '/app/skshu/province/invoiceocr/queryCommitInvoice3.jsp?userId=' + userId,
        offset: ['50px', '200px'],
        btn1: function (index, layero) {
            //关闭浏览框
            SKSHU.CommonUtils.HLDialog.closeHLLoad(index);
        }
    }
    SKSHU.CommonUtils.HLDialog.openHLDialog(options);
}

// 判断有发票的前提下 需要发票清单内有数据
function fpgl() {
    var flg = true;
    var sfyfapiao = document.getElementById('field_8a8ad0944a3c9caa014a4b80ccfb1ca8').value;  //是否有发票
    var isczfp = document.getElementById('field_8a8ace0f773dad73017742b1a564079e').value; //是否财政发票
    if (isczfp == '8a8acee277244dc3017737d7810b3d40') {
        if (sfyfapiao == '8a8ad0a03a4533e4013a45376ee50005') {
            $('input[name*=\'8a8acee2709b706201709f5f8ded5d30\']').each(function (i, n) {
                i = $(this).attr('id').split('_')[2];
                var invoiceno = document.getElementById('field_8a8acee2709b706201709f5f8ded5d30_' + i).value;//发票号
                if (invoiceno == '' || invoiceno == null || invoiceno == undefined) {
                    alert('发票清单内无数据，请重新获取发票！');
                    flg = false;
                    return;
                }
            })
        }
    }
    return flg;
}

// 对发票进行查重处理
function invoicecc() {
    var flg = true;
    var requestid = document.getElementById('requestid').value;
    $('input[name*=\'8a8acee2709b706201709f5f8ded5d30\']').each(function (i, n) {
        i = $(this).attr('id').split('_')[2];
        var invoiceno = document.getElementById('field_8a8acee2709b706201709f5f8ded5d30_' + i).value;//发票号
        var fpdm = document.getElementById('field_8a8acee2758b7dc301758ce0fce455b8_' + i).value;//发票代码
        if (requestid == '' || requestid == null) {//requestid 为空
            var sql = 'select count(*) sl from uf_fpqd where invoiceno =\'' + invoiceno + '\' and  fpdm =\'' + fpdm + '\' ';
        } else {
            var sql = 'select count(*) sl from uf_fpqd where invoiceno =\'' + invoiceno + '\'and  fpdm =\'' + fpdm + '\' and requestid !=\'' + requestid + '\' ';
        }
        var sl = SQL(sql);
        if (sl > 0) {
            alert('当前请款单流程的发票号存在重复绑定！');
            flg = false;
            return;
        }
    })
    return flg;
}

//add by yesong 进入发票金额只读
function fpjezd() {
    document.getElementById('field_8a8ad0a03dac251a013daeca4b730c4f').readOnly = true;
}

//控制发票不能重复
function ctlInvoiceUnRepeat() {
    //发票清单
    var formid = '8a8acee2709b706201709f58b2fe59a1';
    var checknode = 'check_node_' + formid;
    var checkboxes = document.getElementsByName(checknode);
    //事业/财政类等其他发票  或  国外发票  不控制发票重复  add by  zjh 20230519
    for (var i = 0; i < checkboxes.length; i++) {
        var idx = checkboxes[i].value;
        //发票类型 - 子表 -  发票清单（C类)
        var invoiceType = $("#field_8a8acee2755a1b2c01755cb3c46d43a3_" + idx).val();
        //事业/财政类等其他发票  或  国外发票
        if (invoiceType == '8a8acee271580b0501715e16d15b20e2' || invoiceType == '8a8ace5887eaf4f90187eea888ae3d54') {
            //发票没有重复
            return true;
        }
    }
    for (var i = 0; i < checkboxes.length; i++) {
        var index = checkboxes[i].value;
        //发票代码
        var invoicecode = $("#field_8a8acee2758b7dc301758ce0fce455b8_" + index).val();
        //发票号码
        var invoiceno = $("#field_8a8acee2709b706201709f5f8ded5d30_" + index).val();
        for (var j = i; j < checkboxes.length; j++) {
            var idx = checkboxes[j].value;
            //发票代码
            var invoicecodeJ = $("#field_8a8acee2758b7dc301758ce0fce455b8_" + idx).val();
            //发票号码
            var invoicenoJ = $("#field_8a8acee2709b706201709f5f8ded5d30_" + idx).val();
            //当且仅当 发票代码与发票号码一样的时候  发票重复
            if (invoicecode == invoicecodeJ && invoiceno == invoicenoJ) {
                return false;
            }
        }
    }
    //发票没有重复
    return true;
}</script>
<!--提交前函数-->
<script>function onSubmitBefore(issave) {
    debugger;
    if (issave == 1) {
        return true;
    }
    //费用科目为检测费时判断附件是否有值
    var flag = kemujt();
    if (!flag) {
        return flag;
    }

    // 判断流程内的发票号是否存在重复绑定
    var flag = invoicecc();
    if (!flag) {
        return flag;
    }
    //控制发票不能重复  false 表示有重复
    flag = ctlInvoiceUnRepeat();
    if (!flag) {
        alert("发票重复，请核查后再提交");
        return flag;
    }
    //发票标识不能为空
    var notnull = fpbsnotnull();
    if (notnull == false) {
        return false;
    }

    // add by czt  20230111 开口合同，金额不受限制；如闭口合同，按照合同金额受控。 begin
    var htlx = document.getElementById('field_8a8ad0de683181f2016831cd15ec1f00').value; //合同类型
    var htje = document.getElementById('field_8a8ad0a03dac251a013daeca4c2e0c61').value; // 合同金额
    var yfje = document.getElementById('field_8a8ad09441c756ee0141d9f5cd301abf').value; //合同已付款
    var usedAmount = document.getElementById('field_8a8ad0a03e12dcfc013e15ae25350190').value; //累计已申请金额
    var sqje = document.getElementById('field_8a8ad0a03dac251a013daeca4d380c7d').value;//申请金额
    if (htlx == '8a8ad0de683181f2016831da15e72844') { //8a8ad0de683181f2016831da15e72843开口合同    8a8ad0de683181f2016831da15e72844 闭口

        if (htje == yfje) {
            alert('该合同已付款！');
            return false;
        }
        if (+usedAmount + +sqje >htje) {
            alert('累计申请金额大于合同金额，无法申请付款！');
            return false;
        }
    }
    // add by czt  20230111 开口合同，金额不受限制；如闭口合同，按照合同金额受控。 end


    // add by wujh 20220725 付款条件为空的不让提交并提示 begin
    var fktj = document.getElementById('field_8a8ad0944038bd1901403986d2b30e24').value;
    if (fktj == '' || fktj == null || typeof (fktj) == 'undefined') {
//         alert('请找对应采购员更新付款条件！');
//         return false;
    }
    // add by wujh 20220725 付款条件为空的不让提交并提示 end
    // 重复打款提示	 add by wujh 20221122
    var flg = sfcfsq();
    if (flg) {
        return false;
    }

    var bxgs = document.getElementById('field_8a8acee27689743d017689af90b0150c').value;
    if (bxgs == '' || bxgs.length > 30) {
        alert('付款项目内容概述必输且不能超过25个字');
        return false;
    }

    //add by yesong 2022.07.05 校验是否有发票”选了“是”,“发票金额”为空或者小于等于0，都不给提交流程；
    var sfyfapiao = document.getElementById('field_8a8ad0944a3c9caa014a4b80ccfb1ca8').value;
    var fpje = document.getElementById('field_8a8ad0a03dac251a013daeca4b730c4f').value;
    var isczfp = document.getElementById('field_8a8ace0f773dad73017742b1a564079e').value;
    if (isczfp == '8a8acee277244dc3017737d7810b3d40') {
        if (sfyfapiao == '8a8ad0a03a4533e4013a45376ee50005') {
            if (fpje < 0 || fpje == 0 || fpje == 'null' || fpje == '') {
                alert('未获取发票，请获取发票后再提交！');
                return false;
            }
        }
    }
    //20210714变更1,倒减金额不能有负数
    var checknodes = document.getElementsByName('check_node_8a8ad0a03dac251a013db0db05c23456');

    var tempidx = checknodes[0].value;
    var firstrow = document.getElementById('field_8a8ad09446dbc2090146ef6857364c84_' + tempidx);
    if (firstrow == null) {
        for (var x = 0; x < 10; x++) {
            tempidx = parseInt(tempidx) + 1;
            firstrow = document.getElementById('field_8a8ad09446dbc2090146ef6857364c84_' + tempidx);
            if (firstrow != null) {
                break;
            }
        }
    }


    if (firstrow != null && firstrow.value < 0) {
        alert('首行分摊金额不能是负数，请重新调整其他行的分摊金额。');
        return false;
    }

    var notmoney = getCont();
    if (notmoney == false) {
        return false;
    }

    var payreason = document.getElementById('field_8a8ad094505f277a0150692270021b80').value;  //付款事由
    payreason = removeHTMLTag(payreason);
    var payreason2 = payreason.substring(0, 10);

    document.getElementById('field_8a8acee2703e3d29017042b3483718f8').value = payreason2; //付款事由摘要

    if (hasht()) {
        return false;
    }


    if (issave == 1 || issave == 0) {
        if (sfzhjs()) {
            return false;
        }
        var tb = document.getElementById('oTable8a8ad09446dbc2090146ef63e43c4c6c');    // table 的 id
        var rows = tb.rows; // 获取表格所有行
        if (rows.length <= 2) {
            alert('分摊明细必须填写!');
            return false;
        }
        $('#oTable8a8ad09446dbc2090146ef63e43c4c6c').find('.DataLight').each(function (i) {
            var idx = document.getElementsByName('check_node_8a8ad09446dbc2090146ef63e43c4c6c')[i].value;
            if (!checkOrg(idx)) {
                return false;
            }
        });
        if (!getmoneyFlag) {
            alert('请点击【获取扣款信息】按钮，以加载相关信息！');
            return getmoneyFlag;
        }
        if (document.getElementById('field_8a8ad0944029a75a01403304939e3744').value == '' && document.getElementById('field_8a8ad0a03dac251a013daeca4bc10c55').value == '') {
            alert('供应商银行名称和卡号不能为空，请发起财务信息变更流程维护下供应商财务信息');
            return false;
        }

        if (parseFloat(document.getElementById('field_8a8ad0a03dac251a013daeca4d380c7d').value).toFixed(2) != parseFloat(document.getElementById('field_8a8ad09448f76bc801493720a6292273').value).toFixed(2)) {
            alert('本次申请付款金额与分摊合计金额不一致，请修改后再提交！');
            return false;
        }
        var budgetcentralized = document.getElementById('field_8a8ad0944d65f4e2014d8ee79ae266f2').value;//预算归口
        var isconctact = document.getElementById('field_8a8ad09444905a35014494c320380502').value;//是否有合同
        var conctact = document.getElementById('field_8a8ad0a03dac251a013daeca4bff0c5d').value;//合同编号
        var contype = SQL('select ctrtype from uf_stock_contract where requestid=\'' + conctact + '\'');//合同类型
        var budgetamount = document.getElementById('field_8a8ad0944d65f4e2014d8ee7955466ea').value;//本月预算金额
        var mtotalamount = document.getElementById('field_8a8ad0944d65f4e2014d8ee7964e66ec').value;//本月累计申请总额
        var applyamount = document.getElementById('field_8a8ad0a03dac251a013daeca4d380c7d').value;//申请金额
        if (issave == 0) {
            //事业国外发票
            var sygwfp = $('#field_8a8ace0f773dad73017742b1a564079e').val();
            if (sygwfp == '8a8acee277244dc3017737d7810b3d40') {
/**/
            }
            //有发票的前提下需要发票清单有发票数据
            var flag = fpgl();
            if (!flag) {
                return flag;
            }
        }
    }
    // add by linwp 项目二级科目必填 begin
    var checkNodes = document.getElementsByName('check_node_8a8ad09446dbc2090146ef63e43c4c6c');
    if (checkNodes != null) {
        for (var i = 0; i < checkNodes.length; i++) {
            var idx = checkNodes[i].value;
            var xmejkm = document.getElementById('field_8a8acee27f216d3b017f24ae97b71fec_' + idx).value; //项目二级科目
            var kemu111 = document.getElementById('field_8a8ad09448ba3de20148c3efb8c825a9').value;
            if (kemu111 == '8a8acee27f216d3b017f24463f400e95') {     //装饰公司措施费
                if (xmejkm == '') {
                    alert('请选择项目二级科目');
                    flag = false;
                    return;
                }
            }
        }
    }
    //判断发票清单内的供应商名称、购方名称与主体是否一致
    var flag = fpqdxxpd();
    if (!flag) {
        return flag;
    }

    return true;
}</script>

<p>
    <input id="$8a8acee2703e3d29017042b3483718f8$" class="InputStyle2" value="[隐藏]供应商付款审批单.付款事由摘要" name="8a8ad0a03dac251a013daeca49500c3e" style="cursor: default;">
</p><!---->